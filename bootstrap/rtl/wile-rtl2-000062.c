// Generated by wile, the extremely stable scheming genius compiler

#include "wile-rtl1.h"
#include "wile-rtl2.h"

// declarations

extern lval var_argv;
extern lval var_cmd_name;
extern lval var_stdin;
extern lval var_stdout;
extern lval var_stderr;
extern lval var_pi;
extern lval var_euler_gamma;
extern lval var_show_sign;
extern lval var_int_base;
extern lval var_flt_base;
extern lval var_flt_precision;
#include "wile-rtl2.h"
static lval fn_1(lptr*, lptr);	// (type-mismatch v c)
static lval fn_18(lptr*, lptr);	// (split-format-string fstr)
static lval fn_19(lptr*, lptr);	// (align-str width align str)
static lval fn_20(lptr*, lptr);	// (disp-obj val)
static lval fn_21(lptr*, lptr);	// (printf-helper fstr . vals)
static lval fn_231(lptr*, lptr);
static lval fn_257(lptr*, lptr);
static lval fn_481(lptr*, lptr);
static lval fn_493(lptr*, lptr);
static lval fn_510(lptr*, lptr);

// definitions

// (type-mismatch v c)
static lval fn_1(lptr* var_22, lptr var_23)
{
lval var_25;
var_25 = LVI_STRING("*printf type/value mismatch: got ");
lval var_26;
{
lval vs[6];
vs[0] = var_23[0];
var_26 = wile_typeof(NULL, vs);
}
lval var_27;
var_27 = LVI_STRING(var_26.v.str);
lval var_28;
var_28 = LVI_STRING(" object for %");
lval var_29;
{
lval vs[1];
vs[0] = var_23[1];
var_29 = gen_list(1, vs, NULL);
}
{
lval vs[6];
vs[0] = var_29;
var_29 = wile_char2string(NULL, vs);
}
lval var_30;
var_30 = LVI_STRING(" specifier");
lval var_31;
{
lval vs[5];
vs[0] = var_25;
vs[1] = var_27;
vs[2] = var_28;
vs[3] = var_29;
vs[4] = var_30;
var_31 = gen_list(5, vs, NULL);
}
{
lval vs[6];
vs[0] = var_31;
var_31 = wile_string_append(NULL, vs);
}
return var_31;
}
// end of function fn_1

// (split-format-string fstr)
static lval fn_18(lptr* var_32, lptr var_33)
{
lval var_35;
lval var_36;
{
lval vs[6];
vs[0] = var_33[0];
var_36 = wile_string2list(NULL, vs);
}
var_35 = var_36;
lval var_37;
lval var_38;
var_38 = LVI_CHAR(48);
lval var_39;
var_39 = LVI_INT((unsigned char) var_38.v.chr);
var_37 = var_39;
lval var_40;
lval var_41;
var_41 = LVI_CHAR(108);
var_40 = var_41;
lval var_42;
lval var_43;
var_43 = LVI_STRING("");
var_42 = var_43;
lval var_44;
lval var_45;
var_45 = LVI_INT(0);
var_44 = var_45;
lval var_46;
lval var_47;
var_47 = LVI_BOOL(false);
var_46 = var_47;
lval var_48;
lval var_49;
var_49 = LVI_BOOL(false);
var_48 = var_49;
lval var_51;
if (var_35.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_51 = (var_35.v.pair.car ? *(var_35.v.pair.car) : LVI_NIL());
lval var_52;
var_52 = LVI_CHAR(37);
lval var_53;
var_53 = LVI_BOOL(var_51.v.chr == var_52.v.chr);
if (LV_IS_FALSE(var_53)) {
lval var_54;
var_54 = LVI_STRING("*printf error: malformed format string ");
lval var_55;
{
lval vs[2];
vs[0] = var_54;
vs[1] = var_33[0];
var_55 = gen_list(2, vs, NULL);
}
{
lval vs[6];
vs[0] = var_55;
var_55 = wile_string_append(NULL, vs);
}
lval var_56;
{
lval vs[1];
vs[0] = var_55;
var_56 = gen_list(1, vs, NULL);
}
if (var_56.vt == LV_PAIR && (var_56.v.pair.cdr == NULL || var_56.v.pair.cdr->vt == LV_NIL)) {
var_56 = (var_56.v.pair.car ? *(var_56.v.pair.car) : LVI_NIL());
}
cachalot->errval = new_lv(LV_NIL);
*(cachalot->errval) = var_56;
cachalot->l_whence = 0;
cachalot->c_whence = LISP_WHENCE;
longjmp(cachalot->cenv, 1);
} else {
lval var_57;
if (var_35.vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_57 = (var_35.v.pair.cdr ? *(var_35.v.pair.cdr) : LVI_NIL());
var_35 = var_57;
}
lval var_59;
var_59 = LVI_BOOL(false);
do {
lval var_60;
if (var_35.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_60 = (var_35.v.pair.car ? *(var_35.v.pair.car) : LVI_NIL());
lval var_61;
var_61 = LVI_CHAR(108);
lval var_62;
var_62 = LVI_BOOL(var_60.v.chr == var_61.v.chr);
var_59 = var_62;
if (!LV_IS_FALSE(var_59)) { break; }
lval var_63;
if (var_35.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_63 = (var_35.v.pair.car ? *(var_35.v.pair.car) : LVI_NIL());
lval var_64;
var_64 = LVI_CHAR(114);
lval var_65;
var_65 = LVI_BOOL(var_63.v.chr == var_64.v.chr);
var_59 = var_65;
if (!LV_IS_FALSE(var_59)) { break; }
lval var_66;
if (var_35.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_66 = (var_35.v.pair.car ? *(var_35.v.pair.car) : LVI_NIL());
lval var_67;
var_67 = LVI_CHAR(109);
lval var_68;
var_68 = LVI_BOOL(var_66.v.chr == var_67.v.chr);
var_59 = var_68;
if (!LV_IS_FALSE(var_59)) { break; }
} while (0);
if (LV_IS_FALSE(var_59)) {
(void)
 LVI_BOOL(false);
} else {
lval var_70;
if (var_35.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_70 = (var_35.v.pair.car ? *(var_35.v.pair.car) : LVI_NIL());
var_40 = var_70;
lval var_71;
if (var_35.vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_71 = (var_35.v.pair.cdr ? *(var_35.v.pair.cdr) : LVI_NIL());
var_35 = var_71;
}
lval var_73;
var_73 = LVI_BOOL(false);
do {
lval var_74;
if (var_35.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_74 = (var_35.v.pair.car ? *(var_35.v.pair.car) : LVI_NIL());
lval var_75;
var_75 = LVI_CHAR(32);
lval var_76;
var_76 = LVI_BOOL(var_74.v.chr == var_75.v.chr);
var_73 = var_76;
if (!LV_IS_FALSE(var_73)) { break; }
lval var_77;
if (var_35.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_77 = (var_35.v.pair.car ? *(var_35.v.pair.car) : LVI_NIL());
lval var_78;
var_78 = LVI_CHAR(43);
lval var_79;
var_79 = LVI_BOOL(var_77.v.chr == var_78.v.chr);
var_73 = var_79;
if (!LV_IS_FALSE(var_73)) { break; }
} while (0);
if (LV_IS_FALSE(var_73)) {
(void)
 LVI_BOOL(false);
} else {
lval var_81;
if (var_35.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_81 = (var_35.v.pair.car ? *(var_35.v.pair.car) : LVI_NIL());
lval var_82;
{
lval vs[1];
vs[0] = var_81;
var_82 = gen_list(1, vs, NULL);
}
{
lval vs[6];
vs[0] = var_82;
var_82 = wile_char2string(NULL, vs);
}
var_42 = var_82;
lval var_83;
if (var_35.vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_83 = (var_35.v.pair.cdr ? *(var_35.v.pair.cdr) : LVI_NIL());
var_35 = var_83;
}
lval var_84;
if (var_35.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_84 = (var_35.v.pair.car ? *(var_35.v.pair.car) : LVI_NIL());
lval var_85;
var_85 = LVI_CHAR(48);
lval var_86;
var_86 = LVI_BOOL(var_84.v.chr == var_85.v.chr);
var_46 = var_86;
lval var_88;
lval var_89;
lval var_90;
var_90 = LVI_INT(0);
var_88 = var_90;
do {
lval var_91;
if (var_35.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_91 = (var_35.v.pair.car ? *(var_35.v.pair.car) : LVI_NIL());
lval var_92;
var_92 = LVI_BOOL(isdigit(var_91.v.chr));
lval var_93;
var_93 = LVI_BOOL(LV_IS_FALSE(var_92));
if (!LV_IS_FALSE(var_93)) {
break;
}
lval var_94;
var_94 = LVI_INT(10);
lval var_95;
var_95 = LVI_INT(var_94.v.iv * var_44.v.iv);
lval var_96;
if (var_35.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_96 = (var_35.v.pair.car ? *(var_35.v.pair.car) : LVI_NIL());
lval var_97;
var_97 = LVI_INT((unsigned char) var_96.v.chr);
lval var_98;
var_98 = LVI_INT(var_97.v.iv - var_37.v.iv);
lval var_99;
var_99 = LVI_INT(var_95.v.iv + var_98.v.iv);
var_44 = var_99;
lval var_100;
if (var_35.vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_100 = (var_35.v.pair.cdr ? *(var_35.v.pair.cdr) : LVI_NIL());
var_35 = var_100;
lval var_101;
var_101 = LVI_INT(1);
lval var_102;
var_102 = LVI_INT(var_88.v.iv + var_101.v.iv);
var_89 = var_102;
var_88 = var_89;
} while (1);
lval var_104;
if (var_35.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_104 = (var_35.v.pair.car ? *(var_35.v.pair.car) : LVI_NIL());
lval var_105;
var_105 = LVI_CHAR(46);
lval var_106;
var_106 = LVI_BOOL(var_104.v.chr == var_105.v.chr);
if (LV_IS_FALSE(var_106)) {
(void)
 LVI_BOOL(false);
} else {
lval var_108;
if (var_35.vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_108 = (var_35.v.pair.cdr ? *(var_35.v.pair.cdr) : LVI_NIL());
var_35 = var_108;
lval var_109;
var_109 = LVI_INT(0);
var_48 = var_109;
lval var_111;
lval var_112;
lval var_113;
var_113 = LVI_INT(0);
var_111 = var_113;
do {
lval var_114;
if (var_35.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_114 = (var_35.v.pair.car ? *(var_35.v.pair.car) : LVI_NIL());
lval var_115;
var_115 = LVI_BOOL(isdigit(var_114.v.chr));
lval var_116;
var_116 = LVI_BOOL(LV_IS_FALSE(var_115));
if (!LV_IS_FALSE(var_116)) {
break;
}
lval var_117;
var_117 = LVI_INT(10);
lval var_118;
var_118 = LVI_INT(var_117.v.iv * var_48.v.iv);
lval var_119;
if (var_35.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_119 = (var_35.v.pair.car ? *(var_35.v.pair.car) : LVI_NIL());
lval var_120;
var_120 = LVI_INT((unsigned char) var_119.v.chr);
lval var_121;
var_121 = LVI_INT(var_120.v.iv - var_37.v.iv);
lval var_122;
var_122 = LVI_INT(var_118.v.iv + var_121.v.iv);
var_48 = var_122;
lval var_123;
if (var_35.vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_123 = (var_35.v.pair.cdr ? *(var_35.v.pair.cdr) : LVI_NIL());
var_35 = var_123;
lval var_124;
var_124 = LVI_INT(1);
lval var_125;
var_125 = LVI_INT(var_111.v.iv + var_124.v.iv);
var_112 = var_125;
var_111 = var_112;
} while (1);
}
lval var_127;
var_127 = LVI_BOOL(true);
do {
lval var_128;
if (var_35.vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_128 = (var_35.v.pair.cdr ? *(var_35.v.pair.cdr) : LVI_NIL());
lval var_129;
var_129 = LVI_BOOL(var_128.vt == LV_NIL);
var_127 = var_129;
if (LV_IS_FALSE(var_127)) { break; }
lval var_130;
var_130 = LVI_BOOL(false);
do {
lval var_131;
if (var_35.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_131 = (var_35.v.pair.car ? *(var_35.v.pair.car) : LVI_NIL());
lval var_132;
var_132 = LVI_CHAR(37);
lval var_133;
var_133 = LVI_BOOL(var_131.v.chr == var_132.v.chr);
var_130 = var_133;
if (!LV_IS_FALSE(var_130)) { break; }
lval var_134;
if (var_35.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_134 = (var_35.v.pair.car ? *(var_35.v.pair.car) : LVI_NIL());
lval var_135;
var_135 = LVI_CHAR(115);
lval var_136;
var_136 = LVI_BOOL(var_134.v.chr == var_135.v.chr);
var_130 = var_136;
if (!LV_IS_FALSE(var_130)) { break; }
lval var_137;
if (var_35.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_137 = (var_35.v.pair.car ? *(var_35.v.pair.car) : LVI_NIL());
lval var_138;
var_138 = LVI_CHAR(99);
lval var_139;
var_139 = LVI_BOOL(var_137.v.chr == var_138.v.chr);
var_130 = var_139;
if (!LV_IS_FALSE(var_130)) { break; }
lval var_140;
if (var_35.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_140 = (var_35.v.pair.car ? *(var_35.v.pair.car) : LVI_NIL());
lval var_141;
var_141 = LVI_CHAR(118);
lval var_142;
var_142 = LVI_BOOL(var_140.v.chr == var_141.v.chr);
var_130 = var_142;
if (!LV_IS_FALSE(var_130)) { break; }
lval var_143;
if (var_35.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_143 = (var_35.v.pair.car ? *(var_35.v.pair.car) : LVI_NIL());
lval var_144;
var_144 = LVI_CHAR(98);
lval var_145;
var_145 = LVI_BOOL(var_143.v.chr == var_144.v.chr);
var_130 = var_145;
if (!LV_IS_FALSE(var_130)) { break; }
lval var_146;
if (var_35.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_146 = (var_35.v.pair.car ? *(var_35.v.pair.car) : LVI_NIL());
lval var_147;
var_147 = LVI_CHAR(111);
lval var_148;
var_148 = LVI_BOOL(var_146.v.chr == var_147.v.chr);
var_130 = var_148;
if (!LV_IS_FALSE(var_130)) { break; }
lval var_149;
if (var_35.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_149 = (var_35.v.pair.car ? *(var_35.v.pair.car) : LVI_NIL());
lval var_150;
var_150 = LVI_CHAR(100);
lval var_151;
var_151 = LVI_BOOL(var_149.v.chr == var_150.v.chr);
var_130 = var_151;
if (!LV_IS_FALSE(var_130)) { break; }
lval var_152;
if (var_35.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_152 = (var_35.v.pair.car ? *(var_35.v.pair.car) : LVI_NIL());
lval var_153;
var_153 = LVI_CHAR(120);
lval var_154;
var_154 = LVI_BOOL(var_152.v.chr == var_153.v.chr);
var_130 = var_154;
if (!LV_IS_FALSE(var_130)) { break; }
lval var_155;
if (var_35.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_155 = (var_35.v.pair.car ? *(var_35.v.pair.car) : LVI_NIL());
lval var_156;
var_156 = LVI_CHAR(102);
lval var_157;
var_157 = LVI_BOOL(var_155.v.chr == var_156.v.chr);
var_130 = var_157;
if (!LV_IS_FALSE(var_130)) { break; }
lval var_158;
if (var_35.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_158 = (var_35.v.pair.car ? *(var_35.v.pair.car) : LVI_NIL());
lval var_159;
var_159 = LVI_CHAR(101);
lval var_160;
var_160 = LVI_BOOL(var_158.v.chr == var_159.v.chr);
var_130 = var_160;
if (!LV_IS_FALSE(var_130)) { break; }
} while (0);
var_127 = var_130;
if (LV_IS_FALSE(var_127)) { break; }
} while (0);
if (LV_IS_FALSE(var_127)) {
lval var_161;
var_161 = LVI_STRING("*printf error: malformed format string ");
lval var_162;
{
lval vs[2];
vs[0] = var_161;
vs[1] = var_33[0];
var_162 = gen_list(2, vs, NULL);
}
{
lval vs[6];
vs[0] = var_162;
var_162 = wile_string_append(NULL, vs);
}
lval var_163;
{
lval vs[1];
vs[0] = var_162;
var_163 = gen_list(1, vs, NULL);
}
if (var_163.vt == LV_PAIR && (var_163.v.pair.cdr == NULL || var_163.v.pair.cdr->vt == LV_NIL)) {
var_163 = (var_163.v.pair.car ? *(var_163.v.pair.car) : LVI_NIL());
}
cachalot->errval = new_lv(LV_NIL);
*(cachalot->errval) = var_163;
cachalot->l_whence = 0;
cachalot->c_whence = LISP_WHENCE;
longjmp(cachalot->cenv, 1);
} else {
(void)
 LVI_BOOL(false);
}
lval var_166;
var_166 = LVI_BOOL(true);
do {
lval var_167;
var_167 = LVI_STRING("+");
lval var_168;
var_168 = LVI_BOOL(strcmp(var_42.v.str, var_167.v.str) == 0);
var_166 = var_168;
if (LV_IS_FALSE(var_166)) { break; }
lval var_169;
var_169 = LVI_BOOL(false);
do {
lval var_170;
if (var_35.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_170 = (var_35.v.pair.car ? *(var_35.v.pair.car) : LVI_NIL());
lval var_171;
var_171 = LVI_CHAR(98);
lval var_172;
var_172 = LVI_BOOL(var_170.v.chr == var_171.v.chr);
var_169 = var_172;
if (!LV_IS_FALSE(var_169)) { break; }
lval var_173;
if (var_35.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_173 = (var_35.v.pair.car ? *(var_35.v.pair.car) : LVI_NIL());
lval var_174;
var_174 = LVI_CHAR(111);
lval var_175;
var_175 = LVI_BOOL(var_173.v.chr == var_174.v.chr);
var_169 = var_175;
if (!LV_IS_FALSE(var_169)) { break; }
lval var_176;
if (var_35.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_176 = (var_35.v.pair.car ? *(var_35.v.pair.car) : LVI_NIL());
lval var_177;
var_177 = LVI_CHAR(120);
lval var_178;
var_178 = LVI_BOOL(var_176.v.chr == var_177.v.chr);
var_169 = var_178;
if (!LV_IS_FALSE(var_169)) { break; }
} while (0);
var_166 = var_169;
if (LV_IS_FALSE(var_166)) { break; }
} while (0);
if (LV_IS_FALSE(var_166)) {
(void)
 LVI_BOOL(false);
} else {
lval var_180;
var_180 = LVI_STRING(" ");
var_42 = var_180;
}
lval var_181;
if (var_35.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_181 = (var_35.v.pair.car ? *(var_35.v.pair.car) : LVI_NIL());
lval var_182;
{
lval vs[6];
vs[0] = var_181;
vs[1] = var_44;
vs[2] = var_40;
vs[3] = var_42;
vs[4] = var_48;
vs[5] = var_46;
var_182 = gen_list(6, vs, NULL);
}
return var_182;
}
// end of function fn_18

// string-pad-right
static lval fn_187(lptr* var_188, lptr var_189)
{
lval var_191;
{
lval vs[6];
vs[0] = var_189[0];
vs[1] = var_189[1];
vs[2] = var_189[2];
var_191 = wile_string_pad_right(NULL, vs);
}
return var_191;
}
// end of prim fn_187

// string-pad-center
static lval fn_192(lptr* var_193, lptr var_194)
{
lval var_196;
{
lval vs[6];
vs[0] = var_194[0];
vs[1] = var_194[1];
vs[2] = var_194[2];
var_196 = wile_string_pad_center(NULL, vs);
}
return var_196;
}
// end of prim fn_192

// string-pad-left
static lval fn_197(lptr* var_198, lptr var_199)
{
lval var_201;
{
lval vs[6];
vs[0] = var_199[0];
vs[1] = var_199[1];
vs[2] = var_199[2];
var_201 = wile_string_pad_left(NULL, vs);
}
return var_201;
}
// end of prim fn_197

// (align-str width align str)
static lval fn_19(lptr* var_183, lptr var_184)
{
lval var_186;
if (var_184[1].vt != LV_CHAR) {
wile_exception2("case", __FILE__, __LINE__, "case-value type does not match case type");
}
switch (var_184[1].v.chr) {
case 108:
{
var_186 = LVI_PROC(fn_187,NULL,3);
}
break;
case 109:
{
var_186 = LVI_PROC(fn_192,NULL,3);
}
break;
case 114:
{
var_186 = LVI_PROC(fn_197,NULL,3);
}
break;
default:
{
lval var_202;
var_202 = LVI_STRING("*printf error: malformed alignment");
lval var_203;
{
lval vs[1];
vs[0] = var_202;
var_203 = gen_list(1, vs, NULL);
}
if (var_203.vt == LV_PAIR && (var_203.v.pair.cdr == NULL || var_203.v.pair.cdr->vt == LV_NIL)) {
var_203 = (var_203.v.pair.car ? *(var_203.v.pair.car) : LVI_NIL());
}
cachalot->errval = new_lv(LV_NIL);
*(cachalot->errval) = var_203;
cachalot->l_whence = 0;
cachalot->c_whence = LISP_WHENCE;
longjmp(cachalot->cenv, 1);
var_186 = var_203;
}
break;
}
lval var_204;
var_204 = LVI_CHAR(32);
lval var_205;
{
lval vs[3];
vs[0] = var_184[2];
vs[1] = var_204;
vs[2] = var_184[0];
var_205 = gen_list(3, vs, NULL);
}
lval var_206;
{
lval vs[2];
vs[0] = var_186;
vs[1] = var_205;
var_206 = gen_list(2, vs, NULL);
}
var_206 = wile_apply_function(&(var_206), __FILE__, __LINE__);
return var_206;
}
// end of function fn_19

// char->string
static lval fn_239(lptr* var_240, lptr var_241)
{
lval var_243;
var_243 = var_241[0];
{
lval vs[6];
vs[0] = var_243;
var_243 = wile_char2string(NULL, vs);
}
return var_243;
}
// end of prim fn_239

// lambda (p a)
static lval fn_231(lptr* var_232, lptr var_233)
{
lbl_234:;
lval var_235;
lval var_236;
if (var_233[0].vt == LV_FILE_PORT || var_233[0].vt == LV_PIPE_PORT || var_233[0].vt == LV_SOCK_PORT) {
int c = fgetc(var_233[0].v.fp);
var_236 = ((c == EOF) ? LVI_BOOL(false) : LVI_CHAR(c));
} else {
WILE_EX("read-char", "input is not a port");
}
var_235 = var_236;
lval var_237;
if (LV_IS_FALSE(var_235)) {
{
lval vs[6];
vs[0] = var_233[0];
(void)
 wile_closeport(NULL, vs);
}
lval var_244;
{
lval vs[6];
vs[0] = var_233[1];
var_244 = wile_list_reverse(NULL, vs);
}
lval var_245;
{
lval vs[2];
vs[0] = LVI_PROC(fn_239,NULL,-1);
vs[1] = var_244;
var_245 = gen_list(2, vs, NULL);
}
var_245 = wile_apply_function(&(var_245), __FILE__, __LINE__);
var_237 = var_245;
} else {
lval var_246;
{
lptr p1 = NULL, p2 = NULL;
if (var_235.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_235;
}
if (var_233[1].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_233[1];
}
var_246 = LVI_PAIR(p1, p2);
}
lval var_249[6];
var_249[0] = var_233[0];
var_249[1] = var_246;
var_233[0] = var_249[0];
var_233[1] = var_249[1];
goto lbl_234;	// selfie
}
return var_237;
}
// end of lambda fn_231

// (disp-obj val)
static lval fn_20(lptr* var_207, lptr var_208)
{
lval var_210;
lval var_211;
var_211 = LVI_STRING("WILE_SCRATCH_DIRECTORY");
lval var_212;
{
char* ev = getenv(var_211.v.str);
var_212 = (ev ? LVI_STRING(ev) : LVI_BOOL(false));
}
var_210 = var_212;
lval var_213;
lval var_214;
var_214 = LVI_STRING("sprintf-scratch.XXXXXX");
var_213 = var_214;
lval var_215;
lval var_216;
if (LV_IS_FALSE(var_210)) {
var_216 = var_213;
} else {
lval var_217;
var_217 = LVI_STRING("/");
lval var_218;
{
lval vs[3];
vs[0] = var_210;
vs[1] = var_217;
vs[2] = var_213;
var_218 = gen_list(3, vs, NULL);
}
{
lval vs[6];
vs[0] = var_218;
var_218 = wile_string_append(NULL, vs);
}
var_216 = var_218;
}
var_215 = var_216;
lval var_219;
lval var_220;
{
lval vs[6];
vs[0] = var_215;
var_220 = wile_temp_file(NULL, vs);
}
var_219 = var_220;
lval var_221;
lval var_222;
if (var_219.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_222 = (var_219.v.pair.car ? *(var_219.v.pair.car) : LVI_NIL());
var_221 = var_222;
lval var_223;
lval var_224;
var_224 = LVI_STRING("cadr");
lval var_225;
{
char* cp = strchr(var_224.v.str, 'r');
var_225 = var_219;
while (*(--cp) != 'c') {
if (var_225.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_225 = (var_225.v.pair.car ? *(var_225.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_225 = (var_225.v.pair.cdr ? *(var_225.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_224.v.str);
}
}
}
var_223 = var_225;
(void)
 LVI_BOOL(unlink(var_223.v.str) == 0);
if (var_221.vt == LV_FILE_PORT || var_221.vt == LV_PIPE_PORT || var_221.vt == LV_SOCK_PORT) {
display(var_208[0], var_221.v.fp);
(void)
 var_208[0];
} else {
WILE_EX("display", "expects a scheme value and a port");
}
lval var_228;
var_228 = LVI_INT(0);
lval var_229;
var_229 = LVI_SYMBOL("start");
{
lval vs[6];
vs[0] = var_221;
vs[1] = var_228;
vs[2] = var_229;
(void)
 wile_setfilepos3(NULL, vs);
}
lptr var_232[0];
lval var_250;
var_250 = LVI_NIL();
lval var_251;
lval var_252[6];
var_252[0] = var_221;
var_252[1] = var_250;
var_251 = fn_231(var_232, var_252);
return var_251;
}
// end of function fn_20

// -
static lval fn_437(lptr* var_438, lptr var_439)
{
lval var_441;
var_441 = var_439[0];
{
lval vs[6];
vs[0] = var_441;
var_441 = wile_subtract(NULL, vs);
}
return var_441;
}
// end of prim fn_437

// +
static lval fn_442(lptr* var_443, lptr var_444)
{
lval var_446;
var_446 = var_444[0];
{
lval vs[6];
vs[0] = var_446;
var_446 = wile_add(NULL, vs);
}
return var_446;
}
// end of prim fn_442

// lambda (acc fstr vs)
static lval fn_257(lptr* var_258, lptr var_259)
{
lbl_260:;
lval var_261;
lval var_262;
var_262 = LVI_STRING("%[0-9]*%|%c|%v|%[lrm]?[0-9]*s|%[lrm]?[ +]?[0-9]*[bodx]|%[lrm]?[ +]?[0-9]*(.[0-9]*)?[fe]");
lval var_263;
{
lval vs[6];
vs[0] = var_262;
vs[1] = var_259[1];
var_263 = wile_regex_match(NULL, vs);
}
var_261 = var_263;
lval var_264;
if (LV_IS_FALSE(var_261)) {
lval var_265;
lval var_266;
var_266 = LVI_CHAR(37);
lval var_267;
if (var_259[1].vt != LV_STRING || var_266.vt != LV_CHAR) {
WILE_EX("string-find-first-char", "expects a string and a character input");
}
{
char* pos = strchr(var_259[1].v.str, var_266.v.chr);
if (pos) {
var_267 = LVI_INT(pos - var_259[1].v.str);
} else {
var_267 = LVI_BOOL(false);
}
}
var_265 = var_267;
if (LV_IS_FALSE(var_265)) {
(void)
 LVI_BOOL(false);
} else {
lval var_270;
var_270 = LVI_STRING("*printf error: unknown format directive ");
lval var_271;
if (var_259[1].vt != LV_STRING) {
WILE_EX("string-copy", "expects a string input");
}
{
size_t len = strlen(var_259[1].v.str);
if (var_265.v.iv < 0 || (size_t) var_265.v.iv >= len) {
WILE_EX("string-copy", "start index is out of range");
}
var_271 = LVI_STRING(var_259[1].v.str + var_265.v.iv);
}
lval var_272;
{
lval vs[2];
vs[0] = var_270;
vs[1] = var_271;
var_272 = gen_list(2, vs, NULL);
}
{
lval vs[6];
vs[0] = var_272;
var_272 = wile_string_append(NULL, vs);
}
lval var_273;
{
lval vs[1];
vs[0] = var_272;
var_273 = gen_list(1, vs, NULL);
}
if (var_273.vt == LV_PAIR && (var_273.v.pair.cdr == NULL || var_273.v.pair.cdr->vt == LV_NIL)) {
var_273 = (var_273.v.pair.car ? *(var_273.v.pair.car) : LVI_NIL());
}
cachalot->errval = new_lv(LV_NIL);
*(cachalot->errval) = var_273;
cachalot->l_whence = 0;
cachalot->c_whence = LISP_WHENCE;
longjmp(cachalot->cenv, 1);
}
lval var_275;
var_275 = LVI_BOOL(var_259[2].vt == LV_NIL);
if (LV_IS_FALSE(var_275)) {
lval var_276;
var_276 = LVI_STRING("*printf error: excess arguments");
lval var_277;
{
lval vs[1];
vs[0] = var_276;
var_277 = gen_list(1, vs, NULL);
}
if (var_277.vt == LV_PAIR && (var_277.v.pair.cdr == NULL || var_277.v.pair.cdr->vt == LV_NIL)) {
var_277 = (var_277.v.pair.car ? *(var_277.v.pair.car) : LVI_NIL());
}
cachalot->errval = new_lv(LV_NIL);
*(cachalot->errval) = var_277;
cachalot->l_whence = 0;
cachalot->c_whence = LISP_WHENCE;
longjmp(cachalot->cenv, 1);
} else {
(void)
 LVI_BOOL(false);
}
lval var_279;
{
lptr p1 = NULL, p2 = NULL;
if (var_259[1].vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_259[1];
}
if (var_259[0].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_259[0];
}
var_279 = LVI_PAIR(p1, p2);
}
var_264 = var_279;
} else {
lval var_280;
lval var_281;
var_281 = LVI_STRING("cadr");
lval var_282;
{
char* cp = strchr(var_281.v.str, 'r');
var_282 = var_261;
while (*(--cp) != 'c') {
if (var_282.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_282 = (var_282.v.pair.car ? *(var_282.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_282 = (var_282.v.pair.cdr ? *(var_282.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_281.v.str);
}
}
}
var_280 = var_282;
lval var_283;
lval var_284;
var_284 = LVI_STRING("caddr");
lval var_285;
{
char* cp = strchr(var_284.v.str, 'r');
var_285 = var_261;
while (*(--cp) != 'c') {
if (var_285.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_285 = (var_285.v.pair.car ? *(var_285.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_285 = (var_285.v.pair.cdr ? *(var_285.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_284.v.str);
}
}
}
var_283 = var_285;
lval var_286;
lval var_287;
lval var_288[6];
var_288[0] = var_280;
var_287 = fn_18(NULL, var_288);
var_286 = var_287;
lval var_290;
lval var_291;
if (var_286.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_291 = (var_286.v.pair.car ? *(var_286.v.pair.car) : LVI_NIL());
var_290 = var_291;
lval var_292;
lval var_293;
var_293 = LVI_STRING("cadr");
lval var_294;
{
char* cp = strchr(var_293.v.str, 'r');
var_294 = var_286;
while (*(--cp) != 'c') {
if (var_294.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_294 = (var_294.v.pair.car ? *(var_294.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_294 = (var_294.v.pair.cdr ? *(var_294.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_293.v.str);
}
}
}
var_292 = var_294;
lval var_295;
lval var_296;
var_296 = LVI_STRING("caddr");
lval var_297;
{
char* cp = strchr(var_296.v.str, 'r');
var_297 = var_286;
while (*(--cp) != 'c') {
if (var_297.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_297 = (var_297.v.pair.car ? *(var_297.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_297 = (var_297.v.pair.cdr ? *(var_297.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_296.v.str);
}
}
}
var_295 = var_297;
lval var_298;
lval var_299;
var_299 = LVI_INT(3);
lval var_300;
{
lval vs[6];
vs[0] = var_286;
vs[1] = var_299;
var_300 = wile_list_ref(NULL, vs);
}
var_298 = var_300;
lval var_301;
lval var_302;
var_302 = LVI_INT(4);
lval var_303;
{
lval vs[6];
vs[0] = var_286;
vs[1] = var_302;
var_303 = wile_list_ref(NULL, vs);
}
var_301 = var_303;
lval var_305;
var_305 = LVI_INT(5);
{
lval vs[6];
vs[0] = var_286;
vs[1] = var_305;
(void)
 wile_list_ref(NULL, vs);
}
lval var_307;
if (var_261.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_307 = (var_261.v.pair.car ? *(var_261.v.pair.car) : LVI_NIL());
lval var_308;
{
lptr p1 = NULL, p2 = NULL;
if (var_307.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_307;
}
if (var_259[0].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_259[0];
}
var_308 = LVI_PAIR(p1, p2);
}
var_259[0] = var_308;
lval var_309;
lval var_310;
var_310 = LVI_CHAR(37);
lval var_311;
var_311 = LVI_BOOL(var_290.v.chr == var_310.v.chr);
if (LV_IS_FALSE(var_311)) {
lval var_313;
var_313 = LVI_BOOL(var_259[2].vt == LV_NIL);
if (LV_IS_FALSE(var_313)) {
(void)
 LVI_BOOL(false);
} else {
lval var_315;
var_315 = LVI_STRING("*printf error: not enough arguments");
lval var_316;
{
lval vs[1];
vs[0] = var_315;
var_316 = gen_list(1, vs, NULL);
}
if (var_316.vt == LV_PAIR && (var_316.v.pair.cdr == NULL || var_316.v.pair.cdr->vt == LV_NIL)) {
var_316 = (var_316.v.pair.car ? *(var_316.v.pair.car) : LVI_NIL());
}
cachalot->errval = new_lv(LV_NIL);
*(cachalot->errval) = var_316;
cachalot->l_whence = 0;
cachalot->c_whence = LISP_WHENCE;
longjmp(cachalot->cenv, 1);
}
lval var_317;
lval var_318;
if (var_259[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_318 = (var_259[2].v.pair.car ? *(var_259[2].v.pair.car) : LVI_NIL());
var_317 = var_318;
lval var_319;
do {
lval var_320;
var_320 = LVI_CHAR(99);
lval var_321;
var_321 = LVI_BOOL(var_290.v.chr == var_320.v.chr);
if (!LV_IS_FALSE(var_321)) {
lval var_322;
do {
lval var_323;
var_323 = LVI_BOOL(var_317.vt == LV_CHAR);
if (!LV_IS_FALSE(var_323)) {
lval var_324;
{
lptr p1 = NULL, p2 = NULL;
if (var_317.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_317;
}
if (var_259[0].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_259[0];
}
var_324 = LVI_PAIR(p1, p2);
}
lval var_325;
if (var_259[2].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_325 = (var_259[2].v.pair.cdr ? *(var_259[2].v.pair.cdr) : LVI_NIL());
lval var_328[6];
var_328[0] = var_324;
var_328[1] = var_283;
var_328[2] = var_325;
var_259[0] = var_328[0];
var_259[1] = var_328[1];
var_259[2] = var_328[2];
goto lbl_260;	// selfie
}
lval var_329;
var_329 = LVI_CHAR(99);
lval var_330;
lval var_331[6];
var_331[0] = var_317;
var_331[1] = var_329;
var_330 = fn_1(NULL, var_331);
lval var_333;
{
lval vs[1];
vs[0] = var_330;
var_333 = gen_list(1, vs, NULL);
}
if (var_333.vt == LV_PAIR && (var_333.v.pair.cdr == NULL || var_333.v.pair.cdr->vt == LV_NIL)) {
var_333 = (var_333.v.pair.car ? *(var_333.v.pair.car) : LVI_NIL());
}
cachalot->errval = new_lv(LV_NIL);
*(cachalot->errval) = var_333;
cachalot->l_whence = 0;
cachalot->c_whence = LISP_WHENCE;
longjmp(cachalot->cenv, 1);
var_322 = var_333;
} while (0);
var_319 = var_322;
break;
}
lval var_334;
var_334 = LVI_CHAR(118);
lval var_335;
var_335 = LVI_BOOL(var_290.v.chr == var_334.v.chr);
if (!LV_IS_FALSE(var_335)) {
lval var_336;
lval var_337;
var_337 = LVI_BOOL(false);
do {
lval var_338;
var_338 = LVI_BOOL(var_317.vt == LV_STRING);
var_337 = var_338;
if (!LV_IS_FALSE(var_337)) { break; }
lval var_339;
var_339 = LVI_BOOL(var_317.vt == LV_CHAR);
var_337 = var_339;
if (!LV_IS_FALSE(var_337)) { break; }
} while (0);
if (LV_IS_FALSE(var_337)) {
lval var_340;
lval var_341[6];
var_341[0] = var_317;
var_340 = fn_20(NULL, var_341);
var_336 = var_340;
} else {
var_336 = var_317;
}
lval var_343;
{
lptr p1 = NULL, p2 = NULL;
if (var_336.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_336;
}
if (var_259[0].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_259[0];
}
var_343 = LVI_PAIR(p1, p2);
}
lval var_344;
if (var_259[2].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_344 = (var_259[2].v.pair.cdr ? *(var_259[2].v.pair.cdr) : LVI_NIL());
lval var_347[6];
var_347[0] = var_343;
var_347[1] = var_283;
var_347[2] = var_344;
var_259[0] = var_347[0];
var_259[1] = var_347[1];
var_259[2] = var_347[2];
goto lbl_260;	// selfie
}
lval var_348;
var_348 = LVI_CHAR(115);
lval var_349;
var_349 = LVI_BOOL(var_290.v.chr == var_348.v.chr);
if (!LV_IS_FALSE(var_349)) {
lval var_350;
do {
lval var_351;
var_351 = LVI_BOOL(var_317.vt == LV_STRING);
if (!LV_IS_FALSE(var_351)) {
lval var_352;
lval var_353[6];
var_353[0] = var_292;
var_353[1] = var_295;
var_353[2] = var_317;
var_352 = fn_19(NULL, var_353);
lval var_355;
{
lptr p1 = NULL, p2 = NULL;
if (var_352.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_352;
}
if (var_259[0].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_259[0];
}
var_355 = LVI_PAIR(p1, p2);
}
lval var_356;
if (var_259[2].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_356 = (var_259[2].v.pair.cdr ? *(var_259[2].v.pair.cdr) : LVI_NIL());
lval var_359[6];
var_359[0] = var_355;
var_359[1] = var_283;
var_359[2] = var_356;
var_259[0] = var_359[0];
var_259[1] = var_359[1];
var_259[2] = var_359[2];
goto lbl_260;	// selfie
}
lval var_360;
var_360 = LVI_BOOL(var_317.vt == LV_CHAR);
if (!LV_IS_FALSE(var_360)) {
lval var_361;
{
lval vs[1];
vs[0] = var_317;
var_361 = gen_list(1, vs, NULL);
}
{
lval vs[6];
vs[0] = var_361;
var_361 = wile_char2string(NULL, vs);
}
lval var_362;
lval var_363[6];
var_363[0] = var_292;
var_363[1] = var_295;
var_363[2] = var_361;
var_362 = fn_19(NULL, var_363);
lval var_365;
{
lptr p1 = NULL, p2 = NULL;
if (var_362.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_362;
}
if (var_259[0].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_259[0];
}
var_365 = LVI_PAIR(p1, p2);
}
lval var_366;
if (var_259[2].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_366 = (var_259[2].v.pair.cdr ? *(var_259[2].v.pair.cdr) : LVI_NIL());
lval var_369[6];
var_369[0] = var_365;
var_369[1] = var_283;
var_369[2] = var_366;
var_259[0] = var_369[0];
var_259[1] = var_369[1];
var_259[2] = var_369[2];
goto lbl_260;	// selfie
}
lval var_370;
var_370 = LVI_BOOL(var_317.vt == LV_SYMBOL);
if (!LV_IS_FALSE(var_370)) {
lval var_371;
var_371 = LVI_STRING(var_317.v.str);
lval var_372;
lval var_373[6];
var_373[0] = var_292;
var_373[1] = var_295;
var_373[2] = var_371;
var_372 = fn_19(NULL, var_373);
lval var_375;
{
lptr p1 = NULL, p2 = NULL;
if (var_372.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_372;
}
if (var_259[0].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_259[0];
}
var_375 = LVI_PAIR(p1, p2);
}
lval var_376;
if (var_259[2].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_376 = (var_259[2].v.pair.cdr ? *(var_259[2].v.pair.cdr) : LVI_NIL());
lval var_379[6];
var_379[0] = var_375;
var_379[1] = var_283;
var_379[2] = var_376;
var_259[0] = var_379[0];
var_259[1] = var_379[1];
var_259[2] = var_379[2];
goto lbl_260;	// selfie
}
lval var_380;
var_380 = LVI_CHAR(115);
lval var_381;
lval var_382[6];
var_382[0] = var_317;
var_382[1] = var_380;
var_381 = fn_1(NULL, var_382);
lval var_384;
{
lval vs[1];
vs[0] = var_381;
var_384 = gen_list(1, vs, NULL);
}
if (var_384.vt == LV_PAIR && (var_384.v.pair.cdr == NULL || var_384.v.pair.cdr->vt == LV_NIL)) {
var_384 = (var_384.v.pair.car ? *(var_384.v.pair.car) : LVI_NIL());
}
cachalot->errval = new_lv(LV_NIL);
*(cachalot->errval) = var_384;
cachalot->l_whence = 0;
cachalot->c_whence = LISP_WHENCE;
longjmp(cachalot->cenv, 1);
var_350 = var_384;
} while (0);
var_319 = var_350;
break;
}
lval var_385;
var_385 = LVI_BOOL(false);
do {
lval var_386;
var_386 = LVI_CHAR(98);
lval var_387;
var_387 = LVI_BOOL(var_290.v.chr == var_386.v.chr);
var_385 = var_387;
if (!LV_IS_FALSE(var_385)) { break; }
lval var_388;
var_388 = LVI_CHAR(111);
lval var_389;
var_389 = LVI_BOOL(var_290.v.chr == var_388.v.chr);
var_385 = var_389;
if (!LV_IS_FALSE(var_385)) { break; }
lval var_390;
var_390 = LVI_CHAR(100);
lval var_391;
var_391 = LVI_BOOL(var_290.v.chr == var_390.v.chr);
var_385 = var_391;
if (!LV_IS_FALSE(var_385)) { break; }
lval var_392;
var_392 = LVI_CHAR(120);
lval var_393;
var_393 = LVI_BOOL(var_290.v.chr == var_392.v.chr);
var_385 = var_393;
if (!LV_IS_FALSE(var_385)) { break; }
} while (0);
if (!LV_IS_FALSE(var_385)) {
lval var_395;
var_395 = LVI_BOOL(var_317.vt == LV_RAT || var_317.vt == LV_INT);
if (LV_IS_FALSE(var_395)) {
lval var_396;
lval var_397[6];
var_397[0] = var_317;
var_397[1] = var_290;
var_396 = fn_1(NULL, var_397);
lval var_399;
{
lval vs[1];
vs[0] = var_396;
var_399 = gen_list(1, vs, NULL);
}
if (var_399.vt == LV_PAIR && (var_399.v.pair.cdr == NULL || var_399.v.pair.cdr->vt == LV_NIL)) {
var_399 = (var_399.v.pair.car ? *(var_399.v.pair.car) : LVI_NIL());
}
cachalot->errval = new_lv(LV_NIL);
*(cachalot->errval) = var_399;
cachalot->l_whence = 0;
cachalot->c_whence = LISP_WHENCE;
longjmp(cachalot->cenv, 1);
} else {
(void)
 LVI_BOOL(false);
}
lval var_401;
lval var_402;
if (var_290.vt != LV_CHAR) {
wile_exception2("case", __FILE__, __LINE__, "case-value type does not match case type");
}
switch (var_290.v.chr) {
case 98:
{
lval var_403;
var_403 = LVI_INT(2);
var_402 = var_403;
}
break;
case 111:
{
lval var_404;
var_404 = LVI_INT(8);
var_402 = var_404;
}
break;
case 100:
{
lval var_405;
var_405 = LVI_INT(10);
var_402 = var_405;
}
break;
case 120:
{
lval var_406;
var_406 = LVI_INT(16);
var_402 = var_406;
}
break;
default:
var_402 = LVI_BOOL(false);
}
var_401 = var_402;
lval var_407;
lval var_408;
if (var_401.vt == LV_INT) {
var_408 = num2string(var_317, var_401.v.iv, INT_MIN, __FILE__, __LINE__);
} else {
WILE_EX("number->string", "base is not numeric");
}
var_407 = var_408;
lval var_409;
lval var_410;
lval var_411;
switch (var_317.vt) {
case LV_REAL:
var_411 = LVI_BOOL(var_317.v.rv < 0.0);
break;
case LV_RAT:
var_411 = LVI_BOOL((var_317.v.irv.num < 0 && var_317.v.irv.den >= 0) || (var_317.v.irv.num > 0 && var_317.v.irv.den < 0));
break;
case LV_INT:
var_411 = LVI_BOOL(var_317.v.iv < 0);
break;
default:
WILE_EX("negative?", "expects a real-valued number");
}
if (LV_IS_FALSE(var_411)) {
lval var_412;
{
lval vs[2];
vs[0] = var_298;
vs[1] = var_407;
var_412 = gen_list(2, vs, NULL);
}
{
lval vs[6];
vs[0] = var_412;
var_412 = wile_string_append(NULL, vs);
}
var_410 = var_412;
} else {
var_410 = var_407;
}
var_409 = var_410;
lval var_413;
lval var_414[6];
var_414[0] = var_292;
var_414[1] = var_295;
var_414[2] = var_409;
var_413 = fn_19(NULL, var_414);
lval var_416;
{
lptr p1 = NULL, p2 = NULL;
if (var_413.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_413;
}
if (var_259[0].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_259[0];
}
var_416 = LVI_PAIR(p1, p2);
}
lval var_417;
if (var_259[2].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_417 = (var_259[2].v.pair.cdr ? *(var_259[2].v.pair.cdr) : LVI_NIL());
lval var_420[6];
var_420[0] = var_416;
var_420[1] = var_283;
var_420[2] = var_417;
var_259[0] = var_420[0];
var_259[1] = var_420[1];
var_259[2] = var_420[2];
goto lbl_260;	// selfie
}
lval var_421;
var_421 = LVI_BOOL(false);
do {
lval var_422;
var_422 = LVI_CHAR(102);
lval var_423;
var_423 = LVI_BOOL(var_290.v.chr == var_422.v.chr);
var_421 = var_423;
if (!LV_IS_FALSE(var_421)) { break; }
lval var_424;
var_424 = LVI_CHAR(101);
lval var_425;
var_425 = LVI_BOOL(var_290.v.chr == var_424.v.chr);
var_421 = var_425;
if (!LV_IS_FALSE(var_421)) { break; }
} while (0);
if (!LV_IS_FALSE(var_421)) {
lval var_427;
var_427 = LVI_BOOL(var_317.vt == LV_CMPLX || var_317.vt == LV_REAL || var_317.vt == LV_RAT || var_317.vt == LV_INT);
if (LV_IS_FALSE(var_427)) {
lval var_428;
lval var_429[6];
var_429[0] = var_317;
var_429[1] = var_290;
var_428 = fn_1(NULL, var_429);
lval var_431;
{
lval vs[1];
vs[0] = var_428;
var_431 = gen_list(1, vs, NULL);
}
if (var_431.vt == LV_PAIR && (var_431.v.pair.cdr == NULL || var_431.v.pair.cdr->vt == LV_NIL)) {
var_431 = (var_431.v.pair.car ? *(var_431.v.pair.car) : LVI_NIL());
}
cachalot->errval = new_lv(LV_NIL);
*(cachalot->errval) = var_431;
cachalot->l_whence = 0;
cachalot->c_whence = LISP_WHENCE;
longjmp(cachalot->cenv, 1);
} else {
(void)
 LVI_BOOL(false);
}
lval var_433;
lval var_434;
lval var_435;
var_435 = LVI_CHAR(102);
lval var_436;
var_436 = LVI_BOOL(var_290.v.chr == var_435.v.chr);
if (LV_IS_FALSE(var_436)) {
var_434 = LVI_PROC(fn_437,NULL,-1);
} else {
var_434 = LVI_PROC(fn_442,NULL,-1);
}
lval var_447;
if (LV_IS_FALSE(var_301)) {
lval var_448;
var_448 = LVI_INT(12);
var_447 = var_448;
} else {
var_447 = var_301;
}
lval var_449;
{
lval vs[1];
vs[0] = var_447;
var_449 = gen_list(1, vs, NULL);
}
lval var_450;
{
lval vs[2];
vs[0] = var_434;
vs[1] = var_449;
var_450 = gen_list(2, vs, NULL);
}
var_450 = wile_apply_function(&(var_450), __FILE__, __LINE__);
var_433 = var_450;
lval var_451;
lval var_452;
var_452 = LVI_INT(10);
lval var_453;
if (var_452.vt == LV_INT && var_433.vt == LV_INT) {
var_453 = num2string(var_317, var_452.v.iv, var_433.v.iv, __FILE__, __LINE__);
} else {
WILE_EX("number->string", "base or precision is not numeric");
}
var_451 = var_453;
lval var_454;
lval var_455;
lval var_456;
switch (var_317.vt) {
case LV_REAL:
var_456 = LVI_BOOL(var_317.v.rv < 0.0);
break;
case LV_RAT:
var_456 = LVI_BOOL((var_317.v.irv.num < 0 && var_317.v.irv.den >= 0) || (var_317.v.irv.num > 0 && var_317.v.irv.den < 0));
break;
case LV_INT:
var_456 = LVI_BOOL(var_317.v.iv < 0);
break;
default:
WILE_EX("negative?", "expects a real-valued number");
}
if (LV_IS_FALSE(var_456)) {
lval var_457;
{
lval vs[2];
vs[0] = var_298;
vs[1] = var_451;
var_457 = gen_list(2, vs, NULL);
}
{
lval vs[6];
vs[0] = var_457;
var_457 = wile_string_append(NULL, vs);
}
var_455 = var_457;
} else {
var_455 = var_451;
}
var_454 = var_455;
lval var_458;
lval var_459[6];
var_459[0] = var_292;
var_459[1] = var_295;
var_459[2] = var_454;
var_458 = fn_19(NULL, var_459);
lval var_461;
{
lptr p1 = NULL, p2 = NULL;
if (var_458.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_458;
}
if (var_259[0].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_259[0];
}
var_461 = LVI_PAIR(p1, p2);
}
lval var_462;
if (var_259[2].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_462 = (var_259[2].v.pair.cdr ? *(var_259[2].v.pair.cdr) : LVI_NIL());
lval var_465[6];
var_465[0] = var_461;
var_465[1] = var_283;
var_465[2] = var_462;
var_259[0] = var_465[0];
var_259[1] = var_465[1];
var_259[2] = var_465[2];
goto lbl_260;	// selfie
}
var_319 = LVI_BOOL(false);
} while (0);
var_309 = var_319;
} else {
lval var_466;
var_466 = LVI_INT(1);
lval var_467;
{
lval vs[2];
vs[0] = var_292;
vs[1] = var_466;
var_467 = gen_list(2, vs, NULL);
}
{
lval vs[6];
vs[0] = var_467;
var_467 = wile_max(NULL, vs);
}
lval var_468;
var_468 = LVI_CHAR(37);
lval var_469;
if (var_467.vt != LV_INT || var_467.v.iv < 0) {
WILE_EX("string-create", "first input is not a non-negative integer");
}
if (var_468.vt != LV_CHAR || var_468.v.chr == '\0') {
WILE_EX("string-create", "second input is not a valid character");
}
var_469.vt = LV_STRING;
var_469.v.str = LISP_ALLOC(char, 1 + var_467.v.iv);
LISP_ASSERT(var_469.v.str != NULL);
memset(var_469.v.str, var_468.v.chr, var_467.v.iv);
var_469.v.str[var_467.v.iv] = '\0';
lval var_470;
{
lptr p1 = NULL, p2 = NULL;
if (var_469.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_469;
}
if (var_259[0].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_259[0];
}
var_470 = LVI_PAIR(p1, p2);
}
lval var_473[6];
var_473[0] = var_470;
var_473[1] = var_283;
var_473[2] = var_259[2];
var_259[0] = var_473[0];
var_259[1] = var_473[1];
var_259[2] = var_473[2];
goto lbl_260;	// selfie
}
var_264 = var_309;
}
return var_264;
}
// end of lambda fn_257

// (printf-helper fstr . vals)
static lval fn_21(lptr* var_254, lptr var_255)
{
lptr var_258[0];
lval var_474;
var_474 = LVI_NIL();
lval var_475;
lval var_476[6];
var_476[0] = var_474;
var_476[1] = var_255[0];
var_476[2] = var_255[1];
var_475 = fn_257(var_258, var_476);
return var_475;
}
// end of function fn_21

// lambda (s)
static lval fn_481(lptr* var_482, lptr var_483)
{
lval var_485;
if (var_483[0].vt == LV_CHAR) {
fputc(var_483[0].v.chr, stdout);
} else if (var_483[0].vt == LV_STRING) {
fputs(var_483[0].v.str, stdout);
} else {
WILE_EX("write-string", "input is not a string or char!");
}
var_485 = LVI_BOOL(true);
return var_485;
}
// end of lambda fn_481

// (printf fstr . vals)
lval wile_printf(lptr* var_478, lptr var_479)
{
lptr var_482[0];
lval var_486;
var_486 = LVI_PROC(fn_21,NULL,-2);
lval var_487;
{
lval vs[3];
vs[0] = var_486;
vs[1] = var_479[0];
vs[2] = var_479[1];
var_487 = gen_list(3, vs, NULL);
}
var_487 = wile_apply_function(&(var_487), __FILE__, __LINE__);
lval var_488;
{
lval vs[6];
vs[0] = var_487;
var_488 = wile_list_reverse(NULL, vs);
}
lval var_489;
var_489 = LVI_NIL();
{
lval vs[6];
vs[0] = LVI_PROC(fn_481,var_482,1);
vs[1] = var_488;
vs[2] = var_489;
var_489 = wile_for_each(NULL, vs);
}
return var_489;
}
// end of function wile_printf

// lambda (s)
static lval fn_493(lptr* var_494, lptr var_495)
{
lval var_497;
{
FILE* fp;
if ((*(var_494[0])).vt == LV_FILE_PORT || (*(var_494[0])).vt == LV_PIPE_PORT || (*(var_494[0])).vt == LV_SOCK_PORT) {
fp = (*(var_494[0])).v.fp;
} else {
WILE_EX("write-string", "first input is not a port!");
}
if (var_495[0].vt == LV_CHAR) {
fputc(var_495[0].v.chr, fp);
} else if (var_495[0].vt == LV_STRING) {
fputs(var_495[0].v.str, fp);
} else {
WILE_EX("write-string", "second input is not a string or char!");
}
var_497 = LVI_BOOL(true);
}
return var_497;
}
// end of lambda fn_493

// (fprintf port fstr . vals)
lval wile_fprintf(lptr* var_490, lptr var_491)
{
lptr var_494[1];
var_494[0] = &(var_491[0]);
lval var_498;
var_498 = LVI_PROC(fn_21,NULL,-2);
lval var_499;
{
lval vs[3];
vs[0] = var_498;
vs[1] = var_491[1];
vs[2] = var_491[2];
var_499 = gen_list(3, vs, NULL);
}
var_499 = wile_apply_function(&(var_499), __FILE__, __LINE__);
lval var_500;
{
lval vs[6];
vs[0] = var_499;
var_500 = wile_list_reverse(NULL, vs);
}
lval var_501;
var_501 = LVI_NIL();
{
lval vs[6];
vs[0] = LVI_PROC(fn_493,var_494,1);
vs[1] = var_500;
vs[2] = var_501;
var_501 = wile_for_each(NULL, vs);
}
return var_501;
}
// end of function wile_fprintf

// string-append
static lval fn_505(lptr* var_506, lptr var_507)
{
lval var_509;
var_509 = var_507[0];
{
lval vs[6];
vs[0] = var_509;
var_509 = wile_string_append(NULL, vs);
}
return var_509;
}
// end of prim fn_505

// lambda (v)
static lval fn_510(lptr* var_511, lptr var_512)
{
lval var_514;
lval var_515;
var_515 = LVI_BOOL(var_512[0].vt == LV_STRING);
if (LV_IS_FALSE(var_515)) {
lval var_516;
{
lval vs[1];
vs[0] = var_512[0];
var_516 = gen_list(1, vs, NULL);
}
{
lval vs[6];
vs[0] = var_516;
var_516 = wile_char2string(NULL, vs);
}
var_514 = var_516;
} else {
var_514 = var_512[0];
}
return var_514;
}
// end of lambda fn_510

// (sprintf fstr . vals)
lval wile_sprintf(lptr* var_502, lptr var_503)
{
lptr var_511[0];
lval var_517;
var_517 = LVI_PROC(fn_21,NULL,-2);
lval var_518;
{
lval vs[3];
vs[0] = var_517;
vs[1] = var_503[0];
vs[2] = var_503[1];
var_518 = gen_list(3, vs, NULL);
}
var_518 = wile_apply_function(&(var_518), __FILE__, __LINE__);
lval var_519;
{
lval vs[6];
vs[0] = var_518;
var_519 = wile_list_reverse(NULL, vs);
}
lval var_520;
var_520 = LVI_NIL();
{
lval vs[6];
vs[0] = LVI_PROC(fn_510,var_511,1);
vs[1] = var_519;
vs[2] = var_520;
var_520 = wile_map(NULL, vs);
}
lval var_521;
{
lval vs[2];
vs[0] = LVI_PROC(fn_505,NULL,-1);
vs[1] = var_520;
var_521 = gen_list(2, vs, NULL);
}
var_521 = wile_apply_function(&(var_521), __FILE__, __LINE__);
return var_521;
}
// end of function wile_sprintf
