// Generated by wile, the extremely stable scheming genius compiler

#include "wile-rtl1.h"
#include "wile-rtl2.h"

// declarations

extern lval var_argv;
extern lval var_cmd_name;
extern lval var_stdin;
extern lval var_stdout;
extern lval var_stderr;
extern lval var_pi;
extern lval var_euler_gamma;
extern lval var_show_sign;
extern lval var_int_base;
extern lval var_flt_base;
extern lval var_flt_precision;
#include "wile-rtl2.h"
static lval fn_1(lptr*, lptr, const char*);	// (map1 proc lst)
static lval fn_2(lptr*, lptr, const char*);	// (map2 proc lst1 lst2)
static lval fn_3(lptr*, lptr, const char*);	// (map3 proc lst1 lst2 lst3)
static lval fn_4(lptr*, lptr, const char*);	// (map4 proc lst1 lst2 lst3 lst4)
static lval fn_5(lptr*, lptr, const char*);	// (map5 proc lst1 lst2 lst3 lst4 lst5)
static lval fn_9(lptr*, lptr, const char*);
static lval fn_49(lptr*, lptr, const char*);
static lval fn_96(lptr*, lptr, const char*);
static lval fn_149(lptr*, lptr, const char*);
static lval fn_208(lptr*, lptr, const char*);
static lval fn_242(lptr*, lptr, const char*);	// (m2 proc acc ls)

// definitions

// @@@ lambda (l1 acc) @@@ bld-rtl-dir/wile-rtl2-000028.scm:12 @@@ fn_9 @@@
static lval fn_9(lptr* var_10, lptr var_11, const char* cloc)
{
lbl_12:;
lval var_13;
lval var_14;
var_14 = LVI_BOOL(var_11[0].vt == LV_NIL);
if (LV_IS_FALSE(var_14)) {
lval var_15;
if (var_11[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_15 = (var_11[0].v.pair.cdr ? *(var_11[0].v.pair.cdr) : LVI_NIL());
lval var_16;
if (var_11[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_16 = (var_11[0].v.pair.car ? *(var_11[0].v.pair.car) : LVI_NIL());
lval var_17;
{
lval var_18[1];
var_18[0] = var_16;
var_17 = wile_gen_list(1, var_18, NULL);
}
lval var_19;
{
lval var_20[2];
var_20[0] = V_CLOS(var_10,0);
var_20[1] = var_17;
var_19 = wile_gen_list(2, var_20, NULL);
}
var_19 = wile_apply_function(&(var_19), LISP_WHENCE);
lval var_21;
{
lptr p1 = NULL, p2 = NULL;
if (var_19.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_19;
}
if (var_11[1].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_11[1];
}
var_21 = LVI_PAIR(p1, p2);
}
lval var_24[8];
var_24[0] = var_15;
var_24[1] = var_21;
var_11[0] = var_24[0];
var_11[1] = var_24[1];
// bld-rtl-dir/wile-rtl2-000028.scm:16
goto lbl_12;	// selfie
} else {
lval var_25;
{
lval var_26[8];
var_26[0] = var_11[1];
// bld-rtl-dir/wile-rtl2-000028.scm:15
var_25 = wile_list_reverse(NULL, var_26, "bld-rtl-dir/wile-rtl2-000028.scm:15");
}
var_13 = var_25;
}
return var_13;
}
// end of lambda fn_9

// @@@ (map1 proc lst) @@@ bld-rtl-dir/wile-rtl2-000028.scm:11 @@@ fn_1 @@@
static lval fn_1(lptr* var_6, lptr var_7, const char* cloc)
{
MK_CLOS(var_10,1);
lptr var_27 = new_lv(VT_UNINIT);
var_27->v.pair.car = &(var_7[0]);
P_CLOS(var_10,0) = var_27;
lval var_28;
var_28 = LVI_NIL();
lval var_29;
lval var_30[8];
var_30[0] = var_7[1];
var_30[1] = var_28;
// bld-rtl-dir/wile-rtl2-000028.scm:12
var_29 = fn_9(var_10, var_30, "bld-rtl-dir/wile-rtl2-000028.scm:12");
*var_27 = var_7[0];
return var_29;
}
// end of function fn_1

// @@@ lambda (l1 l2 acc) @@@ bld-rtl-dir/wile-rtl2-000028.scm:22 @@@ fn_49 @@@
static lval fn_49(lptr* var_50, lptr var_51, const char* cloc)
{
lbl_52:;
lval var_53;
lval var_54;
var_54 = LVI_BOOL(var_51[0].vt == LV_NIL);
if (LV_IS_FALSE(var_54)) {
lval var_55;
if (var_51[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_55 = (var_51[0].v.pair.cdr ? *(var_51[0].v.pair.cdr) : LVI_NIL());
lval var_56;
if (var_51[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_56 = (var_51[1].v.pair.cdr ? *(var_51[1].v.pair.cdr) : LVI_NIL());
lval var_57;
if (var_51[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_57 = (var_51[0].v.pair.car ? *(var_51[0].v.pair.car) : LVI_NIL());
lval var_58;
if (var_51[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_58 = (var_51[1].v.pair.car ? *(var_51[1].v.pair.car) : LVI_NIL());
lval var_59;
{
lval var_60[2];
var_60[0] = var_57;
var_60[1] = var_58;
var_59 = wile_gen_list(2, var_60, NULL);
}
lval var_61;
{
lval var_62[2];
var_62[0] = V_CLOS(var_50,0);
var_62[1] = var_59;
var_61 = wile_gen_list(2, var_62, NULL);
}
var_61 = wile_apply_function(&(var_61), LISP_WHENCE);
lval var_63;
{
lptr p1 = NULL, p2 = NULL;
if (var_61.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_61;
}
if (var_51[2].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_51[2];
}
var_63 = LVI_PAIR(p1, p2);
}
lval var_66[8];
var_66[0] = var_55;
var_66[1] = var_56;
var_66[2] = var_63;
var_51[0] = var_66[0];
var_51[1] = var_66[1];
var_51[2] = var_66[2];
// bld-rtl-dir/wile-rtl2-000028.scm:27
goto lbl_52;	// selfie
} else {
lval var_67;
{
lval var_68[8];
var_68[0] = var_51[2];
// bld-rtl-dir/wile-rtl2-000028.scm:26
var_67 = wile_list_reverse(NULL, var_68, "bld-rtl-dir/wile-rtl2-000028.scm:26");
}
var_53 = var_67;
}
return var_53;
}
// end of lambda fn_49

// @@@ (map2 proc lst1 lst2) @@@ bld-rtl-dir/wile-rtl2-000028.scm:18 @@@ fn_2 @@@
static lval fn_2(lptr* var_32, lptr var_33, const char* cloc)
{
lval var_35;
lval var_36;
{
lval var_37[8];
var_37[0] = var_33[1];
// bld-rtl-dir/wile-rtl2-000028.scm:19
var_36 = wile_list_length(NULL, var_37, "bld-rtl-dir/wile-rtl2-000028.scm:19");
}
var_35 = var_36;
lval var_38;
lval var_39;
{
lval var_40[8];
var_40[0] = var_33[2];
// bld-rtl-dir/wile-rtl2-000028.scm:20
var_39 = wile_list_length(NULL, var_40, "bld-rtl-dir/wile-rtl2-000028.scm:20");
}
var_38 = var_39;
lval var_41;
lval var_42;
switch (TYPE_COMBO(var_35.vt,var_38.vt)) {
case TYPE_COMBO(LV_INT,LV_INT):
var_42 = LVI_BOOL(var_35.v.iv == var_38.v.iv);
break;
case TYPE_COMBO(LV_INT,LV_RAT):
var_42 = LVI_BOOL(var_35.v.iv * var_38.v.irv.den == var_38.v.irv.num);
break;
case TYPE_COMBO(LV_INT,LV_REAL):
var_42 = LVI_BOOL(var_35.v.iv == var_38.v.rv);
break;
case TYPE_COMBO(LV_RAT,LV_INT):
var_42 = LVI_BOOL(var_35.v.irv.num == var_38.v.iv * var_35.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_RAT):
var_42 = LVI_BOOL(var_35.v.irv.num * var_38.v.irv.den == var_38.v.irv.num * var_35.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_REAL):
var_42 = LVI_BOOL(var_35.v.irv.num == var_38.v.rv * var_35.v.irv.den);
break;
case TYPE_COMBO(LV_REAL,LV_INT):
var_42 = LVI_BOOL(var_35.v.rv == var_38.v.iv);
break;
case TYPE_COMBO(LV_REAL,LV_RAT):
var_42 = LVI_BOOL(var_35.v.rv * var_38.v.irv.den == var_38.v.irv.num);
break;
case TYPE_COMBO(LV_REAL,LV_REAL):
var_42 = LVI_BOOL(var_35.v.rv == var_38.v.rv);
break;
default:
WILE_EX("==", "inputs are not real-valued numbers");
break;
}
if (LV_IS_FALSE(var_42)) {
lval var_43;
var_43 = LVI_STRING("map: list lengths differ %d %d");
lval var_44;
{
lval var_46[2];
var_46[0] = var_35;
var_46[1] = var_38;
var_44 = wile_gen_list(2, var_46, NULL);
}
{
lval var_45[8];
var_45[0] = var_43;
var_45[1] = var_44;
// bld-rtl-dir/wile-rtl2-000028.scm:31
var_44 = wile_sprintf(NULL, var_45, "bld-rtl-dir/wile-rtl2-000028.scm:31");
}
lval var_47;
{
lval var_48[1];
var_48[0] = var_44;
var_47 = wile_gen_list(1, var_48, NULL);
}
if (var_47.vt == LV_PAIR && (var_47.v.pair.cdr == NULL || var_47.v.pair.cdr->vt == LV_NIL)) {
var_47 = (var_47.v.pair.car ? *(var_47.v.pair.car) : LVI_NIL());
}
cachalot->errval = new_lv(LV_NIL);
*(cachalot->errval) = var_47;
cachalot->l_whence = 0;
cachalot->c_whence = LISP_WHENCE;
longjmp(cachalot->cenv, 1);
var_41 = var_47;
} else {
MK_CLOS(var_50,1);
lptr var_69 = new_lv(VT_UNINIT);
var_69->v.pair.car = &(var_33[0]);
P_CLOS(var_50,0) = var_69;
lval var_70;
var_70 = LVI_NIL();
lval var_71;
lval var_72[8];
var_72[0] = var_33[1];
var_72[1] = var_33[2];
var_72[2] = var_70;
// bld-rtl-dir/wile-rtl2-000028.scm:22
var_71 = fn_49(var_50, var_72, "bld-rtl-dir/wile-rtl2-000028.scm:22");
*var_69 = var_33[0];
var_41 = var_71;
}
return var_41;
}
// end of function fn_2

// @@@ lambda (l1 l2 l3 acc) @@@ bld-rtl-dir/wile-rtl2-000028.scm:38 @@@ fn_96 @@@
static lval fn_96(lptr* var_97, lptr var_98, const char* cloc)
{
lbl_99:;
lval var_100;
lval var_101;
var_101 = LVI_BOOL(var_98[0].vt == LV_NIL);
if (LV_IS_FALSE(var_101)) {
lval var_102;
if (var_98[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_102 = (var_98[0].v.pair.cdr ? *(var_98[0].v.pair.cdr) : LVI_NIL());
lval var_103;
if (var_98[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_103 = (var_98[1].v.pair.cdr ? *(var_98[1].v.pair.cdr) : LVI_NIL());
lval var_104;
if (var_98[2].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_104 = (var_98[2].v.pair.cdr ? *(var_98[2].v.pair.cdr) : LVI_NIL());
lval var_105;
if (var_98[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_105 = (var_98[0].v.pair.car ? *(var_98[0].v.pair.car) : LVI_NIL());
lval var_106;
if (var_98[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_106 = (var_98[1].v.pair.car ? *(var_98[1].v.pair.car) : LVI_NIL());
lval var_107;
if (var_98[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_107 = (var_98[2].v.pair.car ? *(var_98[2].v.pair.car) : LVI_NIL());
lval var_108;
{
lval var_109[3];
var_109[0] = var_105;
var_109[1] = var_106;
var_109[2] = var_107;
var_108 = wile_gen_list(3, var_109, NULL);
}
lval var_110;
{
lval var_111[2];
var_111[0] = V_CLOS(var_97,0);
var_111[1] = var_108;
var_110 = wile_gen_list(2, var_111, NULL);
}
var_110 = wile_apply_function(&(var_110), LISP_WHENCE);
lval var_112;
{
lptr p1 = NULL, p2 = NULL;
if (var_110.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_110;
}
if (var_98[3].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_98[3];
}
var_112 = LVI_PAIR(p1, p2);
}
lval var_115[8];
var_115[0] = var_102;
var_115[1] = var_103;
var_115[2] = var_104;
var_115[3] = var_112;
var_98[0] = var_115[0];
var_98[1] = var_115[1];
var_98[2] = var_115[2];
var_98[3] = var_115[3];
// bld-rtl-dir/wile-rtl2-000028.scm:44
goto lbl_99;	// selfie
} else {
lval var_116;
{
lval var_117[8];
var_117[0] = var_98[3];
// bld-rtl-dir/wile-rtl2-000028.scm:43
var_116 = wile_list_reverse(NULL, var_117, "bld-rtl-dir/wile-rtl2-000028.scm:43");
}
var_100 = var_116;
}
return var_100;
}
// end of lambda fn_96

// @@@ (map3 proc lst1 lst2 lst3) @@@ bld-rtl-dir/wile-rtl2-000028.scm:33 @@@ fn_3 @@@
static lval fn_3(lptr* var_74, lptr var_75, const char* cloc)
{
lval var_77;
lval var_78;
{
lval var_79[8];
var_79[0] = var_75[1];
// bld-rtl-dir/wile-rtl2-000028.scm:34
var_78 = wile_list_length(NULL, var_79, "bld-rtl-dir/wile-rtl2-000028.scm:34");
}
var_77 = var_78;
lval var_80;
lval var_81;
{
lval var_82[8];
var_82[0] = var_75[2];
// bld-rtl-dir/wile-rtl2-000028.scm:35
var_81 = wile_list_length(NULL, var_82, "bld-rtl-dir/wile-rtl2-000028.scm:35");
}
var_80 = var_81;
lval var_83;
lval var_84;
{
lval var_85[8];
var_85[0] = var_75[3];
// bld-rtl-dir/wile-rtl2-000028.scm:36
var_84 = wile_list_length(NULL, var_85, "bld-rtl-dir/wile-rtl2-000028.scm:36");
}
var_83 = var_84;
lval var_86;
lval var_87;
var_87 = LVI_BOOL(true);
do {
lval var_88;
switch (TYPE_COMBO(var_77.vt,var_80.vt)) {
case TYPE_COMBO(LV_INT,LV_INT):
var_88 = LVI_BOOL(var_77.v.iv == var_80.v.iv);
break;
case TYPE_COMBO(LV_INT,LV_RAT):
var_88 = LVI_BOOL(var_77.v.iv * var_80.v.irv.den == var_80.v.irv.num);
break;
case TYPE_COMBO(LV_INT,LV_REAL):
var_88 = LVI_BOOL(var_77.v.iv == var_80.v.rv);
break;
case TYPE_COMBO(LV_RAT,LV_INT):
var_88 = LVI_BOOL(var_77.v.irv.num == var_80.v.iv * var_77.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_RAT):
var_88 = LVI_BOOL(var_77.v.irv.num * var_80.v.irv.den == var_80.v.irv.num * var_77.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_REAL):
var_88 = LVI_BOOL(var_77.v.irv.num == var_80.v.rv * var_77.v.irv.den);
break;
case TYPE_COMBO(LV_REAL,LV_INT):
var_88 = LVI_BOOL(var_77.v.rv == var_80.v.iv);
break;
case TYPE_COMBO(LV_REAL,LV_RAT):
var_88 = LVI_BOOL(var_77.v.rv * var_80.v.irv.den == var_80.v.irv.num);
break;
case TYPE_COMBO(LV_REAL,LV_REAL):
var_88 = LVI_BOOL(var_77.v.rv == var_80.v.rv);
break;
default:
WILE_EX("==", "inputs are not real-valued numbers");
break;
}
var_87 = var_88;
if (LV_IS_FALSE(var_87)) { break; }
lval var_89;
switch (TYPE_COMBO(var_77.vt,var_83.vt)) {
case TYPE_COMBO(LV_INT,LV_INT):
var_89 = LVI_BOOL(var_77.v.iv == var_83.v.iv);
break;
case TYPE_COMBO(LV_INT,LV_RAT):
var_89 = LVI_BOOL(var_77.v.iv * var_83.v.irv.den == var_83.v.irv.num);
break;
case TYPE_COMBO(LV_INT,LV_REAL):
var_89 = LVI_BOOL(var_77.v.iv == var_83.v.rv);
break;
case TYPE_COMBO(LV_RAT,LV_INT):
var_89 = LVI_BOOL(var_77.v.irv.num == var_83.v.iv * var_77.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_RAT):
var_89 = LVI_BOOL(var_77.v.irv.num * var_83.v.irv.den == var_83.v.irv.num * var_77.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_REAL):
var_89 = LVI_BOOL(var_77.v.irv.num == var_83.v.rv * var_77.v.irv.den);
break;
case TYPE_COMBO(LV_REAL,LV_INT):
var_89 = LVI_BOOL(var_77.v.rv == var_83.v.iv);
break;
case TYPE_COMBO(LV_REAL,LV_RAT):
var_89 = LVI_BOOL(var_77.v.rv * var_83.v.irv.den == var_83.v.irv.num);
break;
case TYPE_COMBO(LV_REAL,LV_REAL):
var_89 = LVI_BOOL(var_77.v.rv == var_83.v.rv);
break;
default:
WILE_EX("==", "inputs are not real-valued numbers");
break;
}
var_87 = var_89;
if (LV_IS_FALSE(var_87)) { break; }
} while (0);
if (LV_IS_FALSE(var_87)) {
lval var_90;
var_90 = LVI_STRING("map: list lengths differ %d %d %d");
lval var_91;
{
lval var_93[3];
var_93[0] = var_77;
var_93[1] = var_80;
var_93[2] = var_83;
var_91 = wile_gen_list(3, var_93, NULL);
}
{
lval var_92[8];
var_92[0] = var_90;
var_92[1] = var_91;
// bld-rtl-dir/wile-rtl2-000028.scm:49
var_91 = wile_sprintf(NULL, var_92, "bld-rtl-dir/wile-rtl2-000028.scm:49");
}
lval var_94;
{
lval var_95[1];
var_95[0] = var_91;
var_94 = wile_gen_list(1, var_95, NULL);
}
if (var_94.vt == LV_PAIR && (var_94.v.pair.cdr == NULL || var_94.v.pair.cdr->vt == LV_NIL)) {
var_94 = (var_94.v.pair.car ? *(var_94.v.pair.car) : LVI_NIL());
}
cachalot->errval = new_lv(LV_NIL);
*(cachalot->errval) = var_94;
cachalot->l_whence = 0;
cachalot->c_whence = LISP_WHENCE;
longjmp(cachalot->cenv, 1);
var_86 = var_94;
} else {
MK_CLOS(var_97,1);
lptr var_118 = new_lv(VT_UNINIT);
var_118->v.pair.car = &(var_75[0]);
P_CLOS(var_97,0) = var_118;
lval var_119;
var_119 = LVI_NIL();
lval var_120;
lval var_121[8];
var_121[0] = var_75[1];
var_121[1] = var_75[2];
var_121[2] = var_75[3];
var_121[3] = var_119;
// bld-rtl-dir/wile-rtl2-000028.scm:38
var_120 = fn_96(var_97, var_121, "bld-rtl-dir/wile-rtl2-000028.scm:38");
*var_118 = var_75[0];
var_86 = var_120;
}
return var_86;
}
// end of function fn_3

// @@@ lambda (l1 l2 l3 l4 acc) @@@ bld-rtl-dir/wile-rtl2-000028.scm:57 @@@ fn_149 @@@
static lval fn_149(lptr* var_150, lptr var_151, const char* cloc)
{
lbl_152:;
lval var_153;
lval var_154;
var_154 = LVI_BOOL(var_151[0].vt == LV_NIL);
if (LV_IS_FALSE(var_154)) {
lval var_155;
if (var_151[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_155 = (var_151[0].v.pair.cdr ? *(var_151[0].v.pair.cdr) : LVI_NIL());
lval var_156;
if (var_151[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_156 = (var_151[1].v.pair.cdr ? *(var_151[1].v.pair.cdr) : LVI_NIL());
lval var_157;
if (var_151[2].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_157 = (var_151[2].v.pair.cdr ? *(var_151[2].v.pair.cdr) : LVI_NIL());
lval var_158;
if (var_151[3].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_158 = (var_151[3].v.pair.cdr ? *(var_151[3].v.pair.cdr) : LVI_NIL());
lval var_159;
if (var_151[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_159 = (var_151[0].v.pair.car ? *(var_151[0].v.pair.car) : LVI_NIL());
lval var_160;
if (var_151[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_160 = (var_151[1].v.pair.car ? *(var_151[1].v.pair.car) : LVI_NIL());
lval var_161;
if (var_151[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_161 = (var_151[2].v.pair.car ? *(var_151[2].v.pair.car) : LVI_NIL());
lval var_162;
if (var_151[3].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_162 = (var_151[3].v.pair.car ? *(var_151[3].v.pair.car) : LVI_NIL());
lval var_163;
{
lval var_164[4];
var_164[0] = var_159;
var_164[1] = var_160;
var_164[2] = var_161;
var_164[3] = var_162;
var_163 = wile_gen_list(4, var_164, NULL);
}
lval var_165;
{
lval var_166[2];
var_166[0] = V_CLOS(var_150,0);
var_166[1] = var_163;
var_165 = wile_gen_list(2, var_166, NULL);
}
var_165 = wile_apply_function(&(var_165), LISP_WHENCE);
lval var_167;
{
lptr p1 = NULL, p2 = NULL;
if (var_165.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_165;
}
if (var_151[4].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_151[4];
}
var_167 = LVI_PAIR(p1, p2);
}
lval var_170[8];
var_170[0] = var_155;
var_170[1] = var_156;
var_170[2] = var_157;
var_170[3] = var_158;
var_170[4] = var_167;
var_151[0] = var_170[0];
var_151[1] = var_170[1];
var_151[2] = var_170[2];
var_151[3] = var_170[3];
var_151[4] = var_170[4];
// bld-rtl-dir/wile-rtl2-000028.scm:64
goto lbl_152;	// selfie
} else {
lval var_171;
{
lval var_172[8];
var_172[0] = var_151[4];
// bld-rtl-dir/wile-rtl2-000028.scm:63
var_171 = wile_list_reverse(NULL, var_172, "bld-rtl-dir/wile-rtl2-000028.scm:63");
}
var_153 = var_171;
}
return var_153;
}
// end of lambda fn_149

// @@@ (map4 proc lst1 lst2 lst3 lst4) @@@ bld-rtl-dir/wile-rtl2-000028.scm:51 @@@ fn_4 @@@
static lval fn_4(lptr* var_123, lptr var_124, const char* cloc)
{
lval var_126;
lval var_127;
{
lval var_128[8];
var_128[0] = var_124[1];
// bld-rtl-dir/wile-rtl2-000028.scm:52
var_127 = wile_list_length(NULL, var_128, "bld-rtl-dir/wile-rtl2-000028.scm:52");
}
var_126 = var_127;
lval var_129;
lval var_130;
{
lval var_131[8];
var_131[0] = var_124[2];
// bld-rtl-dir/wile-rtl2-000028.scm:53
var_130 = wile_list_length(NULL, var_131, "bld-rtl-dir/wile-rtl2-000028.scm:53");
}
var_129 = var_130;
lval var_132;
lval var_133;
{
lval var_134[8];
var_134[0] = var_124[3];
// bld-rtl-dir/wile-rtl2-000028.scm:54
var_133 = wile_list_length(NULL, var_134, "bld-rtl-dir/wile-rtl2-000028.scm:54");
}
var_132 = var_133;
lval var_135;
lval var_136;
{
lval var_137[8];
var_137[0] = var_124[4];
// bld-rtl-dir/wile-rtl2-000028.scm:55
var_136 = wile_list_length(NULL, var_137, "bld-rtl-dir/wile-rtl2-000028.scm:55");
}
var_135 = var_136;
lval var_138;
lval var_139;
var_139 = LVI_BOOL(true);
do {
lval var_140;
switch (TYPE_COMBO(var_126.vt,var_129.vt)) {
case TYPE_COMBO(LV_INT,LV_INT):
var_140 = LVI_BOOL(var_126.v.iv == var_129.v.iv);
break;
case TYPE_COMBO(LV_INT,LV_RAT):
var_140 = LVI_BOOL(var_126.v.iv * var_129.v.irv.den == var_129.v.irv.num);
break;
case TYPE_COMBO(LV_INT,LV_REAL):
var_140 = LVI_BOOL(var_126.v.iv == var_129.v.rv);
break;
case TYPE_COMBO(LV_RAT,LV_INT):
var_140 = LVI_BOOL(var_126.v.irv.num == var_129.v.iv * var_126.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_RAT):
var_140 = LVI_BOOL(var_126.v.irv.num * var_129.v.irv.den == var_129.v.irv.num * var_126.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_REAL):
var_140 = LVI_BOOL(var_126.v.irv.num == var_129.v.rv * var_126.v.irv.den);
break;
case TYPE_COMBO(LV_REAL,LV_INT):
var_140 = LVI_BOOL(var_126.v.rv == var_129.v.iv);
break;
case TYPE_COMBO(LV_REAL,LV_RAT):
var_140 = LVI_BOOL(var_126.v.rv * var_129.v.irv.den == var_129.v.irv.num);
break;
case TYPE_COMBO(LV_REAL,LV_REAL):
var_140 = LVI_BOOL(var_126.v.rv == var_129.v.rv);
break;
default:
WILE_EX("==", "inputs are not real-valued numbers");
break;
}
var_139 = var_140;
if (LV_IS_FALSE(var_139)) { break; }
lval var_141;
switch (TYPE_COMBO(var_126.vt,var_132.vt)) {
case TYPE_COMBO(LV_INT,LV_INT):
var_141 = LVI_BOOL(var_126.v.iv == var_132.v.iv);
break;
case TYPE_COMBO(LV_INT,LV_RAT):
var_141 = LVI_BOOL(var_126.v.iv * var_132.v.irv.den == var_132.v.irv.num);
break;
case TYPE_COMBO(LV_INT,LV_REAL):
var_141 = LVI_BOOL(var_126.v.iv == var_132.v.rv);
break;
case TYPE_COMBO(LV_RAT,LV_INT):
var_141 = LVI_BOOL(var_126.v.irv.num == var_132.v.iv * var_126.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_RAT):
var_141 = LVI_BOOL(var_126.v.irv.num * var_132.v.irv.den == var_132.v.irv.num * var_126.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_REAL):
var_141 = LVI_BOOL(var_126.v.irv.num == var_132.v.rv * var_126.v.irv.den);
break;
case TYPE_COMBO(LV_REAL,LV_INT):
var_141 = LVI_BOOL(var_126.v.rv == var_132.v.iv);
break;
case TYPE_COMBO(LV_REAL,LV_RAT):
var_141 = LVI_BOOL(var_126.v.rv * var_132.v.irv.den == var_132.v.irv.num);
break;
case TYPE_COMBO(LV_REAL,LV_REAL):
var_141 = LVI_BOOL(var_126.v.rv == var_132.v.rv);
break;
default:
WILE_EX("==", "inputs are not real-valued numbers");
break;
}
var_139 = var_141;
if (LV_IS_FALSE(var_139)) { break; }
lval var_142;
switch (TYPE_COMBO(var_126.vt,var_135.vt)) {
case TYPE_COMBO(LV_INT,LV_INT):
var_142 = LVI_BOOL(var_126.v.iv == var_135.v.iv);
break;
case TYPE_COMBO(LV_INT,LV_RAT):
var_142 = LVI_BOOL(var_126.v.iv * var_135.v.irv.den == var_135.v.irv.num);
break;
case TYPE_COMBO(LV_INT,LV_REAL):
var_142 = LVI_BOOL(var_126.v.iv == var_135.v.rv);
break;
case TYPE_COMBO(LV_RAT,LV_INT):
var_142 = LVI_BOOL(var_126.v.irv.num == var_135.v.iv * var_126.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_RAT):
var_142 = LVI_BOOL(var_126.v.irv.num * var_135.v.irv.den == var_135.v.irv.num * var_126.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_REAL):
var_142 = LVI_BOOL(var_126.v.irv.num == var_135.v.rv * var_126.v.irv.den);
break;
case TYPE_COMBO(LV_REAL,LV_INT):
var_142 = LVI_BOOL(var_126.v.rv == var_135.v.iv);
break;
case TYPE_COMBO(LV_REAL,LV_RAT):
var_142 = LVI_BOOL(var_126.v.rv * var_135.v.irv.den == var_135.v.irv.num);
break;
case TYPE_COMBO(LV_REAL,LV_REAL):
var_142 = LVI_BOOL(var_126.v.rv == var_135.v.rv);
break;
default:
WILE_EX("==", "inputs are not real-valued numbers");
break;
}
var_139 = var_142;
if (LV_IS_FALSE(var_139)) { break; }
} while (0);
if (LV_IS_FALSE(var_139)) {
lval var_143;
var_143 = LVI_STRING("map: list lengths differ %d %d %d %d");
lval var_144;
{
lval var_146[4];
var_146[0] = var_126;
var_146[1] = var_129;
var_146[2] = var_132;
var_146[3] = var_135;
var_144 = wile_gen_list(4, var_146, NULL);
}
{
lval var_145[8];
var_145[0] = var_143;
var_145[1] = var_144;
// bld-rtl-dir/wile-rtl2-000028.scm:70
var_144 = wile_sprintf(NULL, var_145, "bld-rtl-dir/wile-rtl2-000028.scm:70");
}
lval var_147;
{
lval var_148[1];
var_148[0] = var_144;
var_147 = wile_gen_list(1, var_148, NULL);
}
if (var_147.vt == LV_PAIR && (var_147.v.pair.cdr == NULL || var_147.v.pair.cdr->vt == LV_NIL)) {
var_147 = (var_147.v.pair.car ? *(var_147.v.pair.car) : LVI_NIL());
}
cachalot->errval = new_lv(LV_NIL);
*(cachalot->errval) = var_147;
cachalot->l_whence = 0;
cachalot->c_whence = LISP_WHENCE;
longjmp(cachalot->cenv, 1);
var_138 = var_147;
} else {
MK_CLOS(var_150,1);
lptr var_173 = new_lv(VT_UNINIT);
var_173->v.pair.car = &(var_124[0]);
P_CLOS(var_150,0) = var_173;
lval var_174;
var_174 = LVI_NIL();
lval var_175;
lval var_176[8];
var_176[0] = var_124[1];
var_176[1] = var_124[2];
var_176[2] = var_124[3];
var_176[3] = var_124[4];
var_176[4] = var_174;
// bld-rtl-dir/wile-rtl2-000028.scm:57
var_175 = fn_149(var_150, var_176, "bld-rtl-dir/wile-rtl2-000028.scm:57");
*var_173 = var_124[0];
var_138 = var_175;
}
return var_138;
}
// end of function fn_4

// @@@ lambda (l1 l2 l3 l4 l5 acc) @@@ bld-rtl-dir/wile-rtl2-000028.scm:80 @@@ fn_208 @@@
static lval fn_208(lptr* var_209, lptr var_210, const char* cloc)
{
lbl_211:;
lval var_212;
lval var_213;
var_213 = LVI_BOOL(var_210[0].vt == LV_NIL);
if (LV_IS_FALSE(var_213)) {
lval var_214;
if (var_210[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_214 = (var_210[0].v.pair.cdr ? *(var_210[0].v.pair.cdr) : LVI_NIL());
lval var_215;
if (var_210[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_215 = (var_210[1].v.pair.cdr ? *(var_210[1].v.pair.cdr) : LVI_NIL());
lval var_216;
if (var_210[2].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_216 = (var_210[2].v.pair.cdr ? *(var_210[2].v.pair.cdr) : LVI_NIL());
lval var_217;
if (var_210[3].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_217 = (var_210[3].v.pair.cdr ? *(var_210[3].v.pair.cdr) : LVI_NIL());
lval var_218;
if (var_210[4].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_218 = (var_210[4].v.pair.cdr ? *(var_210[4].v.pair.cdr) : LVI_NIL());
lval var_219;
if (var_210[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_219 = (var_210[0].v.pair.car ? *(var_210[0].v.pair.car) : LVI_NIL());
lval var_220;
if (var_210[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_220 = (var_210[1].v.pair.car ? *(var_210[1].v.pair.car) : LVI_NIL());
lval var_221;
if (var_210[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_221 = (var_210[2].v.pair.car ? *(var_210[2].v.pair.car) : LVI_NIL());
lval var_222;
if (var_210[3].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_222 = (var_210[3].v.pair.car ? *(var_210[3].v.pair.car) : LVI_NIL());
lval var_223;
if (var_210[4].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_223 = (var_210[4].v.pair.car ? *(var_210[4].v.pair.car) : LVI_NIL());
lval var_224;
{
lval var_225[5];
var_225[0] = var_219;
var_225[1] = var_220;
var_225[2] = var_221;
var_225[3] = var_222;
var_225[4] = var_223;
var_224 = wile_gen_list(5, var_225, NULL);
}
lval var_226;
{
lval var_227[2];
var_227[0] = V_CLOS(var_209,0);
var_227[1] = var_224;
var_226 = wile_gen_list(2, var_227, NULL);
}
var_226 = wile_apply_function(&(var_226), LISP_WHENCE);
lval var_228;
{
lptr p1 = NULL, p2 = NULL;
if (var_226.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_226;
}
if (var_210[5].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_210[5];
}
var_228 = LVI_PAIR(p1, p2);
}
lval var_231[8];
var_231[0] = var_214;
var_231[1] = var_215;
var_231[2] = var_216;
var_231[3] = var_217;
var_231[4] = var_218;
var_231[5] = var_228;
var_210[0] = var_231[0];
var_210[1] = var_231[1];
var_210[2] = var_231[2];
var_210[3] = var_231[3];
var_210[4] = var_231[4];
var_210[5] = var_231[5];
// bld-rtl-dir/wile-rtl2-000028.scm:88
goto lbl_211;	// selfie
} else {
lval var_232;
{
lval var_233[8];
var_233[0] = var_210[5];
// bld-rtl-dir/wile-rtl2-000028.scm:87
var_232 = wile_list_reverse(NULL, var_233, "bld-rtl-dir/wile-rtl2-000028.scm:87");
}
var_212 = var_232;
}
return var_212;
}
// end of lambda fn_208

// @@@ (map5 proc lst1 lst2 lst3 lst4 lst5) @@@ bld-rtl-dir/wile-rtl2-000028.scm:73 @@@ fn_5 @@@
static lval fn_5(lptr* var_178, lptr var_179, const char* cloc)
{
lval var_181;
lval var_182;
{
lval var_183[8];
var_183[0] = var_179[1];
// bld-rtl-dir/wile-rtl2-000028.scm:74
var_182 = wile_list_length(NULL, var_183, "bld-rtl-dir/wile-rtl2-000028.scm:74");
}
var_181 = var_182;
lval var_184;
lval var_185;
{
lval var_186[8];
var_186[0] = var_179[2];
// bld-rtl-dir/wile-rtl2-000028.scm:75
var_185 = wile_list_length(NULL, var_186, "bld-rtl-dir/wile-rtl2-000028.scm:75");
}
var_184 = var_185;
lval var_187;
lval var_188;
{
lval var_189[8];
var_189[0] = var_179[3];
// bld-rtl-dir/wile-rtl2-000028.scm:76
var_188 = wile_list_length(NULL, var_189, "bld-rtl-dir/wile-rtl2-000028.scm:76");
}
var_187 = var_188;
lval var_190;
lval var_191;
{
lval var_192[8];
var_192[0] = var_179[4];
// bld-rtl-dir/wile-rtl2-000028.scm:77
var_191 = wile_list_length(NULL, var_192, "bld-rtl-dir/wile-rtl2-000028.scm:77");
}
var_190 = var_191;
lval var_193;
lval var_194;
{
lval var_195[8];
var_195[0] = var_179[5];
// bld-rtl-dir/wile-rtl2-000028.scm:78
var_194 = wile_list_length(NULL, var_195, "bld-rtl-dir/wile-rtl2-000028.scm:78");
}
var_193 = var_194;
lval var_196;
lval var_197;
var_197 = LVI_BOOL(true);
do {
lval var_198;
switch (TYPE_COMBO(var_181.vt,var_184.vt)) {
case TYPE_COMBO(LV_INT,LV_INT):
var_198 = LVI_BOOL(var_181.v.iv == var_184.v.iv);
break;
case TYPE_COMBO(LV_INT,LV_RAT):
var_198 = LVI_BOOL(var_181.v.iv * var_184.v.irv.den == var_184.v.irv.num);
break;
case TYPE_COMBO(LV_INT,LV_REAL):
var_198 = LVI_BOOL(var_181.v.iv == var_184.v.rv);
break;
case TYPE_COMBO(LV_RAT,LV_INT):
var_198 = LVI_BOOL(var_181.v.irv.num == var_184.v.iv * var_181.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_RAT):
var_198 = LVI_BOOL(var_181.v.irv.num * var_184.v.irv.den == var_184.v.irv.num * var_181.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_REAL):
var_198 = LVI_BOOL(var_181.v.irv.num == var_184.v.rv * var_181.v.irv.den);
break;
case TYPE_COMBO(LV_REAL,LV_INT):
var_198 = LVI_BOOL(var_181.v.rv == var_184.v.iv);
break;
case TYPE_COMBO(LV_REAL,LV_RAT):
var_198 = LVI_BOOL(var_181.v.rv * var_184.v.irv.den == var_184.v.irv.num);
break;
case TYPE_COMBO(LV_REAL,LV_REAL):
var_198 = LVI_BOOL(var_181.v.rv == var_184.v.rv);
break;
default:
WILE_EX("==", "inputs are not real-valued numbers");
break;
}
var_197 = var_198;
if (LV_IS_FALSE(var_197)) { break; }
lval var_199;
switch (TYPE_COMBO(var_181.vt,var_187.vt)) {
case TYPE_COMBO(LV_INT,LV_INT):
var_199 = LVI_BOOL(var_181.v.iv == var_187.v.iv);
break;
case TYPE_COMBO(LV_INT,LV_RAT):
var_199 = LVI_BOOL(var_181.v.iv * var_187.v.irv.den == var_187.v.irv.num);
break;
case TYPE_COMBO(LV_INT,LV_REAL):
var_199 = LVI_BOOL(var_181.v.iv == var_187.v.rv);
break;
case TYPE_COMBO(LV_RAT,LV_INT):
var_199 = LVI_BOOL(var_181.v.irv.num == var_187.v.iv * var_181.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_RAT):
var_199 = LVI_BOOL(var_181.v.irv.num * var_187.v.irv.den == var_187.v.irv.num * var_181.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_REAL):
var_199 = LVI_BOOL(var_181.v.irv.num == var_187.v.rv * var_181.v.irv.den);
break;
case TYPE_COMBO(LV_REAL,LV_INT):
var_199 = LVI_BOOL(var_181.v.rv == var_187.v.iv);
break;
case TYPE_COMBO(LV_REAL,LV_RAT):
var_199 = LVI_BOOL(var_181.v.rv * var_187.v.irv.den == var_187.v.irv.num);
break;
case TYPE_COMBO(LV_REAL,LV_REAL):
var_199 = LVI_BOOL(var_181.v.rv == var_187.v.rv);
break;
default:
WILE_EX("==", "inputs are not real-valued numbers");
break;
}
var_197 = var_199;
if (LV_IS_FALSE(var_197)) { break; }
lval var_200;
switch (TYPE_COMBO(var_181.vt,var_190.vt)) {
case TYPE_COMBO(LV_INT,LV_INT):
var_200 = LVI_BOOL(var_181.v.iv == var_190.v.iv);
break;
case TYPE_COMBO(LV_INT,LV_RAT):
var_200 = LVI_BOOL(var_181.v.iv * var_190.v.irv.den == var_190.v.irv.num);
break;
case TYPE_COMBO(LV_INT,LV_REAL):
var_200 = LVI_BOOL(var_181.v.iv == var_190.v.rv);
break;
case TYPE_COMBO(LV_RAT,LV_INT):
var_200 = LVI_BOOL(var_181.v.irv.num == var_190.v.iv * var_181.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_RAT):
var_200 = LVI_BOOL(var_181.v.irv.num * var_190.v.irv.den == var_190.v.irv.num * var_181.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_REAL):
var_200 = LVI_BOOL(var_181.v.irv.num == var_190.v.rv * var_181.v.irv.den);
break;
case TYPE_COMBO(LV_REAL,LV_INT):
var_200 = LVI_BOOL(var_181.v.rv == var_190.v.iv);
break;
case TYPE_COMBO(LV_REAL,LV_RAT):
var_200 = LVI_BOOL(var_181.v.rv * var_190.v.irv.den == var_190.v.irv.num);
break;
case TYPE_COMBO(LV_REAL,LV_REAL):
var_200 = LVI_BOOL(var_181.v.rv == var_190.v.rv);
break;
default:
WILE_EX("==", "inputs are not real-valued numbers");
break;
}
var_197 = var_200;
if (LV_IS_FALSE(var_197)) { break; }
lval var_201;
switch (TYPE_COMBO(var_181.vt,var_193.vt)) {
case TYPE_COMBO(LV_INT,LV_INT):
var_201 = LVI_BOOL(var_181.v.iv == var_193.v.iv);
break;
case TYPE_COMBO(LV_INT,LV_RAT):
var_201 = LVI_BOOL(var_181.v.iv * var_193.v.irv.den == var_193.v.irv.num);
break;
case TYPE_COMBO(LV_INT,LV_REAL):
var_201 = LVI_BOOL(var_181.v.iv == var_193.v.rv);
break;
case TYPE_COMBO(LV_RAT,LV_INT):
var_201 = LVI_BOOL(var_181.v.irv.num == var_193.v.iv * var_181.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_RAT):
var_201 = LVI_BOOL(var_181.v.irv.num * var_193.v.irv.den == var_193.v.irv.num * var_181.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_REAL):
var_201 = LVI_BOOL(var_181.v.irv.num == var_193.v.rv * var_181.v.irv.den);
break;
case TYPE_COMBO(LV_REAL,LV_INT):
var_201 = LVI_BOOL(var_181.v.rv == var_193.v.iv);
break;
case TYPE_COMBO(LV_REAL,LV_RAT):
var_201 = LVI_BOOL(var_181.v.rv * var_193.v.irv.den == var_193.v.irv.num);
break;
case TYPE_COMBO(LV_REAL,LV_REAL):
var_201 = LVI_BOOL(var_181.v.rv == var_193.v.rv);
break;
default:
WILE_EX("==", "inputs are not real-valued numbers");
break;
}
var_197 = var_201;
if (LV_IS_FALSE(var_197)) { break; }
} while (0);
if (LV_IS_FALSE(var_197)) {
lval var_202;
var_202 = LVI_STRING("map: list lengths differ %d %d %d %d %d");
lval var_203;
{
lval var_205[5];
var_205[0] = var_181;
var_205[1] = var_184;
var_205[2] = var_187;
var_205[3] = var_190;
var_205[4] = var_193;
var_203 = wile_gen_list(5, var_205, NULL);
}
{
lval var_204[8];
var_204[0] = var_202;
var_204[1] = var_203;
// bld-rtl-dir/wile-rtl2-000028.scm:95
var_203 = wile_sprintf(NULL, var_204, "bld-rtl-dir/wile-rtl2-000028.scm:95");
}
lval var_206;
{
lval var_207[1];
var_207[0] = var_203;
var_206 = wile_gen_list(1, var_207, NULL);
}
if (var_206.vt == LV_PAIR && (var_206.v.pair.cdr == NULL || var_206.v.pair.cdr->vt == LV_NIL)) {
var_206 = (var_206.v.pair.car ? *(var_206.v.pair.car) : LVI_NIL());
}
cachalot->errval = new_lv(LV_NIL);
*(cachalot->errval) = var_206;
cachalot->l_whence = 0;
cachalot->c_whence = LISP_WHENCE;
longjmp(cachalot->cenv, 1);
var_196 = var_206;
} else {
MK_CLOS(var_209,1);
lptr var_234 = new_lv(VT_UNINIT);
var_234->v.pair.car = &(var_179[0]);
P_CLOS(var_209,0) = var_234;
lval var_235;
var_235 = LVI_NIL();
lval var_236;
lval var_237[8];
var_237[0] = var_179[1];
var_237[1] = var_179[2];
var_237[2] = var_179[3];
var_237[3] = var_179[4];
var_237[4] = var_179[5];
var_237[5] = var_235;
// bld-rtl-dir/wile-rtl2-000028.scm:80
var_236 = fn_208(var_209, var_237, "bld-rtl-dir/wile-rtl2-000028.scm:80");
*var_234 = var_179[0];
var_196 = var_236;
}
return var_196;
}
// end of function fn_5

// @@@ car @@@ bld-rtl-dir/wile-rtl2-000028.scm:104 @@@ fn_249 @@@
static lval fn_249(lptr* var_250, lptr var_251, const char* cloc)
{
lval var_253;
if (var_251[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_253 = (var_251[0].v.pair.car ? *(var_251[0].v.pair.car) : LVI_NIL());
return var_253;
}
// end of prim fn_249

// @@@ cdr @@@ bld-rtl-dir/wile-rtl2-000028.scm:104 @@@ fn_260 @@@
static lval fn_260(lptr* var_261, lptr var_262, const char* cloc)
{
lval var_264;
if (var_262[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_264 = (var_262[0].v.pair.cdr ? *(var_262[0].v.pair.cdr) : LVI_NIL());
return var_264;
}
// end of prim fn_260

// @@@ (m2 proc acc ls) @@@ bld-rtl-dir/wile-rtl2-000028.scm:101 @@@ fn_242 @@@
static lval fn_242(lptr* var_243, lptr var_244, const char* cloc)
{
lbl_245:;
lval var_246;
lval var_247;
if (var_244[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_247 = (var_244[2].v.pair.car ? *(var_244[2].v.pair.car) : LVI_NIL());
lval var_248;
var_248 = LVI_BOOL(var_247.vt == LV_NIL);
if (LV_IS_FALSE(var_248)) {
lval var_254;
lval var_255[8];
var_255[0] = LVI_PROC(fn_249,NULL,1);
var_255[1] = var_244[2];
// bld-rtl-dir/wile-rtl2-000028.scm:104
var_254 = fn_1(NULL, var_255, "bld-rtl-dir/wile-rtl2-000028.scm:104");
lval var_257;
{
lval var_258[2];
var_258[0] = var_244[0];
var_258[1] = var_254;
var_257 = wile_gen_list(2, var_258, NULL);
}
var_257 = wile_apply_function(&(var_257), LISP_WHENCE);
lval var_259;
{
lptr p1 = NULL, p2 = NULL;
if (var_257.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_257;
}
if (var_244[1].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_244[1];
}
var_259 = LVI_PAIR(p1, p2);
}
lval var_265;
lval var_266[8];
var_266[0] = LVI_PROC(fn_260,NULL,1);
var_266[1] = var_244[2];
// bld-rtl-dir/wile-rtl2-000028.scm:104
var_265 = fn_1(NULL, var_266, "bld-rtl-dir/wile-rtl2-000028.scm:104");
lval var_270[8];
var_270[0] = var_244[0];
var_270[1] = var_259;
var_270[2] = var_265;
var_244[0] = var_270[0];
var_244[1] = var_270[1];
var_244[2] = var_270[2];
// bld-rtl-dir/wile-rtl2-000028.scm:104
goto lbl_245;	// selfie
} else {
lval var_271;
{
lval var_272[8];
var_272[0] = var_244[1];
// bld-rtl-dir/wile-rtl2-000028.scm:103
var_271 = wile_list_reverse(NULL, var_272, "bld-rtl-dir/wile-rtl2-000028.scm:103");
}
var_246 = var_271;
}
return var_246;
}
// end of function fn_242

// @@@ list-length @@@ bld-rtl-dir/wile-rtl2-000028.scm:113 @@@ fn_310 @@@
static lval fn_310(lptr* var_311, lptr var_312, const char* cloc)
{
lval var_314;
{
lval var_315[8];
var_315[0] = var_312[0];
// bld-rtl-dir/wile-rtl2-000028.scm:113
var_314 = wile_list_length(NULL, var_315, "bld-rtl-dir/wile-rtl2-000028.scm:113");
}
return var_314;
}
// end of prim fn_310

// @@@ min/i @@@ bld-rtl-dir/wile-rtl2-000028.scm:114 @@@ fn_320 @@@
static lval fn_320(lptr* var_321, lptr var_322, const char* cloc)
{
lval var_324;
var_324 = LVI_INT((var_322[0].v.iv < var_322[1].v.iv) ? var_322[0].v.iv : var_322[1].v.iv);
return var_324;
}
// end of prim fn_320

// @@@ max/i @@@ bld-rtl-dir/wile-rtl2-000028.scm:114 @@@ fn_327 @@@
static lval fn_327(lptr* var_328, lptr var_329, const char* cloc)
{
lval var_331;
var_331 = LVI_INT((var_329[0].v.iv > var_329[1].v.iv) ? var_329[0].v.iv : var_329[1].v.iv);
return var_331;
}
// end of prim fn_327

// @@@ (map proc lst . ls) @@@ bld-rtl-dir/wile-rtl2-000028.scm:100 @@@ wile_map @@@
lval wile_map(lptr* var_239, lptr var_240, const char* cloc)
{
lval var_273;
{
lval var_274[8];
var_274[0] = var_240[2];
// bld-rtl-dir/wile-rtl2-000028.scm:105
var_273 = wile_list_length(NULL, var_274, "bld-rtl-dir/wile-rtl2-000028.scm:105");
}
lval var_275;
if (var_273.vt != LV_INT) {
wile_exception("case", LISP_WHENCE, "case-value type does not match case type");
}
switch (var_273.v.iv) {
case 0:
{
lval var_278[8];
var_278[0] = var_240[0];
var_278[1] = var_240[1];
var_240[0] = var_278[0];
var_240[1] = var_278[1];
// bld-rtl-dir/wile-rtl2-000028.scm:107
TAIL_CALL fn_1(NULL, var_240, "bld-rtl-dir/wile-rtl2-000028.scm:107");
}
case 1:
{
lval var_279;
if (var_240[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_279 = (var_240[2].v.pair.car ? *(var_240[2].v.pair.car) : LVI_NIL());
lval var_282[8];
var_282[0] = var_240[0];
var_282[1] = var_240[1];
var_282[2] = var_279;
var_240[0] = var_282[0];
var_240[1] = var_282[1];
var_240[2] = var_282[2];
// bld-rtl-dir/wile-rtl2-000028.scm:108
TAIL_CALL fn_2(NULL, var_240, "bld-rtl-dir/wile-rtl2-000028.scm:108");
}
case 2:
{
lval var_283;
if (var_240[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_283 = (var_240[2].v.pair.car ? *(var_240[2].v.pair.car) : LVI_NIL());
lval var_284;
var_284 = LVI_STRING("cadr");
lval var_285;
{
char* cp = strchr(var_284.v.str, 'r');
var_285 = var_240[2];
while (*(--cp) != 'c') {
if (var_285.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_285 = (var_285.v.pair.car ? *(var_285.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_285 = (var_285.v.pair.cdr ? *(var_285.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_284.v.str);
}
}
}
lval var_288[8];
var_288[0] = var_240[0];
var_288[1] = var_240[1];
var_288[2] = var_283;
var_288[3] = var_285;
var_240[0] = var_288[0];
var_240[1] = var_288[1];
var_240[2] = var_288[2];
var_240[3] = var_288[3];
// bld-rtl-dir/wile-rtl2-000028.scm:109
TAIL_CALL fn_3(NULL, var_240, "bld-rtl-dir/wile-rtl2-000028.scm:109");
}
case 3:
{
lval var_289;
if (var_240[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_289 = (var_240[2].v.pair.car ? *(var_240[2].v.pair.car) : LVI_NIL());
lval var_290;
var_290 = LVI_STRING("cadr");
lval var_291;
{
char* cp = strchr(var_290.v.str, 'r');
var_291 = var_240[2];
while (*(--cp) != 'c') {
if (var_291.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_291 = (var_291.v.pair.car ? *(var_291.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_291 = (var_291.v.pair.cdr ? *(var_291.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_290.v.str);
}
}
}
lval var_292;
var_292 = LVI_STRING("caddr");
lval var_293;
{
char* cp = strchr(var_292.v.str, 'r');
var_293 = var_240[2];
while (*(--cp) != 'c') {
if (var_293.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_293 = (var_293.v.pair.car ? *(var_293.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_293 = (var_293.v.pair.cdr ? *(var_293.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_292.v.str);
}
}
}
lval var_296[8];
var_296[0] = var_240[0];
var_296[1] = var_240[1];
var_296[2] = var_289;
var_296[3] = var_291;
var_296[4] = var_293;
var_240[0] = var_296[0];
var_240[1] = var_296[1];
var_240[2] = var_296[2];
var_240[3] = var_296[3];
var_240[4] = var_296[4];
// bld-rtl-dir/wile-rtl2-000028.scm:110
TAIL_CALL fn_4(NULL, var_240, "bld-rtl-dir/wile-rtl2-000028.scm:110");
}
case 4:
{
lval var_297;
if (var_240[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_297 = (var_240[2].v.pair.car ? *(var_240[2].v.pair.car) : LVI_NIL());
lval var_298;
var_298 = LVI_STRING("cadr");
lval var_299;
{
char* cp = strchr(var_298.v.str, 'r');
var_299 = var_240[2];
while (*(--cp) != 'c') {
if (var_299.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_299 = (var_299.v.pair.car ? *(var_299.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_299 = (var_299.v.pair.cdr ? *(var_299.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_298.v.str);
}
}
}
lval var_300;
var_300 = LVI_STRING("caddr");
lval var_301;
{
char* cp = strchr(var_300.v.str, 'r');
var_301 = var_240[2];
while (*(--cp) != 'c') {
if (var_301.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_301 = (var_301.v.pair.car ? *(var_301.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_301 = (var_301.v.pair.cdr ? *(var_301.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_300.v.str);
}
}
}
lval var_302;
var_302 = LVI_STRING("cadddr");
lval var_303;
{
char* cp = strchr(var_302.v.str, 'r');
var_303 = var_240[2];
while (*(--cp) != 'c') {
if (var_303.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_303 = (var_303.v.pair.car ? *(var_303.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_303 = (var_303.v.pair.cdr ? *(var_303.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_302.v.str);
}
}
}
lval var_306[8];
var_306[0] = var_240[0];
var_306[1] = var_240[1];
var_306[2] = var_297;
var_306[3] = var_299;
var_306[4] = var_301;
var_306[5] = var_303;
var_240[0] = var_306[0];
var_240[1] = var_306[1];
var_240[2] = var_306[2];
var_240[3] = var_306[3];
var_240[4] = var_306[4];
var_240[5] = var_306[5];
// bld-rtl-dir/wile-rtl2-000028.scm:111
TAIL_CALL fn_5(NULL, var_240, "bld-rtl-dir/wile-rtl2-000028.scm:111");
}
default:
{
lval var_307;
lval var_308;
{
lptr p1 = NULL, p2 = NULL;
if (var_240[1].vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_240[1];
}
if (var_240[2].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_240[2];
}
var_308 = LVI_PAIR(p1, p2);
}
var_307 = var_308;
lval var_309;
lval var_316;
lval var_317[8];
var_317[0] = LVI_PROC(fn_310,NULL,1);
var_317[1] = var_307;
// bld-rtl-dir/wile-rtl2-000028.scm:113
var_316 = fn_1(NULL, var_317, "bld-rtl-dir/wile-rtl2-000028.scm:113");
var_309 = var_316;
lval var_319;
lval var_325;
{
lval var_326[8];
var_326[0] = LVI_PROC(fn_320,NULL,2);
var_326[1] = var_309;
// bld-rtl-dir/wile-rtl2-000028.scm:114
var_325 = wile_foldl1(NULL, var_326, "bld-rtl-dir/wile-rtl2-000028.scm:114");
}
lval var_332;
{
lval var_333[8];
var_333[0] = LVI_PROC(fn_327,NULL,2);
var_333[1] = var_309;
// bld-rtl-dir/wile-rtl2-000028.scm:114
var_332 = wile_foldl1(NULL, var_333, "bld-rtl-dir/wile-rtl2-000028.scm:114");
}
lval var_334;
switch (TYPE_COMBO(var_325.vt,var_332.vt)) {
case TYPE_COMBO(LV_INT,LV_INT):
var_334 = LVI_BOOL(var_325.v.iv != var_332.v.iv);
break;
case TYPE_COMBO(LV_INT,LV_RAT):
var_334 = LVI_BOOL(var_325.v.iv * var_332.v.irv.den != var_332.v.irv.num);
break;
case TYPE_COMBO(LV_INT,LV_REAL):
var_334 = LVI_BOOL(var_325.v.iv != var_332.v.rv);
break;
case TYPE_COMBO(LV_RAT,LV_INT):
var_334 = LVI_BOOL(var_325.v.irv.num != var_332.v.iv * var_325.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_RAT):
var_334 = LVI_BOOL(var_325.v.irv.num * var_332.v.irv.den != var_332.v.irv.num * var_325.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_REAL):
var_334 = LVI_BOOL(var_325.v.irv.num != var_332.v.rv * var_325.v.irv.den);
break;
case TYPE_COMBO(LV_REAL,LV_INT):
var_334 = LVI_BOOL(var_325.v.rv != var_332.v.iv);
break;
case TYPE_COMBO(LV_REAL,LV_RAT):
var_334 = LVI_BOOL(var_325.v.rv * var_332.v.irv.den != var_332.v.irv.num);
break;
case TYPE_COMBO(LV_REAL,LV_REAL):
var_334 = LVI_BOOL(var_325.v.rv != var_332.v.rv);
break;
default:
WILE_EX("!=", "inputs are not real-valued numbers");
break;
}
if (LV_IS_FALSE(var_334)) {
lval var_335;
var_335 = LVI_NIL();
lval var_338[8];
var_338[0] = var_240[0];
var_338[1] = var_335;
var_338[2] = var_307;
var_240[0] = var_338[0];
var_240[1] = var_338[1];
var_240[2] = var_338[2];
// bld-rtl-dir/wile-rtl2-000028.scm:116
TAIL_CALL fn_242(NULL, var_240, "bld-rtl-dir/wile-rtl2-000028.scm:116");
} else {
lval var_339;
var_339 = LVI_STRING("map got lists of different lengths");
lval var_340;
{
lval var_341[1];
var_341[0] = var_339;
var_340 = wile_gen_list(1, var_341, NULL);
}
if (var_340.vt == LV_PAIR && (var_340.v.pair.cdr == NULL || var_340.v.pair.cdr->vt == LV_NIL)) {
var_340 = (var_340.v.pair.car ? *(var_340.v.pair.car) : LVI_NIL());
}
cachalot->errval = new_lv(LV_NIL);
*(cachalot->errval) = var_340;
cachalot->l_whence = 0;
cachalot->c_whence = LISP_WHENCE;
longjmp(cachalot->cenv, 1);
var_319 = var_340;
}
var_275 = var_319;
break;
}
}
return var_275;
}
// end of function wile_map
