// Generated by wile, the extremely stable scheming genius compiler

#include "wile-rtl1.h"
#include "wile-rtl2.h"

// declarations

extern lval var_argv;
extern lval var_cmd_name;
extern lval var_stdin;
extern lval var_stdout;
extern lval var_stderr;
extern lval var_pi;
extern lval var_euler_gamma;
extern lval var_show_sign;
extern lval var_int_base;
extern lval var_flt_base;
extern lval var_flt_precision;
#include "wile-rtl2.h"
static lval fn_1(lptr*, lptr);	// (make-bbox name value)
static lval fn_2(lptr*, lptr);	// (isa-bbox? it)
static lval fn_3(lptr*, lptr);	// (get-bbox-name it)
static lval fn_4(lptr*, lptr);	// (get-bbox-value it)
static lval fn_5(lptr*, lptr);	// (set-bbox-name! it val)
static lval fn_6(lptr*, lptr);	// (set-bbox-value! it val)
static lval fn_7(lptr*, lptr);	// (ERR fmt . args)
static lval fn_8(lptr*, lptr);	// (atom? val)
static lval fn_9(lptr*, lptr);	// (special-form? val)
static lval fn_10(lptr*, lptr);	// (unique-symbols? lst)
static lval fn_11(lptr*, lptr);	// (symbol-lookup box? env sym)
static lval fn_12(lptr*, lptr);	// (eval-binding env expr)
static lval fn_13(lptr*, lptr);	// (eval-if env exprs)
static lval fn_14(lptr*, lptr);	// (eval-and init env exprs)
static lval fn_15(lptr*, lptr);	// (eval-or init env exprs)
static lval fn_16(lptr*, lptr);	// (check-let-bindings type llist)
static lval fn_17(lptr*, lptr);	// (eval-let rec? star? env exprs)
static lval fn_18(lptr*, lptr);	// (eval-qq-olist level env expr)
static lval fn_19(lptr*, lptr);	// (eval-qq level env expr)
static lval fn_20(lptr*, lptr);	// (eval-cond env expr)
static lval fn_21(lptr*, lptr);	// (eval-set! env expr)
static lval fn_22(lptr*, lptr);	// (eval-guard env expr)
static lval fn_23(lptr*, lptr);	// (eval-case env expr)
static lval fn_24(lptr*, lptr);	// (args-list dotted-list)
static lval fn_25(lptr*, lptr);	// (eval-lambda env expr)
static lval fn_26(lptr*, lptr);	// (check-syntax-do expr)
static lval fn_27(lptr*, lptr);	// (eval-do env expr)
static lval fn_171(lptr*, lptr);
static lval fn_182(lptr*, lptr);
static lval fn_247(lptr*, lptr);
static lval fn_266(lptr*, lptr);
static lval fn_285(lptr*, lptr);
static lval fn_399(lptr*, lptr);
static lval fn_462(lptr*, lptr);
static lval fn_468(lptr*, lptr);
static lval fn_532(lptr*, lptr);
static lval fn_595(lptr*, lptr);
static lval fn_642(lptr*, lptr);
static lval fn_667(lptr*, lptr);
static lval fn_873(lptr*, lptr);
static lval fn_926(lptr*, lptr);
static lval fn_989(lptr*, lptr);
static lval fn_1092(lptr*, lptr);
static lval fn_1124(lptr*, lptr);
static lval fn_1137(lptr*, lptr);
static lval fn_1147(lptr*, lptr);
static lval fn_1180(lptr*, lptr);
static lval fn_1244(lptr*, lptr);
static lval fn_1276(lptr*, lptr);
static lval fn_1444(lptr*, lptr);
static lval fn_1459(lptr*, lptr);

// definitions

// @@@ (make-bbox name value) @@@ bld-rtl-dir/wile-rtl2-000082.scm:20 @@@ fn_1 @@@
static lval fn_1(lptr* var_28, lptr var_29)
{
lval var_31;
lval var_32;
var_32 = LVI_INT(3);
lval var_33;
{
size_t i, capa;
var_33.vt = LV_VECTOR;
capa = var_32.v.iv;
var_33.v.vec.capa = capa;
var_33.v.vec.arr = LISP_ALLOC(lptr, (capa > 0 ? capa : 1));
if (var_33.v.vec.arr == NULL) {
WILE_EX("vector-create", "memory allocation failed!");
}
for (i = 0; i < capa; ++i) {
var_33.v.vec.arr[i] = NULL;
}
}
var_31 = var_33;
lval var_34;
var_34 = LVI_INT(0);
lval var_35;
var_35 = LVI_SYMBOL("bbox");
{
if (var_31.vt != LV_VECTOR) {
WILE_EX("vector-set!", "input is not a vector");
}
if (var_34.vt != LV_INT || var_34.v.iv < 0 || (size_t) var_34.v.iv >= var_31.v.vec.capa) {
WILE_EX("vector-set!", "got bad index value");
}
var_31.v.vec.arr[var_34.v.iv] = new_lv(LV_NIL);
*(var_31.v.vec.arr[var_34.v.iv]) = var_35;
}
lval var_37;
var_37 = LVI_INT(1);
{
if (var_31.vt != LV_VECTOR) {
WILE_EX("vector-set!", "input is not a vector");
}
if (var_37.vt != LV_INT || var_37.v.iv < 0 || (size_t) var_37.v.iv >= var_31.v.vec.capa) {
WILE_EX("vector-set!", "got bad index value");
}
var_31.v.vec.arr[var_37.v.iv] = new_lv(LV_NIL);
*(var_31.v.vec.arr[var_37.v.iv]) = var_29[0];
}
lval var_39;
var_39 = LVI_INT(2);
{
if (var_31.vt != LV_VECTOR) {
WILE_EX("vector-set!", "input is not a vector");
}
if (var_39.vt != LV_INT || var_39.v.iv < 0 || (size_t) var_39.v.iv >= var_31.v.vec.capa) {
WILE_EX("vector-set!", "got bad index value");
}
var_31.v.vec.arr[var_39.v.iv] = new_lv(LV_NIL);
*(var_31.v.vec.arr[var_39.v.iv]) = var_29[1];
}
return var_31;
}
// end of function fn_1

// @@@ (isa-bbox? it) @@@ bld-rtl-dir/wile-rtl2-000082.scm:20 @@@ fn_2 @@@
static lval fn_2(lptr* var_41, lptr var_42)
{
lval var_44;
var_44 = LVI_BOOL(true);
do {
lval var_45;
var_45 = LVI_BOOL(var_42[0].vt == LV_VECTOR);
var_44 = var_45;
if (LV_IS_FALSE(var_44)) { break; }
lval var_46;
var_46 = LVI_INT(0);
lval var_47;
{
if (var_42[0].vt != LV_VECTOR) {
WILE_EX("vector-ref", "input is not a vector");
}
if (var_46.vt != LV_INT || var_46.v.iv < 0 || (size_t) var_46.v.iv >= var_42[0].v.vec.capa) {
WILE_EX("vector-ref", "got bad index value");
}
var_47 = var_42[0].v.vec.arr[var_46.v.iv] ? *(var_42[0].v.vec.arr[var_46.v.iv]) : LVI_NIL();
}
lval var_48;
var_48 = LVI_SYMBOL("bbox");
lval var_49;
var_49 = LVI_BOOL(wile_do_eqv(&(var_47), &(var_48)));
var_44 = var_49;
if (LV_IS_FALSE(var_44)) { break; }
} while (0);
return var_44;
}
// end of function fn_2

// @@@ (get-bbox-name it) @@@ ./wrtl.sch:0 @@@ fn_3 @@@
static lval fn_3(lptr* var_50, lptr var_51)
{
lval var_53;
var_53 = LVI_INT(1);
lval var_54;
{
if (var_51[0].vt != LV_VECTOR) {
WILE_EX("vector-ref", "input is not a vector");
}
if (var_53.vt != LV_INT || var_53.v.iv < 0 || (size_t) var_53.v.iv >= var_51[0].v.vec.capa) {
WILE_EX("vector-ref", "got bad index value");
}
var_54 = var_51[0].v.vec.arr[var_53.v.iv] ? *(var_51[0].v.vec.arr[var_53.v.iv]) : LVI_NIL();
}
return var_54;
}
// end of function fn_3

// @@@ (get-bbox-value it) @@@ ./wrtl.sch:0 @@@ fn_4 @@@
static lval fn_4(lptr* var_55, lptr var_56)
{
lval var_58;
var_58 = LVI_INT(2);
lval var_59;
{
if (var_56[0].vt != LV_VECTOR) {
WILE_EX("vector-ref", "input is not a vector");
}
if (var_58.vt != LV_INT || var_58.v.iv < 0 || (size_t) var_58.v.iv >= var_56[0].v.vec.capa) {
WILE_EX("vector-ref", "got bad index value");
}
var_59 = var_56[0].v.vec.arr[var_58.v.iv] ? *(var_56[0].v.vec.arr[var_58.v.iv]) : LVI_NIL();
}
return var_59;
}
// end of function fn_4

// @@@ (set-bbox-name! it val) @@@ ./wrtl.sch:0 @@@ fn_5 @@@
static lval fn_5(lptr* var_60, lptr var_61)
{
lval var_63;
var_63 = LVI_INT(1);
lval var_64;
{
if (var_61[0].vt != LV_VECTOR) {
WILE_EX("vector-set!", "input is not a vector");
}
if (var_63.vt != LV_INT || var_63.v.iv < 0 || (size_t) var_63.v.iv >= var_61[0].v.vec.capa) {
WILE_EX("vector-set!", "got bad index value");
}
var_61[0].v.vec.arr[var_63.v.iv] = new_lv(LV_NIL);
*(var_61[0].v.vec.arr[var_63.v.iv]) = var_61[1];
var_64 = var_61[0];
}
return var_64;
}
// end of function fn_5

// @@@ (set-bbox-value! it val) @@@ ./wrtl.sch:0 @@@ fn_6 @@@
static lval fn_6(lptr* var_65, lptr var_66)
{
lval var_68;
var_68 = LVI_INT(2);
lval var_69;
{
if (var_66[0].vt != LV_VECTOR) {
WILE_EX("vector-set!", "input is not a vector");
}
if (var_68.vt != LV_INT || var_68.v.iv < 0 || (size_t) var_68.v.iv >= var_66[0].v.vec.capa) {
WILE_EX("vector-set!", "got bad index value");
}
var_66[0].v.vec.arr[var_68.v.iv] = new_lv(LV_NIL);
*(var_66[0].v.vec.arr[var_68.v.iv]) = var_66[1];
var_69 = var_66[0];
}
return var_69;
}
// end of function fn_6

// @@@ sprintf @@@ bld-rtl-dir/wile-rtl2-000082.scm:24 @@@ fn_75 @@@
static lval fn_75(lptr* var_76, lptr var_77)
{
lval var_79;
var_79 = var_77[1];
{
lval var_80[8];
var_80[0] = var_77[0];
var_80[1] = var_79;
var_79 = wile_sprintf(NULL, var_80);
}
return var_79;
}
// end of prim fn_75

// @@@ (ERR fmt . args) @@@ bld-rtl-dir/wile-rtl2-000082.scm:22 @@@ fn_7 @@@
static lval fn_7(lptr* var_70, lptr var_71)
{
{
lval var_74[8];
var_74[0] = var_stderr;
(void)
 wile_flushport(NULL, var_74);
}
lval var_81;
var_81 = LVI_STRING(" at ");
lval var_82;
var_82 = LVI_STRING(wile_decode_line_loc(wile_get_lisp_loc(&var_71[1])));
lval var_83;
{
lval var_85[3];
var_85[0] = var_71[0];
var_85[1] = var_81;
var_85[2] = var_82;
var_83 = wile_gen_list(3, var_85, NULL);
}
{
lval var_84[8];
var_84[0] = var_83;
var_83 = wile_string_append(NULL, var_84);
}
lval var_86;
{
lval var_87[3];
var_87[0] = LVI_PROC(fn_75,NULL,-2);
var_87[1] = var_83;
var_87[2] = var_71[1];
var_86 = wile_gen_list(3, var_87, NULL);
}
var_86 = wile_apply_function(&(var_86), __FILE__, __LINE__);
lval var_88;
{
lval var_89[1];
var_89[0] = var_86;
var_88 = wile_gen_list(1, var_89, NULL);
}
if (var_88.vt == LV_PAIR && (var_88.v.pair.cdr == NULL || var_88.v.pair.cdr->vt == LV_NIL)) {
var_88 = (var_88.v.pair.car ? *(var_88.v.pair.car) : LVI_NIL());
}
cachalot->errval = new_lv(LV_NIL);
*(cachalot->errval) = var_88;
cachalot->l_whence = 0;
cachalot->c_whence = LISP_WHENCE;
longjmp(cachalot->cenv, 1);
return var_88;
}
// end of function fn_7

// @@@ (atom? val) @@@ bld-rtl-dir/wile-rtl2-000082.scm:28 @@@ fn_8 @@@
static lval fn_8(lptr* var_90, lptr var_91)
{
lval var_93;
var_93 = LVI_BOOL(false);
do {
lval var_94;
var_94 = LVI_BOOL(var_91[0].vt == LV_NIL);
var_93 = var_94;
if (!LV_IS_FALSE(var_93)) { break; }
lval var_95;
var_95 = LVI_BOOL(var_91[0].vt == LV_BOOL);
var_93 = var_95;
if (!LV_IS_FALSE(var_93)) { break; }
lval var_96;
var_96 = LVI_BOOL(var_91[0].vt == LV_CHAR);
var_93 = var_96;
if (!LV_IS_FALSE(var_93)) { break; }
lval var_97;
var_97 = LVI_BOOL(var_91[0].vt == LV_STRING);
var_93 = var_97;
if (!LV_IS_FALSE(var_93)) { break; }
lval var_98;
var_98 = LVI_BOOL(var_91[0].vt == LV_INT);
var_93 = var_98;
if (!LV_IS_FALSE(var_93)) { break; }
lval var_99;
var_99 = LVI_BOOL(var_91[0].vt == LV_RAT || var_91[0].vt == LV_INT);
var_93 = var_99;
if (!LV_IS_FALSE(var_93)) { break; }
lval var_100;
var_100 = LVI_BOOL(var_91[0].vt == LV_REAL || var_91[0].vt == LV_RAT || var_91[0].vt == LV_INT);
var_93 = var_100;
if (!LV_IS_FALSE(var_93)) { break; }
lval var_101;
var_101 = LVI_BOOL(var_91[0].vt == LV_CMPLX || var_91[0].vt == LV_REAL || var_91[0].vt == LV_RAT || var_91[0].vt == LV_INT);
var_93 = var_101;
if (!LV_IS_FALSE(var_93)) { break; }
lval var_102;
var_102 = LVI_BOOL(var_91[0].vt == LV_FILE_PORT);
var_93 = var_102;
if (!LV_IS_FALSE(var_93)) { break; }
lval var_103;
var_103 = LVI_BOOL(var_91[0].vt == LV_PIPE_PORT);
var_93 = var_103;
if (!LV_IS_FALSE(var_93)) { break; }
lval var_104;
var_104 = LVI_BOOL(var_91[0].vt == LV_SOCK_PORT);
var_93 = var_104;
if (!LV_IS_FALSE(var_93)) { break; }
lval var_105;
var_105 = LVI_BOOL(var_91[0].vt == LV_STR_PORT);
var_93 = var_105;
if (!LV_IS_FALSE(var_93)) { break; }
lval var_106;
var_106 = LVI_BOOL(var_91[0].vt == LV_SQLITE_PORT);
var_93 = var_106;
if (!LV_IS_FALSE(var_93)) { break; }
lval var_107;
var_107 = LVI_BOOL(var_91[0].vt == LV_SQLITE_STMT);
var_93 = var_107;
if (!LV_IS_FALSE(var_93)) { break; }
} while (0);
return var_93;
}
// end of function fn_8

// @@@ (special-form? val) @@@ bld-rtl-dir/wile-rtl2-000082.scm:44 @@@ fn_9 @@@
static lval fn_9(lptr* var_108, lptr var_109)
{
lval var_111;
var_111 = LVI_BOOL(true);
do {
lval var_112;
var_112 = LVI_BOOL(var_109[0].vt == LV_SYMBOL);
var_111 = var_112;
if (LV_IS_FALSE(var_111)) { break; }
lval var_113;
var_113 = LVI_BOOL(false);
do {
lval var_114;
var_114 = LVI_SYMBOL("quote");
lval var_115;
var_115 = LVI_BOOL(strcmp(var_109[0].v.str, var_114.v.str) == 0);
var_113 = var_115;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_116;
var_116 = LVI_SYMBOL("and");
lval var_117;
var_117 = LVI_BOOL(strcmp(var_109[0].v.str, var_116.v.str) == 0);
var_113 = var_117;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_118;
var_118 = LVI_SYMBOL("begin");
lval var_119;
var_119 = LVI_BOOL(strcmp(var_109[0].v.str, var_118.v.str) == 0);
var_113 = var_119;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_120;
var_120 = LVI_SYMBOL("case");
lval var_121;
var_121 = LVI_BOOL(strcmp(var_109[0].v.str, var_120.v.str) == 0);
var_113 = var_121;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_122;
var_122 = LVI_SYMBOL("cond");
lval var_123;
var_123 = LVI_BOOL(strcmp(var_109[0].v.str, var_122.v.str) == 0);
var_113 = var_123;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_124;
var_124 = LVI_SYMBOL("do");
lval var_125;
var_125 = LVI_BOOL(strcmp(var_109[0].v.str, var_124.v.str) == 0);
var_113 = var_125;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_126;
var_126 = LVI_SYMBOL("guard");
lval var_127;
var_127 = LVI_BOOL(strcmp(var_109[0].v.str, var_126.v.str) == 0);
var_113 = var_127;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_128;
var_128 = LVI_SYMBOL("if");
lval var_129;
var_129 = LVI_BOOL(strcmp(var_109[0].v.str, var_128.v.str) == 0);
var_113 = var_129;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_130;
var_130 = LVI_SYMBOL("lambda");
lval var_131;
var_131 = LVI_BOOL(strcmp(var_109[0].v.str, var_130.v.str) == 0);
var_113 = var_131;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_132;
var_132 = LVI_SYMBOL("let");
lval var_133;
var_133 = LVI_BOOL(strcmp(var_109[0].v.str, var_132.v.str) == 0);
var_113 = var_133;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_134;
var_134 = LVI_SYMBOL("let*");
lval var_135;
var_135 = LVI_BOOL(strcmp(var_109[0].v.str, var_134.v.str) == 0);
var_113 = var_135;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_136;
var_136 = LVI_SYMBOL("letrec");
lval var_137;
var_137 = LVI_BOOL(strcmp(var_109[0].v.str, var_136.v.str) == 0);
var_113 = var_137;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_138;
var_138 = LVI_SYMBOL("letrec*");
lval var_139;
var_139 = LVI_BOOL(strcmp(var_109[0].v.str, var_138.v.str) == 0);
var_113 = var_139;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_140;
var_140 = LVI_SYMBOL("or");
lval var_141;
var_141 = LVI_BOOL(strcmp(var_109[0].v.str, var_140.v.str) == 0);
var_113 = var_141;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_142;
var_142 = LVI_SYMBOL("set!");
lval var_143;
var_143 = LVI_BOOL(strcmp(var_109[0].v.str, var_142.v.str) == 0);
var_113 = var_143;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_144;
var_144 = LVI_SYMBOL("quasiquote");
lval var_145;
var_145 = LVI_BOOL(strcmp(var_109[0].v.str, var_144.v.str) == 0);
var_113 = var_145;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_146;
var_146 = LVI_SYMBOL("unquote");
lval var_147;
var_147 = LVI_BOOL(strcmp(var_109[0].v.str, var_146.v.str) == 0);
var_113 = var_147;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_148;
var_148 = LVI_SYMBOL("unquote-splicing");
lval var_149;
var_149 = LVI_BOOL(strcmp(var_109[0].v.str, var_148.v.str) == 0);
var_113 = var_149;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_150;
var_150 = LVI_SYMBOL("pragma");
lval var_151;
var_151 = LVI_BOOL(strcmp(var_109[0].v.str, var_150.v.str) == 0);
var_113 = var_151;
if (!LV_IS_FALSE(var_113)) { break; }
} while (0);
var_111 = var_113;
if (LV_IS_FALSE(var_111)) { break; }
} while (0);
return var_111;
}
// end of function fn_9

// @@@ (define-form? expr) @@@ bld-rtl-dir/wile-rtl2-000082.scm:72 @@@ wile_eval_define_form @@@
lval wile_eval_define_form(lptr* var_152, lptr var_153)
{
lval var_155;
var_155 = LVI_BOOL(true);
do {
lval var_156;
var_156 = LVI_BOOL(var_153[0].vt == LV_PAIR);
var_155 = var_156;
if (LV_IS_FALSE(var_155)) { break; }
lval var_157;
if (var_153[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_157 = (var_153[0].v.pair.car ? *(var_153[0].v.pair.car) : LVI_NIL());
lval var_158;
var_158 = LVI_BOOL(var_157.vt == LV_SYMBOL);
var_155 = var_158;
if (LV_IS_FALSE(var_155)) { break; }
lval var_159;
var_159 = LVI_BOOL(false);
do {
lval var_160;
if (var_153[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_160 = (var_153[0].v.pair.car ? *(var_153[0].v.pair.car) : LVI_NIL());
lval var_161;
var_161 = LVI_SYMBOL("define");
lval var_162;
var_162 = LVI_BOOL(strcmp(var_160.v.str, var_161.v.str) == 0);
var_159 = var_162;
if (!LV_IS_FALSE(var_159)) { break; }
lval var_163;
if (var_153[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_163 = (var_153[0].v.pair.car ? *(var_153[0].v.pair.car) : LVI_NIL());
lval var_164;
var_164 = LVI_SYMBOL("defmacro");
lval var_165;
var_165 = LVI_BOOL(strcmp(var_163.v.str, var_164.v.str) == 0);
var_159 = var_165;
if (!LV_IS_FALSE(var_159)) { break; }
} while (0);
var_155 = var_159;
if (LV_IS_FALSE(var_155)) { break; }
} while (0);
return var_155;
}
// end of function wile_eval_define_form

// @@@ lambda (c) @@@ bld-rtl-dir/wile-rtl2-000082.scm:83 @@@ fn_171 @@@
static lval fn_171(lptr* var_172, lptr var_173)
{
lval var_175;
var_175 = LVI_CHAR(58);
lval var_176;
var_176 = LVI_BOOL(wile_do_eqv(&(var_173[0]), &(var_175)));
return var_176;
}
// end of lambda fn_171

// @@@ lambda (ps) @@@ bld-rtl-dir/wile-rtl2-000082.scm:85 @@@ fn_182 @@@
static lval fn_182(lptr* var_183, lptr var_184)
{
lbl_185:;
lval var_186;
lval var_187;
var_187 = LVI_BOOL(var_184[0].vt == LV_NIL);
if (LV_IS_FALSE(var_187)) {
lval var_188;
lval var_189;
var_189 = LVI_STRING("/");
lval var_190;
if (var_184[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_190 = (var_184[0].v.pair.car ? *(var_184[0].v.pair.car) : LVI_NIL());
lval var_191;
{
lval var_193[2];
var_193[0] = var_190;
var_193[1] = V_CLOS(var_183,0);
var_191 = wile_gen_list(2, var_193, NULL);
}
{
lval var_192[8];
var_192[0] = var_189;
var_192[1] = var_191;
var_191 = wile_string_join_by(NULL, var_192);
}
var_188 = var_191;
lval var_194;
lval var_195;
var_195 = LVI_BOOL(access(var_188.v.str, F_OK) == 0);
if (LV_IS_FALSE(var_195)) {
lval var_196;
if (var_184[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_196 = (var_184[0].v.pair.cdr ? *(var_184[0].v.pair.cdr) : LVI_NIL());
lval var_199[8];
var_199[0] = var_196;
var_184[0] = var_199[0];
goto lbl_185;	// selfie
} else {
var_194 = var_188;
}
var_186 = var_194;
} else {
lval var_200;
var_200 = LVI_BOOL(false);
var_186 = var_200;
}
return var_186;
}
// end of lambda fn_182

// @@@ (load-file-path pathy? fname) @@@ bld-rtl-dir/wile-rtl2-000082.scm:80 @@@ wile_eval_load_path @@@
lval wile_eval_load_path(lptr* var_166, lptr var_167)
{
lval var_169;
if (LV_IS_FALSE(var_167[0])) {
var_169 = var_167[1];
} else {
lval var_170;
MK_CLOS(var_172,0);
lval var_177;
var_177 = LVI_STRING("WILE_LIBRARY_PATH");
lval var_178;
{
char* ev = getenv(var_177.v.str);
var_178 = (ev ? LVI_STRING(ev) : LVI_BOOL(false));
}
lval var_179;
{
lval var_180[8];
var_180[0] = LVI_PROC(fn_171,var_172,1);
var_180[1] = var_178;
var_179 = wile_string_split_by(NULL, var_180);
}
var_170 = var_179;
lval var_181;
MK_CLOS(var_183,1);
lptr var_201 = new_lv(VT_UNINIT);
var_201->v.pair.car = &(var_167[1]);
P_CLOS(var_183,0) = var_201;
lval var_202;
lval var_203[8];
var_203[0] = var_170;
var_202 = fn_182(var_183, var_203);
*var_201 = var_167[1];
var_181 = var_202;
lval var_205;
if (LV_IS_FALSE(var_181)) {
lval var_206;
var_206 = LVI_STRING("unable to find file \'");
lval var_207;
var_207 = LVI_STRING("\'");
lval var_208;
{
lval var_210[3];
var_210[0] = var_206;
var_210[1] = var_167[1];
var_210[2] = var_207;
var_208 = wile_gen_list(3, var_210, NULL);
}
{
lval var_209[8];
var_209[0] = var_208;
var_208 = wile_string_append(NULL, var_209);
}
lval var_211;
{
lval var_212[1];
var_212[0] = var_208;
var_211 = wile_gen_list(1, var_212, NULL);
}
if (var_211.vt == LV_PAIR && (var_211.v.pair.cdr == NULL || var_211.v.pair.cdr->vt == LV_NIL)) {
var_211 = (var_211.v.pair.car ? *(var_211.v.pair.car) : LVI_NIL());
}
cachalot->errval = new_lv(LV_NIL);
*(cachalot->errval) = var_211;
cachalot->l_whence = 0;
cachalot->c_whence = LISP_WHENCE;
longjmp(cachalot->cenv, 1);
var_205 = var_211;
} else {
var_205 = var_181;
}
var_169 = var_205;
}
return var_169;
}
// end of function wile_eval_load_path

// @@@ (load-form? expr) @@@ bld-rtl-dir/wile-rtl2-000082.scm:97 @@@ wile_eval_load_form @@@
lval wile_eval_load_form(lptr* var_213, lptr var_214)
{
lval var_216;
var_216 = LVI_BOOL(true);
do {
lval var_217;
var_217 = LVI_BOOL(var_214[0].vt == LV_PAIR);
var_216 = var_217;
if (LV_IS_FALSE(var_216)) { break; }
lval var_218;
if (var_214[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_218 = (var_214[0].v.pair.car ? *(var_214[0].v.pair.car) : LVI_NIL());
lval var_219;
var_219 = LVI_BOOL(var_218.vt == LV_SYMBOL);
var_216 = var_219;
if (LV_IS_FALSE(var_216)) { break; }
lval var_220;
var_220 = LVI_BOOL(false);
do {
lval var_221;
if (var_214[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_221 = (var_214[0].v.pair.car ? *(var_214[0].v.pair.car) : LVI_NIL());
lval var_222;
var_222 = LVI_SYMBOL("load");
lval var_223;
var_223 = LVI_BOOL(strcmp(var_221.v.str, var_222.v.str) == 0);
var_220 = var_223;
if (!LV_IS_FALSE(var_220)) { break; }
lval var_224;
if (var_214[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_224 = (var_214[0].v.pair.car ? *(var_214[0].v.pair.car) : LVI_NIL());
lval var_225;
var_225 = LVI_SYMBOL("load-library");
lval var_226;
var_226 = LVI_BOOL(strcmp(var_224.v.str, var_225.v.str) == 0);
var_220 = var_226;
if (!LV_IS_FALSE(var_220)) { break; }
} while (0);
var_216 = var_220;
if (LV_IS_FALSE(var_216)) { break; }
lval var_227;
var_227 = LVI_INT(2);
lval var_228;
{
lval var_229[8];
var_229[0] = var_227;
var_229[1] = var_214[0];
var_228 = wile_list_length_eq(NULL, var_229);
}
var_216 = var_228;
if (LV_IS_FALSE(var_216)) { break; }
} while (0);
return var_216;
}
// end of function wile_eval_load_form

// @@@ (begin-form? expr) @@@ bld-rtl-dir/wile-rtl2-000082.scm:106 @@@ wile_eval_begin_form @@@
lval wile_eval_begin_form(lptr* var_230, lptr var_231)
{
lval var_233;
var_233 = LVI_BOOL(true);
do {
lval var_234;
var_234 = LVI_BOOL(var_231[0].vt == LV_PAIR);
var_233 = var_234;
if (LV_IS_FALSE(var_233)) { break; }
lval var_235;
if (var_231[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_235 = (var_231[0].v.pair.car ? *(var_231[0].v.pair.car) : LVI_NIL());
lval var_236;
var_236 = LVI_BOOL(var_235.vt == LV_SYMBOL);
var_233 = var_236;
if (LV_IS_FALSE(var_233)) { break; }
lval var_237;
if (var_231[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_237 = (var_231[0].v.pair.car ? *(var_231[0].v.pair.car) : LVI_NIL());
lval var_238;
var_238 = LVI_SYMBOL("begin");
lval var_239;
var_239 = LVI_BOOL(strcmp(var_237.v.str, var_238.v.str) == 0);
var_233 = var_239;
if (LV_IS_FALSE(var_233)) { break; }
lval var_240;
var_240 = LVI_INT(2);
lval var_241;
{
lval var_242[8];
var_242[0] = var_240;
var_242[1] = var_231[0];
var_241 = wile_list_length_ge(NULL, var_242);
}
var_233 = var_241;
if (LV_IS_FALSE(var_233)) { break; }
} while (0);
return var_233;
}
// end of function wile_eval_begin_form

// @@@ lambda (ls) @@@ bld-rtl-dir/wile-rtl2-000082.scm:113 @@@ fn_247 @@@
static lval fn_247(lptr* var_248, lptr var_249)
{
lbl_250:;
lval var_251;
do {
lval var_252;
var_252 = LVI_BOOL(var_249[0].vt == LV_NIL);
if (!LV_IS_FALSE(var_252)) {
lval var_253;
var_253 = LVI_BOOL(true);
var_251 = var_253;
break;
}
lval var_254;
if (var_249[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_254 = (var_249[0].v.pair.car ? *(var_249[0].v.pair.car) : LVI_NIL());
lval var_255;
var_255 = LVI_BOOL(var_254.vt == LV_SYMBOL);
if (!LV_IS_FALSE(var_255)) {
lval var_256;
if (var_249[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_256 = (var_249[0].v.pair.cdr ? *(var_249[0].v.pair.cdr) : LVI_NIL());
lval var_259[8];
var_259[0] = var_256;
var_249[0] = var_259[0];
goto lbl_250;	// selfie
}
lval var_260;
var_260 = LVI_BOOL(false);
var_251 = var_260;
} while (0);
return var_251;
}
// end of lambda fn_247

// @@@ lambda (ss) @@@ bld-rtl-dir/wile-rtl2-000082.scm:118 @@@ fn_266 @@@
static lval fn_266(lptr* var_267, lptr var_268)
{
lbl_269:;
lval var_270;
do {
lval var_271;
var_271 = LVI_BOOL(var_268[0].vt == LV_NIL);
if (!LV_IS_FALSE(var_271)) {
lval var_272;
var_272 = LVI_BOOL(true);
var_270 = var_272;
break;
}
lval var_273;
if (var_268[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_273 = (var_268[0].v.pair.cdr ? *(var_268[0].v.pair.cdr) : LVI_NIL());
lval var_274;
var_274 = LVI_BOOL(var_273.vt == LV_NIL);
if (!LV_IS_FALSE(var_274)) {
lval var_275;
var_275 = LVI_BOOL(true);
var_270 = var_275;
break;
}
lval var_276;
if (var_268[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_276 = (var_268[0].v.pair.car ? *(var_268[0].v.pair.car) : LVI_NIL());
lval var_277;
var_277 = LVI_STRING("cadr");
lval var_278;
{
char* cp = strchr(var_277.v.str, 'r');
var_278 = var_268[0];
while (*(--cp) != 'c') {
if (var_278.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_278 = (var_278.v.pair.car ? *(var_278.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_278 = (var_278.v.pair.cdr ? *(var_278.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_277.v.str);
}
}
}
lval var_279;
var_279 = LVI_BOOL(strcmp(var_276.v.str, var_278.v.str) == 0);
if (!LV_IS_FALSE(var_279)) {
lval var_280;
var_280 = LVI_BOOL(false);
var_270 = var_280;
break;
}
lval var_281;
if (var_268[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_281 = (var_268[0].v.pair.cdr ? *(var_268[0].v.pair.cdr) : LVI_NIL());
lval var_284[8];
var_284[0] = var_281;
var_268[0] = var_284[0];
goto lbl_269;	// selfie
} while (0);
return var_270;
}
// end of lambda fn_266

// @@@ lambda (a b) @@@ bld-rtl-dir/wile-rtl2-000082.scm:118 @@@ fn_285 @@@
static lval fn_285(lptr* var_286, lptr var_287)
{
lval var_289;
var_289 = LVI_BOOL(strcmp(var_287[0].v.str, var_287[1].v.str) < 0);
return var_289;
}
// end of lambda fn_285

// @@@ symbol->string @@@ bld-rtl-dir/wile-rtl2-000082.scm:119 @@@ fn_290 @@@
static lval fn_290(lptr* var_291, lptr var_292)
{
lval var_294;
var_294 = LVI_STRING(var_292[0].v.str);
return var_294;
}
// end of prim fn_290

// @@@ (unique-symbols? lst) @@@ bld-rtl-dir/wile-rtl2-000082.scm:112 @@@ fn_10 @@@
static lval fn_10(lptr* var_243, lptr var_244)
{
lval var_246;
MK_CLOS(var_248,0);
lval var_261;
lval var_262[8];
var_262[0] = var_244[0];
var_261 = fn_247(var_248, var_262);
var_246 = var_261;
lval var_264;
if (LV_IS_FALSE(var_246)) {
lval var_265;
var_265 = LVI_BOOL(false);
var_264 = var_265;
} else {
MK_CLOS(var_267,0);
MK_CLOS(var_286,0);
lval var_295;
var_295 = LVI_NIL();
{
lval var_296[8];
var_296[0] = LVI_PROC(fn_290,NULL,1);
var_296[1] = var_244[0];
var_296[2] = var_295;
var_295 = wile_map(NULL, var_296);
}
lval var_297;
{
lval var_298[8];
var_298[0] = LVI_PROC(fn_285,var_286,2);
var_298[1] = var_295;
var_297 = wile_list_sort(NULL, var_298);
}
lval var_299;
lval var_300[8];
var_300[0] = var_297;
var_299 = fn_266(var_267, var_300);
var_264 = var_299;
}
return var_264;
}
// end of function fn_10

// @@@ (symbol-lookup box? env sym) @@@ bld-rtl-dir/wile-rtl2-000082.scm:126 @@@ fn_11 @@@
static lval fn_11(lptr* var_302, lptr var_303)
{
lbl_304:;
lval var_305;
do {
lval var_306;
var_306 = LVI_BOOL(var_303[1].vt == LV_NIL);
if (!LV_IS_FALSE(var_306)) {
lval var_307;
var_307 = LVI_STRING("symbol \'%s\' lookup failed!");
lval var_310[8];
var_310[0] = var_307;
lval var_311[8];
var_311[0] = var_303[2];
var_303[1] = wile_gen_list(1, var_311, NULL);
var_303[0] = var_310[0];
TAIL_CALL fn_7(NULL, var_303);
}
lval var_312;
if (var_303[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_312 = (var_303[1].v.pair.car ? *(var_303[1].v.pair.car) : LVI_NIL());
lval var_313;
lval var_314[8];
var_314[0] = var_312;
var_313 = fn_3(NULL, var_314);
lval var_316;
var_316 = LVI_BOOL(strcmp(var_303[2].v.str, var_313.v.str) == 0);
if (!LV_IS_FALSE(var_316)) {
lval var_317;
if (LV_IS_FALSE(var_303[0])) {
lval var_318;
if (var_303[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_318 = (var_303[1].v.pair.car ? *(var_303[1].v.pair.car) : LVI_NIL());
lval var_321[8];
var_321[0] = var_318;
var_303[0] = var_321[0];
TAIL_CALL fn_4(NULL, var_303);
} else {
lval var_322;
if (var_303[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_322 = (var_303[1].v.pair.car ? *(var_303[1].v.pair.car) : LVI_NIL());
var_317 = var_322;
}
var_305 = var_317;
break;
}
lval var_323;
if (var_303[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_323 = (var_303[1].v.pair.cdr ? *(var_303[1].v.pair.cdr) : LVI_NIL());
lval var_326[8];
var_326[0] = var_303[0];
var_326[1] = var_323;
var_326[2] = var_303[2];
var_303[0] = var_326[0];
var_303[1] = var_326[1];
var_303[2] = var_326[2];
goto lbl_304;	// selfie
} while (0);
return var_305;
}
// end of function fn_11

// @@@ (eval-binding env expr) @@@ bld-rtl-dir/wile-rtl2-000082.scm:133 @@@ fn_12 @@@
static lval fn_12(lptr* var_327, lptr var_328)
{
lval var_330;
lval var_331;
var_331 = LVI_BOOL(true);
do {
lval var_332;
var_332 = LVI_BOOL(var_328[1].vt == LV_PAIR);
var_331 = var_332;
if (LV_IS_FALSE(var_331)) { break; }
lval var_333;
if (var_328[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_333 = (var_328[1].v.pair.car ? *(var_328[1].v.pair.car) : LVI_NIL());
lval var_334;
var_334 = LVI_BOOL(var_333.vt == LV_SYMBOL);
var_331 = var_334;
if (LV_IS_FALSE(var_331)) { break; }
} while (0);
if (LV_IS_FALSE(var_331)) {
lval var_335;
var_335 = LVI_STRING("malformed binding expression \'%v\'");
lval var_338[8];
var_338[0] = var_335;
lval var_339[8];
var_339[0] = var_328[1];
var_328[1] = wile_gen_list(1, var_339, NULL);
var_328[0] = var_338[0];
TAIL_CALL fn_7(NULL, var_328);
} else {
lval var_340;
if (var_328[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_340 = (var_328[1].v.pair.car ? *(var_328[1].v.pair.car) : LVI_NIL());
lval var_341;
var_341 = LVI_STRING("cadr");
lval var_342;
{
char* cp = strchr(var_341.v.str, 'r');
var_342 = var_328[1];
while (*(--cp) != 'c') {
if (var_342.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_342 = (var_342.v.pair.car ? *(var_342.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_342 = (var_342.v.pair.cdr ? *(var_342.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_341.v.str);
}
}
}
lval var_343;
lval var_344[8];
var_344[0] = var_328[0];
var_344[1] = var_342;
var_343 = wile_eval(NULL, var_344);
lval var_348[8];
var_348[0] = var_340;
var_348[1] = var_343;
var_328[0] = var_348[0];
var_328[1] = var_348[1];
TAIL_CALL fn_1(NULL, var_328);
}
return var_330;
}
// end of function fn_12

// @@@ (eval-define macro env expr) @@@ bld-rtl-dir/wile-rtl2-000082.scm:140 @@@ wile_eval_define @@@
lval wile_eval_define(lptr* var_349, lptr var_350)
{
lval var_352;
lval var_353;
do {
lval var_354;
if (var_350[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_354 = (var_350[2].v.pair.car ? *(var_350[2].v.pair.car) : LVI_NIL());
lval var_355;
var_355 = LVI_BOOL(var_354.vt == LV_SYMBOL);
if (!LV_IS_FALSE(var_355)) {
lval var_356;
lval var_357[8];
var_357[0] = var_350[1];
var_357[1] = var_350[2];
var_356 = fn_12(NULL, var_357);
var_353 = var_356;
break;
}
lval var_359;
var_359 = LVI_BOOL(true);
do {
lval var_360;
if (var_350[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_360 = (var_350[2].v.pair.car ? *(var_350[2].v.pair.car) : LVI_NIL());
lval var_361;
var_361 = LVI_BOOL(var_360.vt == LV_PAIR);
var_359 = var_361;
if (LV_IS_FALSE(var_359)) { break; }
lval var_362;
var_362 = LVI_STRING("caar");
lval var_363;
{
char* cp = strchr(var_362.v.str, 'r');
var_363 = var_350[2];
while (*(--cp) != 'c') {
if (var_363.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_363 = (var_363.v.pair.car ? *(var_363.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_363 = (var_363.v.pair.cdr ? *(var_363.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_362.v.str);
}
}
}
lval var_364;
var_364 = LVI_BOOL(var_363.vt == LV_SYMBOL);
var_359 = var_364;
if (LV_IS_FALSE(var_359)) { break; }
} while (0);
if (!LV_IS_FALSE(var_359)) {
lval var_365;
var_365 = LVI_STRING("caar");
lval var_366;
{
char* cp = strchr(var_365.v.str, 'r');
var_366 = var_350[2];
while (*(--cp) != 'c') {
if (var_366.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_366 = (var_366.v.pair.car ? *(var_366.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_366 = (var_366.v.pair.cdr ? *(var_366.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_365.v.str);
}
}
}
lval var_367;
var_367 = LVI_SYMBOL("lambda");
lval var_368;
var_368 = LVI_STRING("cdar");
lval var_369;
{
char* cp = strchr(var_368.v.str, 'r');
var_369 = var_350[2];
while (*(--cp) != 'c') {
if (var_369.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_369 = (var_369.v.pair.car ? *(var_369.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_369 = (var_369.v.pair.cdr ? *(var_369.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_368.v.str);
}
}
}
lval var_370;
if (var_350[2].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_370 = (var_350[2].v.pair.cdr ? *(var_350[2].v.pair.cdr) : LVI_NIL());
lval var_371;
{
lptr p1 = NULL, p2 = NULL;
if (var_369.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_369;
}
if (var_370.vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_370;
}
var_371 = LVI_PAIR(p1, p2);
}
lval var_372;
{
lptr p1 = NULL, p2 = NULL;
if (var_367.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_367;
}
if (var_371.vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_371;
}
var_372 = LVI_PAIR(p1, p2);
}
lval var_373;
{
lval var_374[2];
var_374[0] = var_366;
var_374[1] = var_372;
var_373 = wile_gen_list(2, var_374, NULL);
}
lval var_375;
lval var_376[8];
var_376[0] = var_350[1];
var_376[1] = var_373;
var_375 = fn_12(NULL, var_376);
var_353 = var_375;
break;
}
lval var_378;
var_378 = LVI_STRING("malformed \'define\' expression \'%v\'");
lval var_379;
lval var_380[8];
var_380[0] = var_378;
lval var_382[8];
var_382[0] = var_350[2];
var_380[1] = wile_gen_list(1, var_382, NULL);
var_379 = fn_7(NULL, var_380);
var_353 = var_379;
} while (0);
var_352 = var_353;
lval var_383;
lval var_384;
lval var_385[8];
var_385[0] = var_352;
var_384 = fn_4(NULL, var_385);
var_383 = var_384;
lval var_387;
lval var_388;
{
lptr p1 = NULL, p2 = NULL;
if (var_352.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_352;
}
if (var_350[1].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_350[1];
}
var_388 = LVI_PAIR(p1, p2);
}
var_387 = var_388;
lval var_390;
var_390 = LVI_BOOL(var_383.vt == LV_ILAMBDA);
if (LV_IS_FALSE(var_390)) {
(void)
 LVI_BOOL(false);
} else {
if (var_383.vt == LV_ILAMBDA && var_350[0].vt == LV_BOOL) {
var_383.v.ilambda->macro = var_350[0].v.bv;
} else {
WILE_EX("set-interpreted-procedure-macro!", "expects an interpreted procedure and a boolean");
}
if (var_383.vt == LV_ILAMBDA && var_387.vt == LV_PAIR) {
var_383.v.ilambda->env = var_387;
} else {
WILE_EX("set-interpreted-procedure-environment!", "expects an interpreted procedure and an environment list");
}
}
return var_387;
}
// end of function wile_eval_define

// @@@ lambda (es) @@@ bld-rtl-dir/wile-rtl2-000082.scm:162 @@@ fn_399 @@@
static lval fn_399(lptr* var_400, lptr var_401)
{
lbl_402:;
lval var_403;
lval var_404;
do {
lval var_405;
if (var_401[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_405 = (var_401[0].v.pair.car ? *(var_401[0].v.pair.car) : LVI_NIL());
lval var_406;
lval var_407[8];
var_407[0] = var_405;
var_406 = wile_eval_define_form(NULL, var_407);
if (!LV_IS_FALSE(var_406)) {
lval var_409;
var_409 = LVI_STRING("caar");
lval var_410;
{
char* cp = strchr(var_409.v.str, 'r');
var_410 = var_401[0];
while (*(--cp) != 'c') {
if (var_410.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_410 = (var_410.v.pair.car ? *(var_410.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_410 = (var_410.v.pair.cdr ? *(var_410.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_409.v.str);
}
}
}
lval var_411;
var_411 = LVI_SYMBOL("defmacro");
lval var_412;
var_412 = LVI_BOOL(strcmp(var_410.v.str, var_411.v.str) == 0);
lval var_413;
var_413 = LVI_STRING("cdar");
lval var_414;
{
char* cp = strchr(var_413.v.str, 'r');
var_414 = var_401[0];
while (*(--cp) != 'c') {
if (var_414.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_414 = (var_414.v.pair.car ? *(var_414.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_414 = (var_414.v.pair.cdr ? *(var_414.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_413.v.str);
}
}
}
lval var_415;
lval var_416[8];
var_416[0] = var_412;
var_416[1] = V_CLOS(var_400,0);
var_416[2] = var_414;
var_415 = wile_eval_define(NULL, var_416);
V_CLOS(var_400,0) = var_415;
if (LV_IS_FALSE(V_CLOS(var_400,1))) {
(void)
 LVI_BOOL(false);
} else {
lval var_421[8];
var_421[0] = V_CLOS(var_400,1);
var_421[1] = V_CLOS(var_400,0);
(void)
 fn_6(NULL, var_421);
}
lval var_423;
if (V_CLOS(var_400,0).vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_423 = (V_CLOS(var_400,0).v.pair.car ? *(V_CLOS(var_400,0).v.pair.car) : LVI_NIL());
lval var_424;
lval var_425[8];
var_425[0] = var_423;
var_424 = fn_4(NULL, var_425);
var_404 = var_424;
break;
}
lval var_427;
if (var_401[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_427 = (var_401[0].v.pair.car ? *(var_401[0].v.pair.car) : LVI_NIL());
lval var_428;
lval var_429[8];
var_429[0] = V_CLOS(var_400,0);
var_429[1] = var_427;
var_428 = wile_eval(NULL, var_429);
var_404 = var_428;
} while (0);
var_403 = var_404;
lval var_431;
lval var_432;
if (var_401[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_432 = (var_401[0].v.pair.cdr ? *(var_401[0].v.pair.cdr) : LVI_NIL());
lval var_433;
var_433 = LVI_BOOL(var_432.vt == LV_NIL);
if (LV_IS_FALSE(var_433)) {
lval var_434;
if (var_401[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_434 = (var_401[0].v.pair.cdr ? *(var_401[0].v.pair.cdr) : LVI_NIL());
lval var_437[8];
var_437[0] = var_434;
var_401[0] = var_437[0];
goto lbl_402;	// selfie
} else {
var_431 = var_403;
}
return var_431;
}
// end of lambda fn_399

// @@@ (eval-begin ebox env expr) @@@ bld-rtl-dir/wile-rtl2-000082.scm:159 @@@ wile_eval_begin @@@
lval wile_eval_begin(lptr* var_394, lptr var_395)
{
lval var_397;
lval var_398;
var_398 = LVI_BOOL(var_395[2].vt == LV_NIL);
if (LV_IS_FALSE(var_398)) {
MK_CLOS(var_400,2);
lptr var_438 = new_lv(VT_UNINIT);
var_438->v.pair.car = &(var_395[0]);
P_CLOS(var_400,1) = var_438;
lptr var_439 = new_lv(VT_UNINIT);
var_439->v.pair.car = &(var_395[1]);
P_CLOS(var_400,0) = var_439;
lval var_440;
lval var_441[8];
var_441[0] = var_395[2];
var_440 = fn_399(var_400, var_441);
*var_439 = var_395[1];
*var_438 = var_395[0];
var_397 = var_440;
} else {
lval var_443;
var_443 = LVI_NIL();
var_397 = var_443;
}
return var_397;
}
// end of function wile_eval_begin

// @@@ lambda (a1) @@@ bld-rtl-dir/wile-rtl2-000082.scm:178 @@@ fn_462 @@@
static lval fn_462(lptr* var_463, lptr var_464)
{
lval var_466;
var_466 = LVI_STRING("caddr");
lval var_467;
{
char* cp = strchr(var_466.v.str, 'r');
var_467 = var_464[0];
while (*(--cp) != 'c') {
if (var_467.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_467 = (var_467.v.pair.car ? *(var_467.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_467 = (var_467.v.pair.cdr ? *(var_467.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_466.v.str);
}
}
}
return var_467;
}
// end of lambda fn_462

// @@@ lambda (a1) @@@ bld-rtl-dir/wile-rtl2-000082.scm:178 @@@ fn_468 @@@
static lval fn_468(lptr* var_469, lptr var_470)
{
lval var_472;
var_472 = LVI_STRING("cadr");
lval var_473;
{
char* cp = strchr(var_472.v.str, 'r');
var_473 = var_470[0];
while (*(--cp) != 'c') {
if (var_473.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_473 = (var_473.v.pair.car ? *(var_473.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_473 = (var_473.v.pair.cdr ? *(var_473.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_472.v.str);
}
}
}
return var_473;
}
// end of lambda fn_468

// @@@ (eval-if env exprs) @@@ bld-rtl-dir/wile-rtl2-000082.scm:175 @@@ fn_13 @@@
static lval fn_13(lptr* var_444, lptr var_445)
{
lval var_447;
lval var_448;
var_448 = LVI_INT(3);
lval var_449;
{
lval var_450[8];
var_450[0] = var_448;
var_450[1] = var_445[1];
var_449 = wile_list_length_eq(NULL, var_450);
}
if (LV_IS_FALSE(var_449)) {
lval var_451;
var_451 = LVI_STRING("malformed \'if\' expression \'%v\'");
lval var_454[8];
var_454[0] = var_451;
lval var_455[8];
var_455[0] = var_445[1];
var_445[1] = wile_gen_list(1, var_455, NULL);
var_445[0] = var_454[0];
TAIL_CALL fn_7(NULL, var_445);
} else {
lval var_456;
lval var_457;
if (var_445[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_457 = (var_445[1].v.pair.car ? *(var_445[1].v.pair.car) : LVI_NIL());
lval var_458;
lval var_459[8];
var_459[0] = var_445[0];
var_459[1] = var_457;
var_458 = wile_eval(NULL, var_459);
var_456 = var_458;
lval var_461;
if (LV_IS_FALSE(var_456)) {
MK_CLOS(var_463,0);
var_461 = LVI_PROC(fn_462,var_463,1);
} else {
MK_CLOS(var_469,0);
var_461 = LVI_PROC(fn_468,var_469,1);
}
lval var_474;
{
lval var_475[1];
var_475[0] = var_445[1];
var_474 = wile_gen_list(1, var_475, NULL);
}
lval var_476;
{
lval var_477[2];
var_477[0] = var_461;
var_477[1] = var_474;
var_476 = wile_gen_list(2, var_477, NULL);
}
var_476 = wile_apply_function(&(var_476), __FILE__, __LINE__);
lval var_480[8];
var_480[0] = var_445[0];
var_480[1] = var_476;
var_445[0] = var_480[0];
var_445[1] = var_480[1];
TAIL_CALL wile_eval(NULL, var_445);
}
return var_447;
}
// end of function fn_13

// @@@ (eval-and init env exprs) @@@ bld-rtl-dir/wile-rtl2-000082.scm:181 @@@ fn_14 @@@
static lval fn_14(lptr* var_481, lptr var_482)
{
lbl_483:;
lval var_484;
do {
lval var_485;
var_485 = LVI_BOOL(LV_IS_FALSE(var_482[0]));
if (!LV_IS_FALSE(var_485)) {
var_484 = var_482[0];
break;
}
lval var_486;
var_486 = LVI_BOOL(var_482[2].vt == LV_NIL);
if (!LV_IS_FALSE(var_486)) {
var_484 = var_482[0];
break;
}
lval var_487;
if (var_482[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_487 = (var_482[2].v.pair.car ? *(var_482[2].v.pair.car) : LVI_NIL());
lval var_488;
lval var_489[8];
var_489[0] = var_482[1];
var_489[1] = var_487;
var_488 = wile_eval(NULL, var_489);
lval var_491;
if (var_482[2].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_491 = (var_482[2].v.pair.cdr ? *(var_482[2].v.pair.cdr) : LVI_NIL());
lval var_494[8];
var_494[0] = var_488;
var_494[1] = var_482[1];
var_494[2] = var_491;
var_482[0] = var_494[0];
var_482[1] = var_494[1];
var_482[2] = var_494[2];
goto lbl_483;	// selfie
} while (0);
return var_484;
}
// end of function fn_14

// @@@ (eval-or init env exprs) @@@ bld-rtl-dir/wile-rtl2-000082.scm:187 @@@ fn_15 @@@
static lval fn_15(lptr* var_495, lptr var_496)
{
lbl_497:;
lval var_498;
do {
if (!LV_IS_FALSE(var_496[0])) {
var_498 = var_496[0];
break;
}
lval var_499;
var_499 = LVI_BOOL(var_496[2].vt == LV_NIL);
if (!LV_IS_FALSE(var_499)) {
var_498 = var_496[0];
break;
}
lval var_500;
if (var_496[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_500 = (var_496[2].v.pair.car ? *(var_496[2].v.pair.car) : LVI_NIL());
lval var_501;
lval var_502[8];
var_502[0] = var_496[1];
var_502[1] = var_500;
var_501 = wile_eval(NULL, var_502);
lval var_504;
if (var_496[2].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_504 = (var_496[2].v.pair.cdr ? *(var_496[2].v.pair.cdr) : LVI_NIL());
lval var_507[8];
var_507[0] = var_501;
var_507[1] = var_496[1];
var_507[2] = var_504;
var_496[0] = var_507[0];
var_496[1] = var_507[1];
var_496[2] = var_507[2];
goto lbl_497;	// selfie
} while (0);
return var_498;
}
// end of function fn_15

// @@@ lambda (bv) @@@ bld-rtl-dir/wile-rtl2-000082.scm:198 @@@ fn_532 @@@
static lval fn_532(lptr* var_533, lptr var_534)
{
lval var_536;
lval var_537;
{
var_537 = var_534[0];
while (var_537.vt == LV_PAIR) {
var_537 = (var_537.v.pair.cdr ? *(var_537.v.pair.cdr) : LVI_NIL());
}
var_537 = LVI_BOOL(var_537.vt == LV_NIL);
}
if (LV_IS_FALSE(var_537)) {
lval var_538;
var_538 = LVI_STRING("malformed \'%s\' binding \'%v\' is not a list");
lval var_541[8];
var_541[0] = var_538;
lval var_542[8];
var_542[0] = V_CLOS(var_533,0);
var_542[1] = var_534[0];
var_534[1] = wile_gen_list(2, var_542, NULL);
var_534[0] = var_541[0];
TAIL_CALL fn_7(NULL, var_534);
} else {
lval var_543;
var_543 = LVI_BOOL(false);
var_536 = var_543;
}
return var_536;
}
// end of lambda fn_532

// @@@ car @@@ bld-rtl-dir/wile-rtl2-000082.scm:203 @@@ fn_548 @@@
static lval fn_548(lptr* var_549, lptr var_550)
{
lval var_552;
if (var_550[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_552 = (var_550[0].v.pair.car ? *(var_550[0].v.pair.car) : LVI_NIL());
return var_552;
}
// end of prim fn_548

// @@@ (check-let-bindings type llist) @@@ bld-rtl-dir/wile-rtl2-000082.scm:193 @@@ fn_16 @@@
static lval fn_16(lptr* var_508, lptr var_509)
{
lval var_511;
lval var_512;
var_512 = LVI_BOOL(true);
do {
lval var_513;
{
var_513 = var_509[1];
while (var_513.vt == LV_PAIR) {
var_513 = (var_513.v.pair.cdr ? *(var_513.v.pair.cdr) : LVI_NIL());
}
var_513 = LVI_BOOL(var_513.vt == LV_NIL);
}
var_512 = var_513;
if (LV_IS_FALSE(var_512)) { break; }
lval var_514;
var_514 = LVI_INT(2);
lval var_515;
{
lval var_516[8];
var_516[0] = var_514;
var_516[1] = var_509[1];
var_515 = wile_list_length_ge(NULL, var_516);
}
var_512 = var_515;
if (LV_IS_FALSE(var_512)) { break; }
} while (0);
if (LV_IS_FALSE(var_512)) {
lval var_517;
var_517 = LVI_STRING("malformed \'%s\' expression \'%v\'");
lval var_520[8];
var_520[0] = var_517;
lval var_521[8];
var_521[0] = var_509[0];
var_521[1] = var_509[1];
var_509[1] = wile_gen_list(2, var_521, NULL);
var_509[0] = var_520[0];
TAIL_CALL fn_7(NULL, var_509);
} else {
lval var_522;
lval var_523;
if (var_509[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_523 = (var_509[1].v.pair.car ? *(var_509[1].v.pair.car) : LVI_NIL());
var_522 = var_523;
lval var_525;
{
var_525 = var_522;
while (var_525.vt == LV_PAIR) {
var_525 = (var_525.v.pair.cdr ? *(var_525.v.pair.cdr) : LVI_NIL());
}
var_525 = LVI_BOOL(var_525.vt == LV_NIL);
}
if (LV_IS_FALSE(var_525)) {
lval var_526;
var_526 = LVI_STRING("malformed \'%s\' bindings \'%v\' are not a list");
lval var_528[8];
var_528[0] = var_526;
lval var_530[8];
var_530[0] = var_509[0];
var_530[1] = var_522;
var_528[1] = wile_gen_list(2, var_530, NULL);
(void)
 fn_7(NULL, var_528);
} else {
(void)
 LVI_BOOL(false);
}
MK_CLOS(var_533,1);
lptr var_544 = new_lv(VT_UNINIT);
var_544->v.pair.car = &(var_509[0]);
P_CLOS(var_533,0) = var_544;
lval var_545;
var_545 = LVI_NIL();
{
lval var_546[8];
var_546[0] = LVI_PROC(fn_532,var_533,1);
var_546[1] = var_522;
var_546[2] = var_545;
var_545 = wile_for_each(NULL, var_546);
}
lval var_547;
lval var_553;
var_553 = LVI_NIL();
{
lval var_554[8];
var_554[0] = LVI_PROC(fn_548,NULL,1);
var_554[1] = var_522;
var_554[2] = var_553;
var_553 = wile_map(NULL, var_554);
}
var_547 = var_553;
lval var_555;
lval var_556;
lval var_557[8];
var_557[0] = var_547;
var_556 = fn_10(NULL, var_557);
if (LV_IS_FALSE(var_556)) {
lval var_559;
var_559 = LVI_STRING("malformed \'%s\' bindings list \'%v\'");
lval var_562[8];
var_562[0] = var_559;
lval var_563[8];
var_563[0] = var_509[0];
var_563[1] = var_547;
var_509[1] = wile_gen_list(2, var_563, NULL);
var_509[0] = var_562[0];
TAIL_CALL fn_7(NULL, var_509);
} else {
lval var_564;
var_564 = LVI_BOOL(false);
var_555 = var_564;
}
*var_544 = var_509[0];
var_511 = var_555;
}
return var_511;
}
// end of function fn_16

// @@@ car @@@ bld-rtl-dir/wile-rtl2-000082.scm:213 @@@ fn_585 @@@
static lval fn_585(lptr* var_586, lptr var_587)
{
lval var_589;
if (var_587[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_589 = (var_587[0].v.pair.car ? *(var_587[0].v.pair.car) : LVI_NIL());
return var_589;
}
// end of prim fn_585

// @@@ lambda (v) @@@ bld-rtl-dir/wile-rtl2-000082.scm:214 @@@ fn_595 @@@
static lval fn_595(lptr* var_596, lptr var_597)
{
lval var_599;
var_599 = LVI_STRING("cadr");
lval var_600;
{
char* cp = strchr(var_599.v.str, 'r');
var_600 = var_597[0];
while (*(--cp) != 'c') {
if (var_600.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_600 = (var_600.v.pair.car ? *(var_600.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_600 = (var_600.v.pair.cdr ? *(var_600.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_599.v.str);
}
}
}
lval var_603[8];
var_603[0] = V_CLOS(var_596,0);
var_603[1] = var_600;
var_597[0] = var_603[0];
var_597[1] = var_603[1];
TAIL_CALL wile_eval(NULL, var_597);
}
// end of lambda fn_595

// @@@ lambda (iex) @@@ bld-rtl-dir/wile-rtl2-000082.scm:223 @@@ fn_642 @@@
static lval fn_642(lptr* var_643, lptr var_644)
{
lval var_646;
lval var_647;
lval var_648[8];
var_648[0] = V_CLOS(var_643,0);
var_648[1] = var_644[0];
var_647 = fn_12(NULL, var_648);
var_646 = var_647;
if (LV_IS_FALSE(V_CLOS(var_643,1))) {
(void)
 LVI_BOOL(false);
} else {
lval var_652;
{
lptr p1 = NULL, p2 = NULL;
if (var_646.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_646;
}
if (V_CLOS(var_643,0).vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = V_CLOS(var_643,0);
}
var_652 = LVI_PAIR(p1, p2);
}
V_CLOS(var_643,0) = var_652;
(void)
 V_CLOS(var_643,0);
}
return var_646;
}
// end of lambda fn_642

// @@@ lambda (box) @@@ bld-rtl-dir/wile-rtl2-000082.scm:231 @@@ fn_667 @@@
static lval fn_667(lptr* var_668, lptr var_669)
{
lval var_671;
lval var_672;
lval var_673[8];
var_673[0] = var_669[0];
var_672 = fn_4(NULL, var_673);
var_671 = var_672;
lval var_675;
lval var_676;
var_676 = LVI_BOOL(var_671.vt == LV_ILAMBDA);
if (LV_IS_FALSE(var_676)) {
lval var_677;
var_677 = LVI_BOOL(false);
var_675 = var_677;
} else {
lval var_678;
if (var_671.vt == LV_ILAMBDA && V_CLOS(var_668,0).vt == LV_PAIR) {
var_671.v.ilambda->env = V_CLOS(var_668,0);
var_678 = var_671;
} else {
WILE_EX("set-interpreted-procedure-environment!", "expects an interpreted procedure and an environment list");
}
var_675 = var_678;
}
return var_675;
}
// end of lambda fn_667

// @@@ (eval-let rec? star? env exprs) @@@ bld-rtl-dir/wile-rtl2-000082.scm:208 @@@ fn_17 @@@
static lval fn_17(lptr* var_565, lptr var_566)
{
lval var_568;
do {
lval var_569;
var_569 = LVI_BOOL(var_566[3].vt == LV_NIL);
if (!LV_IS_FALSE(var_569)) {
lval var_570;
var_570 = LVI_STRING("malformed \'let\' expression \'%v\'");
lval var_573[8];
var_573[0] = var_570;
lval var_574[8];
var_574[0] = var_566[3];
var_566[1] = wile_gen_list(1, var_574, NULL);
var_566[0] = var_573[0];
TAIL_CALL fn_7(NULL, var_566);
}
lval var_575;
var_575 = LVI_BOOL(true);
do {
lval var_576;
{
var_576 = var_566[3];
while (var_576.vt == LV_PAIR) {
var_576 = (var_576.v.pair.cdr ? *(var_576.v.pair.cdr) : LVI_NIL());
}
var_576 = LVI_BOOL(var_576.vt == LV_NIL);
}
var_575 = var_576;
if (LV_IS_FALSE(var_575)) { break; }
lval var_577;
if (var_566[3].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_577 = (var_566[3].v.pair.car ? *(var_566[3].v.pair.car) : LVI_NIL());
lval var_578;
var_578 = LVI_BOOL(var_577.vt == LV_SYMBOL);
var_575 = var_578;
if (LV_IS_FALSE(var_575)) { break; }
} while (0);
if (!LV_IS_FALSE(var_575)) {
lval var_579;
var_579 = LVI_STRING("named-let");
lval var_580;
if (var_566[3].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_580 = (var_566[3].v.pair.cdr ? *(var_566[3].v.pair.cdr) : LVI_NIL());
lval var_582[8];
var_582[0] = var_579;
var_582[1] = var_580;
(void)
 fn_16(NULL, var_582);
lval var_584;
lval var_590;
var_590 = LVI_STRING("cadr");
lval var_591;
{
char* cp = strchr(var_590.v.str, 'r');
var_591 = var_566[3];
while (*(--cp) != 'c') {
if (var_591.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_591 = (var_591.v.pair.car ? *(var_591.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_591 = (var_591.v.pair.cdr ? *(var_591.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_590.v.str);
}
}
}
lval var_592;
var_592 = LVI_NIL();
{
lval var_593[8];
var_593[0] = LVI_PROC(fn_585,NULL,1);
var_593[1] = var_591;
var_593[2] = var_592;
var_592 = wile_map(NULL, var_593);
}
var_584 = var_592;
lval var_594;
MK_CLOS(var_596,1);
lptr var_604 = new_lv(VT_UNINIT);
var_604->v.pair.car = &(var_566[2]);
P_CLOS(var_596,0) = var_604;
lval var_605;
var_605 = LVI_STRING("cadr");
lval var_606;
{
char* cp = strchr(var_605.v.str, 'r');
var_606 = var_566[3];
while (*(--cp) != 'c') {
if (var_606.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_606 = (var_606.v.pair.car ? *(var_606.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_606 = (var_606.v.pair.cdr ? *(var_606.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_605.v.str);
}
}
}
lval var_607;
var_607 = LVI_NIL();
{
lval var_608[8];
var_608[0] = LVI_PROC(fn_595,var_596,1);
var_608[1] = var_606;
var_608[2] = var_607;
var_607 = wile_map(NULL, var_608);
}
var_594 = var_607;
lval var_609;
lval var_610;
{
lval var_611[8];
var_611[0] = var_584;
var_610 = wile_list_length(NULL, var_611);
}
lval var_612;
var_612 = LVI_STRING("cddr");
lval var_613;
{
char* cp = strchr(var_612.v.str, 'r');
var_613 = var_566[3];
while (*(--cp) != 'c') {
if (var_613.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_613 = (var_613.v.pair.car ? *(var_613.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_613 = (var_613.v.pair.cdr ? *(var_613.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_612.v.str);
}
}
}
lval var_614;
var_614 = LVI_NIL();
lval var_615;
var_615 = LVI_BOOL(false);
lval var_616;
if ((var_584.vt == LV_PAIR || var_584.vt == LV_NIL) && var_610.vt == LV_INT &&(var_613.vt == LV_PAIR || var_613.vt == LV_NIL) &&(var_614.vt == LV_PAIR || var_614.vt == LV_NIL) && var_615.vt == LV_BOOL) {
var_616.vt = LV_ILAMBDA;
var_616.v.ilambda = LISP_ALLOC(lisp_ifunc_t, 1);
if (var_616.v.ilambda == NULL) {
WILE_EX("make-interpreted-procedure", "memory allocation failed!");
}
var_616.v.ilambda->args = var_584;
var_616.v.ilambda->arity = var_610.v.iv;
var_616.v.ilambda->body = var_613;
var_616.v.ilambda->env = var_614;
var_616.v.ilambda->macro = var_615.v.bv;
} else {
WILE_EX("make-interpreted-procedure", "expects a list of arguments, an integer arity, a list of body expressions, an environment list, and a macro boolean");
}
var_609 = var_616;
lval var_617;
lval var_618;
if (var_566[3].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_618 = (var_566[3].v.pair.car ? *(var_566[3].v.pair.car) : LVI_NIL());
lval var_619;
lval var_620[8];
var_620[0] = var_618;
var_620[1] = var_609;
var_619 = fn_1(NULL, var_620);
lval var_622;
{
lptr p1 = NULL, p2 = NULL;
if (var_619.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_619;
}
if (var_566[2].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_566[2];
}
var_622 = LVI_PAIR(p1, p2);
}
var_617 = var_622;
if (var_609.vt == LV_ILAMBDA && var_617.vt == LV_PAIR) {
var_609.v.ilambda->env = var_617;
} else {
WILE_EX("set-interpreted-procedure-environment!", "expects an interpreted procedure and an environment list");
}
lval var_626[8];
var_626[0] = var_609;
var_626[1] = var_594;
*var_604 = var_566[2];
var_566[0] = var_626[0];
var_566[1] = var_626[1];
TAIL_CALL wile_eval_apply_lambda(NULL, var_566);
}
lval var_627;
var_627 = LVI_STRING("let");
lval var_628;
if (LV_IS_FALSE(var_566[0])) {
lval var_629;
var_629 = LVI_STRING("");
var_628 = var_629;
} else {
lval var_630;
var_630 = LVI_STRING("rec");
var_628 = var_630;
}
lval var_631;
if (LV_IS_FALSE(var_566[1])) {
lval var_632;
var_632 = LVI_STRING("");
var_631 = var_632;
} else {
lval var_633;
var_633 = LVI_STRING("*");
var_631 = var_633;
}
lval var_634;
{
lval var_636[3];
var_636[0] = var_627;
var_636[1] = var_628;
var_636[2] = var_631;
var_634 = wile_gen_list(3, var_636, NULL);
}
{
lval var_635[8];
var_635[0] = var_634;
var_634 = wile_string_append(NULL, var_635);
}
lval var_638[8];
var_638[0] = var_634;
var_638[1] = var_566[3];
(void)
 fn_16(NULL, var_638);
lval var_640;
var_640 = var_566[2];
lval var_641;
MK_CLOS(var_643,2);
lptr var_653 = new_lv(VT_UNINIT);
var_653->v.pair.car = &(var_566[1]);
P_CLOS(var_643,1) = var_653;
lptr var_654 = new_lv(VT_UNINIT);
var_654->v.pair.car = &(var_640);
P_CLOS(var_643,0) = var_654;
lval var_655;
if (var_566[3].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_655 = (var_566[3].v.pair.car ? *(var_566[3].v.pair.car) : LVI_NIL());
lval var_656;
var_656 = LVI_NIL();
{
lval var_657[8];
var_657[0] = LVI_PROC(fn_642,var_643,1);
var_657[1] = var_655;
var_657[2] = var_656;
var_656 = wile_map(NULL, var_657);
}
var_641 = var_656;
if (LV_IS_FALSE(var_566[1])) {
lval var_659;
{
lval var_660[8];
var_660[0] = var_641;
var_659 = wile_list_reverse(NULL, var_660);
}
lval var_661;
{
lval var_663[2];
var_663[0] = var_659;
var_663[1] = var_566[2];
var_661 = wile_gen_list(2, var_663, NULL);
}
{
lval var_662[8];
var_662[0] = var_661;
var_661 = wile_list_append(NULL, var_662);
}
var_640 = var_661;
} else {
(void)
 LVI_BOOL(false);
}
if (LV_IS_FALSE(var_566[0])) {
(void)
 LVI_BOOL(false);
} else {
MK_CLOS(var_668,1);
lptr var_679 = new_lv(VT_UNINIT);
var_679->v.pair.car = &(var_640);
P_CLOS(var_668,0) = var_679;
lval var_680;
var_680 = LVI_NIL();
{
lval var_681[8];
var_681[0] = LVI_PROC(fn_667,var_668,1);
var_681[1] = var_641;
var_681[2] = var_680;
var_680 = wile_for_each(NULL, var_681);
}
*var_679 = var_640;
}
lval var_682;
var_682 = LVI_BOOL(false);
lval var_683;
if (var_566[3].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_683 = (var_566[3].v.pair.cdr ? *(var_566[3].v.pair.cdr) : LVI_NIL());
lval var_686[8];
var_686[0] = var_682;
var_686[1] = var_640;
var_686[2] = var_683;
*var_653 = var_566[1];
*var_654 = var_640;
var_566[0] = var_686[0];
var_566[1] = var_686[1];
var_566[2] = var_686[2];
TAIL_CALL wile_eval_begin(NULL, var_566);
} while (0);
return var_568;
}
// end of function fn_17

// @@@ (eval-qq-olist level env expr) @@@ bld-rtl-dir/wile-rtl2-000082.scm:238 @@@ fn_18 @@@
static lval fn_18(lptr* var_687, lptr var_688)
{
lval var_690;
lval var_691;
if (var_688[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_691 = (var_688[2].v.pair.car ? *(var_688[2].v.pair.car) : LVI_NIL());
lval var_692;
lval var_693[8];
var_693[0] = var_688[0];
var_693[1] = var_688[1];
var_693[2] = var_691;
var_692 = fn_19(NULL, var_693);
var_690 = var_692;
lval var_695;
lval var_696;
if (var_688[2].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_696 = (var_688[2].v.pair.cdr ? *(var_688[2].v.pair.cdr) : LVI_NIL());
lval var_697;
lval var_698[8];
var_698[0] = var_688[0];
var_698[1] = var_688[1];
var_698[2] = var_696;
var_697 = fn_19(NULL, var_698);
var_695 = var_697;
lval var_700;
lval var_701;
var_701 = LVI_BOOL(true);
do {
lval var_702;
if (var_688[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_702 = (var_688[2].v.pair.car ? *(var_688[2].v.pair.car) : LVI_NIL());
lval var_703;
var_703 = LVI_BOOL(var_702.vt == LV_PAIR);
var_701 = var_703;
if (LV_IS_FALSE(var_701)) { break; }
lval var_704;
var_704 = LVI_STRING("caar");
lval var_705;
{
char* cp = strchr(var_704.v.str, 'r');
var_705 = var_688[2];
while (*(--cp) != 'c') {
if (var_705.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_705 = (var_705.v.pair.car ? *(var_705.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_705 = (var_705.v.pair.cdr ? *(var_705.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_704.v.str);
}
}
}
lval var_706;
var_706 = LVI_BOOL(var_705.vt == LV_SYMBOL);
var_701 = var_706;
if (LV_IS_FALSE(var_701)) { break; }
lval var_707;
var_707 = LVI_STRING("caar");
lval var_708;
{
char* cp = strchr(var_707.v.str, 'r');
var_708 = var_688[2];
while (*(--cp) != 'c') {
if (var_708.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_708 = (var_708.v.pair.car ? *(var_708.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_708 = (var_708.v.pair.cdr ? *(var_708.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_707.v.str);
}
}
}
lval var_709;
var_709 = LVI_SYMBOL("unquote-splicing");
lval var_710;
var_710 = LVI_BOOL(strcmp(var_708.v.str, var_709.v.str) == 0);
var_701 = var_710;
if (LV_IS_FALSE(var_701)) { break; }
} while (0);
var_700 = var_701;
lval var_711;
if (LV_IS_FALSE(var_700)) {
lval var_712;
{
lptr p1 = NULL, p2 = NULL;
if (var_690.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_690;
}
if (var_695.vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_695;
}
var_712 = LVI_PAIR(p1, p2);
}
var_711 = var_712;
} else {
lval var_713;
{
lval var_715[2];
var_715[0] = var_690;
var_715[1] = var_695;
var_713 = wile_gen_list(2, var_715, NULL);
}
{
lval var_714[8];
var_714[0] = var_713;
var_713 = wile_list_append(NULL, var_714);
}
var_711 = var_713;
}
return var_711;
}
// end of function fn_18

// @@@ (eval-qq level env expr) @@@ bld-rtl-dir/wile-rtl2-000082.scm:246 @@@ fn_19 @@@
static lval fn_19(lptr* var_716, lptr var_717)
{
lval var_719;
do {
lval var_720;
lval var_721[8];
var_721[0] = var_717[2];
var_720 = fn_8(NULL, var_721);
if (!LV_IS_FALSE(var_720)) {
var_719 = var_717[2];
break;
}
lval var_723;
var_723 = LVI_BOOL(var_717[2].vt == LV_SYMBOL);
if (!LV_IS_FALSE(var_723)) {
lval var_724;
lval var_725;
switch (var_717[0].vt) {
case LV_REAL:
var_725 = LVI_BOOL(var_717[0].v.rv > 0.0);
break;
case LV_RAT:
var_725 = LVI_BOOL((var_717[0].v.irv.num > 0 && var_717[0].v.irv.den >= 0) || (var_717[0].v.irv.num < 0 && var_717[0].v.irv.den < 0));
break;
case LV_INT:
var_725 = LVI_BOOL(var_717[0].v.iv > 0);
break;
default:
WILE_EX("positive?", "expects a real-valued number");
}
if (LV_IS_FALSE(var_725)) {
lval var_726;
var_726 = LVI_BOOL(false);
lval var_729[8];
var_729[0] = var_726;
var_729[1] = var_717[1];
var_729[2] = var_717[2];
var_717[0] = var_729[0];
var_717[1] = var_729[1];
var_717[2] = var_729[2];
TAIL_CALL fn_11(NULL, var_717);
} else {
var_724 = var_717[2];
}
var_719 = var_724;
break;
}
lval var_730;
var_730 = LVI_BOOL(var_717[2].vt == LV_PAIR);
if (!LV_IS_FALSE(var_730)) {
lval var_731;
lval var_732;
if (var_717[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_732 = (var_717[2].v.pair.car ? *(var_717[2].v.pair.car) : LVI_NIL());
lval var_733;
var_733 = LVI_BOOL(var_732.vt == LV_SYMBOL);
if (LV_IS_FALSE(var_733)) {
lval var_736[8];
var_736[0] = var_717[0];
var_736[1] = var_717[1];
var_736[2] = var_717[2];
var_717[0] = var_736[0];
var_717[1] = var_736[1];
var_717[2] = var_736[2];
TAIL_CALL fn_18(NULL, var_717);
} else {
lval var_737;
do {
lval var_738;
var_738 = LVI_BOOL(false);
do {
lval var_739;
if (var_717[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_739 = (var_717[2].v.pair.car ? *(var_717[2].v.pair.car) : LVI_NIL());
lval var_740;
var_740 = LVI_SYMBOL("unquote");
lval var_741;
var_741 = LVI_BOOL(strcmp(var_739.v.str, var_740.v.str) == 0);
var_738 = var_741;
if (!LV_IS_FALSE(var_738)) { break; }
lval var_742;
if (var_717[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_742 = (var_717[2].v.pair.car ? *(var_717[2].v.pair.car) : LVI_NIL());
lval var_743;
var_743 = LVI_SYMBOL("unquote-splicing");
lval var_744;
var_744 = LVI_BOOL(strcmp(var_742.v.str, var_743.v.str) == 0);
var_738 = var_744;
if (!LV_IS_FALSE(var_738)) { break; }
} while (0);
if (!LV_IS_FALSE(var_738)) {
lval var_745;
lval var_746;
var_746 = LVI_INT(1);
lval var_747;
switch (TYPE_COMBO(var_717[0].vt,var_746.vt)) {
case TYPE_COMBO(LV_INT,LV_INT):
var_747 = LVI_BOOL(var_717[0].v.iv == var_746.v.iv);
break;
case TYPE_COMBO(LV_INT,LV_RAT):
var_747 = LVI_BOOL(var_717[0].v.iv * var_746.v.irv.den == var_746.v.irv.num);
break;
case TYPE_COMBO(LV_INT,LV_REAL):
var_747 = LVI_BOOL(var_717[0].v.iv == var_746.v.rv);
break;
case TYPE_COMBO(LV_RAT,LV_INT):
var_747 = LVI_BOOL(var_717[0].v.irv.num == var_746.v.iv * var_717[0].v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_RAT):
var_747 = LVI_BOOL(var_717[0].v.irv.num * var_746.v.irv.den == var_746.v.irv.num * var_717[0].v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_REAL):
var_747 = LVI_BOOL(var_717[0].v.irv.num == var_746.v.rv * var_717[0].v.irv.den);
break;
case TYPE_COMBO(LV_REAL,LV_INT):
var_747 = LVI_BOOL(var_717[0].v.rv == var_746.v.iv);
break;
case TYPE_COMBO(LV_REAL,LV_RAT):
var_747 = LVI_BOOL(var_717[0].v.rv * var_746.v.irv.den == var_746.v.irv.num);
break;
case TYPE_COMBO(LV_REAL,LV_REAL):
var_747 = LVI_BOOL(var_717[0].v.rv == var_746.v.rv);
break;
default:
WILE_EX("==", "inputs are not real-valued numbers");
break;
}
if (LV_IS_FALSE(var_747)) {
lval var_748;
var_748 = LVI_INT(1);
lval var_749;
{
lval var_751[2];
var_751[0] = var_717[0];
var_751[1] = var_748;
var_749 = wile_gen_list(2, var_751, NULL);
}
{
lval var_750[8];
var_750[0] = var_749;
var_749 = wile_subtract(NULL, var_750);
}
lval var_754[8];
var_754[0] = var_749;
var_754[1] = var_717[1];
var_754[2] = var_717[2];
var_717[0] = var_754[0];
var_717[1] = var_754[1];
var_717[2] = var_754[2];
TAIL_CALL fn_18(NULL, var_717);
} else {
lval var_755;
var_755 = LVI_STRING("cadr");
lval var_756;
{
char* cp = strchr(var_755.v.str, 'r');
var_756 = var_717[2];
while (*(--cp) != 'c') {
if (var_756.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_756 = (var_756.v.pair.car ? *(var_756.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_756 = (var_756.v.pair.cdr ? *(var_756.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_755.v.str);
}
}
}
lval var_759[8];
var_759[0] = var_717[1];
var_759[1] = var_756;
var_717[0] = var_759[0];
var_717[1] = var_759[1];
TAIL_CALL wile_eval(NULL, var_717);
}
var_737 = var_745;
break;
}
lval var_760;
if (var_717[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_760 = (var_717[2].v.pair.car ? *(var_717[2].v.pair.car) : LVI_NIL());
lval var_761;
var_761 = LVI_SYMBOL("quasiquote");
lval var_762;
var_762 = LVI_BOOL(strcmp(var_760.v.str, var_761.v.str) == 0);
if (!LV_IS_FALSE(var_762)) {
lval var_763;
var_763 = LVI_INT(1);
lval var_764;
{
lval var_766[2];
var_766[0] = var_717[0];
var_766[1] = var_763;
var_764 = wile_gen_list(2, var_766, NULL);
}
{
lval var_765[8];
var_765[0] = var_764;
var_764 = wile_add(NULL, var_765);
}
lval var_769[8];
var_769[0] = var_764;
var_769[1] = var_717[1];
var_769[2] = var_717[2];
var_717[0] = var_769[0];
var_717[1] = var_769[1];
var_717[2] = var_769[2];
TAIL_CALL fn_18(NULL, var_717);
}
lval var_772[8];
var_772[0] = var_717[0];
var_772[1] = var_717[1];
var_772[2] = var_717[2];
var_717[0] = var_772[0];
var_717[1] = var_772[1];
var_717[2] = var_772[2];
TAIL_CALL fn_18(NULL, var_717);
} while (0);
var_731 = var_737;
}
var_719 = var_731;
break;
}
lval var_773;
var_773 = LVI_BOOL(var_717[2].vt == LV_VECTOR);
if (!LV_IS_FALSE(var_773)) {
lval var_774;
{
lval var_775[8];
var_775[0] = var_717[2];
var_774 = wile_vector2list(NULL, var_775);
}
lval var_776;
lval var_777[8];
var_777[0] = var_717[0];
var_777[1] = var_717[1];
var_777[2] = var_774;
var_776 = fn_18(NULL, var_777);
lval var_779;
{
lval var_780[8];
var_780[0] = var_776;
var_779 = wile_list2vector(NULL, var_780);
}
var_719 = var_779;
break;
}
lval var_781;
var_781 = LVI_STRING("malformed \'quasiquote\' expression \'%v\'");
lval var_784[8];
var_784[0] = var_781;
lval var_785[8];
var_785[0] = var_717[2];
var_717[1] = wile_gen_list(1, var_785, NULL);
var_717[0] = var_784[0];
TAIL_CALL fn_7(NULL, var_717);
} while (0);
return var_719;
}
// end of function fn_19

// @@@ (eval-cond env expr) @@@ bld-rtl-dir/wile-rtl2-000082.scm:282 @@@ fn_20 @@@
static lval fn_20(lptr* var_786, lptr var_787)
{
lbl_788:;
lval var_789;
do {
lval var_790;
var_790 = LVI_BOOL(var_787[1].vt == LV_NIL);
if (!LV_IS_FALSE(var_790)) {
lval var_791;
var_791 = LVI_BOOL(false);
var_789 = var_791;
break;
}
lval var_792;
if (var_787[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_792 = (var_787[1].v.pair.car ? *(var_787[1].v.pair.car) : LVI_NIL());
lval var_793;
var_793 = LVI_BOOL(var_792.vt == LV_PAIR);
if (!LV_IS_FALSE(var_793)) {
lval var_794;
lval var_795;
var_795 = LVI_STRING("caar");
lval var_796;
{
char* cp = strchr(var_795.v.str, 'r');
var_796 = var_787[1];
while (*(--cp) != 'c') {
if (var_796.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_796 = (var_796.v.pair.car ? *(var_796.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_796 = (var_796.v.pair.cdr ? *(var_796.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_795.v.str);
}
}
}
lval var_797;
lval var_798[8];
var_798[0] = var_787[0];
var_798[1] = var_796;
var_797 = wile_eval(NULL, var_798);
if (LV_IS_FALSE(var_797)) {
lval var_800;
if (var_787[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_800 = (var_787[1].v.pair.cdr ? *(var_787[1].v.pair.cdr) : LVI_NIL());
lval var_803[8];
var_803[0] = var_787[0];
var_803[1] = var_800;
var_787[0] = var_803[0];
var_787[1] = var_803[1];
goto lbl_788;	// selfie
} else {
lval var_804;
var_804 = LVI_BOOL(false);
lval var_805;
var_805 = LVI_STRING("cdar");
lval var_806;
{
char* cp = strchr(var_805.v.str, 'r');
var_806 = var_787[1];
while (*(--cp) != 'c') {
if (var_806.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_806 = (var_806.v.pair.car ? *(var_806.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_806 = (var_806.v.pair.cdr ? *(var_806.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_805.v.str);
}
}
}
lval var_809[8];
var_809[0] = var_804;
var_809[1] = var_787[0];
var_809[2] = var_806;
var_787[0] = var_809[0];
var_787[1] = var_809[1];
var_787[2] = var_809[2];
TAIL_CALL wile_eval_begin(NULL, var_787);
}
var_789 = var_794;
break;
}
lval var_810;
var_810 = LVI_STRING("malformed \'cond\' expression \'%v\'");
lval var_813[8];
var_813[0] = var_810;
lval var_814[8];
var_814[0] = var_787[1];
var_787[1] = wile_gen_list(1, var_814, NULL);
var_787[0] = var_813[0];
TAIL_CALL fn_7(NULL, var_787);
} while (0);
return var_789;
}
// end of function fn_20

// @@@ (eval-set! env expr) @@@ bld-rtl-dir/wile-rtl2-000082.scm:290 @@@ fn_21 @@@
static lval fn_21(lptr* var_815, lptr var_816)
{
lval var_818;
lval var_819;
var_819 = LVI_BOOL(true);
do {
lval var_820;
var_820 = LVI_BOOL(var_816[1].vt == LV_PAIR);
var_819 = var_820;
if (LV_IS_FALSE(var_819)) { break; }
lval var_821;
if (var_816[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_821 = (var_816[1].v.pair.car ? *(var_816[1].v.pair.car) : LVI_NIL());
lval var_822;
var_822 = LVI_BOOL(var_821.vt == LV_SYMBOL);
var_819 = var_822;
if (LV_IS_FALSE(var_819)) { break; }
lval var_823;
var_823 = LVI_INT(2);
lval var_824;
{
lval var_825[8];
var_825[0] = var_823;
var_825[1] = var_816[1];
var_824 = wile_list_length_eq(NULL, var_825);
}
var_819 = var_824;
if (LV_IS_FALSE(var_819)) { break; }
} while (0);
if (LV_IS_FALSE(var_819)) {
lval var_826;
var_826 = LVI_STRING("malformed \'set!\' expression \'%v\'");
lval var_829[8];
var_829[0] = var_826;
lval var_830[8];
var_830[0] = var_816[1];
var_816[1] = wile_gen_list(1, var_830, NULL);
var_816[0] = var_829[0];
TAIL_CALL fn_7(NULL, var_816);
} else {
lval var_831;
lval var_832;
var_832 = LVI_BOOL(true);
lval var_833;
if (var_816[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_833 = (var_816[1].v.pair.car ? *(var_816[1].v.pair.car) : LVI_NIL());
lval var_834;
lval var_835[8];
var_835[0] = var_832;
var_835[1] = var_816[0];
var_835[2] = var_833;
var_834 = fn_11(NULL, var_835);
var_831 = var_834;
lval var_837;
var_837 = LVI_STRING("cadr");
lval var_838;
{
char* cp = strchr(var_837.v.str, 'r');
var_838 = var_816[1];
while (*(--cp) != 'c') {
if (var_838.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_838 = (var_838.v.pair.car ? *(var_838.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_838 = (var_838.v.pair.cdr ? *(var_838.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_837.v.str);
}
}
}
lval var_839;
lval var_840[8];
var_840[0] = var_816[0];
var_840[1] = var_838;
var_839 = wile_eval(NULL, var_840);
lval var_843[8];
var_843[0] = var_831;
var_843[1] = var_839;
(void)
 fn_6(NULL, var_843);
lval var_847[8];
var_847[0] = var_831;
var_816[0] = var_847[0];
TAIL_CALL fn_4(NULL, var_816);
}
return var_818;
}
// end of function fn_21

// @@@ lambda (cs) @@@ bld-rtl-dir/wile-rtl2-000082.scm:305 @@@ fn_873 @@@
static lval fn_873(lptr* var_874, lptr var_875)
{
lbl_876:;
lval var_877;
do {
lval var_878;
var_878 = LVI_BOOL(var_875[0].vt == LV_NIL);
if (!LV_IS_FALSE(var_878)) {
lval var_879;
var_879 = LVI_BOOL(true);
V_CLOS(var_874,0) = var_879;
V_CLOS(var_874,1) = V_CLOS(var_874,2);
var_877 = V_CLOS(var_874,1);
break;
}
lval var_880;
var_880 = LVI_STRING("caar");
lval var_881;
{
char* cp = strchr(var_880.v.str, 'r');
var_881 = var_875[0];
while (*(--cp) != 'c') {
if (var_881.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_881 = (var_881.v.pair.car ? *(var_881.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_881 = (var_881.v.pair.cdr ? *(var_881.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_880.v.str);
}
}
}
lval var_882;
lval var_883[8];
var_883[0] = V_CLOS(var_874,3);
var_883[1] = var_881;
var_882 = wile_eval(NULL, var_883);
if (!LV_IS_FALSE(var_882)) {
lval var_885;
var_885 = LVI_BOOL(false);
lval var_886;
var_886 = LVI_STRING("cdar");
lval var_887;
{
char* cp = strchr(var_886.v.str, 'r');
var_887 = var_875[0];
while (*(--cp) != 'c') {
if (var_887.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_887 = (var_887.v.pair.car ? *(var_887.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_887 = (var_887.v.pair.cdr ? *(var_887.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_886.v.str);
}
}
}
lval var_890[8];
var_890[0] = var_885;
var_890[1] = V_CLOS(var_874,3);
var_890[2] = var_887;
var_875[0] = var_890[0];
var_875[1] = var_890[1];
var_875[2] = var_890[2];
TAIL_CALL wile_eval_begin(NULL, var_875);
}
lval var_891;
if (var_875[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_891 = (var_875[0].v.pair.cdr ? *(var_875[0].v.pair.cdr) : LVI_NIL());
lval var_894[8];
var_894[0] = var_891;
var_875[0] = var_894[0];
goto lbl_876;	// selfie
} while (0);
return var_877;
}
// end of lambda fn_873

// @@@ (eval-guard env expr) @@@ bld-rtl-dir/wile-rtl2-000082.scm:299 @@@ fn_22 @@@
static lval fn_22(lptr* var_848, lptr var_849)
{
lval var_851;
lval var_852;
var_852 = LVI_BOOL(false);
var_851 = var_852;
lval var_853;
lval var_854;
var_854 = LVI_BOOL(false);
var_853 = var_854;
lval var_855;
lval var_856;
{
struct lisp_escape_info var_858;
var_858.errval = NULL;
var_858.next = cachalot;
cachalot = &var_858;
if (setjmp(var_858.cenv) == 0) {
lval var_859;
var_859 = LVI_BOOL(false);
lval var_860;
if (var_849[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_860 = (var_849[1].v.pair.cdr ? *(var_849[1].v.pair.cdr) : LVI_NIL());
lval var_861;
lval var_862[8];
var_862[0] = var_859;
var_862[1] = var_849[0];
var_862[2] = var_860;
var_861 = wile_eval_begin(NULL, var_862);
var_856 = var_861;
cachalot = var_858.next;
} else {
lval var_857;
var_857 = (var_858.errval ? *(var_858.errval) : LVI_NIL());
lval var_864;
do {
lval var_865;
var_865 = LVI_BOOL(true);
if (!LV_IS_FALSE(var_865)) {
lval var_866;
lval var_867;
var_867 = LVI_STRING("caar");
lval var_868;
{
char* cp = strchr(var_867.v.str, 'r');
var_868 = var_849[1];
while (*(--cp) != 'c') {
if (var_868.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_868 = (var_868.v.pair.car ? *(var_868.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_868 = (var_868.v.pair.cdr ? *(var_868.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_867.v.str);
}
}
}
lval var_869;
lval var_870[8];
var_870[0] = var_868;
var_870[1] = var_857;
var_869 = fn_1(NULL, var_870);
lval var_872;
{
lptr p1 = NULL, p2 = NULL;
if (var_869.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_869;
}
if (var_849[0].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_849[0];
}
var_872 = LVI_PAIR(p1, p2);
}
var_866 = var_872;
MK_CLOS(var_874,4);
lptr var_895 = new_lv(VT_UNINIT);
var_895->v.pair.car = &(var_866);
P_CLOS(var_874,3) = var_895;
lptr var_896 = new_lv(VT_UNINIT);
var_896->v.pair.car = &(var_857);
P_CLOS(var_874,2) = var_896;
lptr var_897 = new_lv(VT_UNINIT);
var_897->v.pair.car = &(var_853);
P_CLOS(var_874,1) = var_897;
lptr var_898 = new_lv(VT_UNINIT);
var_898->v.pair.car = &(var_851);
P_CLOS(var_874,0) = var_898;
lval var_899;
var_899 = LVI_STRING("cdar");
lval var_900;
{
char* cp = strchr(var_899.v.str, 'r');
var_900 = var_849[1];
while (*(--cp) != 'c') {
if (var_900.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_900 = (var_900.v.pair.car ? *(var_900.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_900 = (var_900.v.pair.cdr ? *(var_900.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_899.v.str);
}
}
}
lval var_901;
lval var_902[8];
var_902[0] = var_900;
var_901 = fn_873(var_874, var_902);
*var_897 = var_853;
*var_898 = var_851;
*var_895 = var_866;
*var_896 = var_857;
var_864 = var_901;
break;
}
cachalot = var_858.next;
cachalot->errval = var_858.errval;
cachalot->l_whence = 0;
cachalot->c_whence = LISP_WHENCE;
fflush(NULL);
longjmp(cachalot->cenv, 1);
} while (0);
cachalot = var_858.next;
var_856 = var_864;
}
}
var_855 = var_856;
lval var_904;
if (LV_IS_FALSE(var_851)) {
var_904 = var_855;
} else {
lval var_905;
{
lval var_906[1];
var_906[0] = var_853;
var_905 = wile_gen_list(1, var_906, NULL);
}
if (var_905.vt == LV_PAIR && (var_905.v.pair.cdr == NULL || var_905.v.pair.cdr->vt == LV_NIL)) {
var_905 = (var_905.v.pair.car ? *(var_905.v.pair.car) : LVI_NIL());
}
cachalot->errval = new_lv(LV_NIL);
*(cachalot->errval) = var_905;
cachalot->l_whence = 0;
cachalot->c_whence = LISP_WHENCE;
longjmp(cachalot->cenv, 1);
var_904 = var_905;
}
return var_904;
}
// end of function fn_22

// @@@ lambda (cs) @@@ bld-rtl-dir/wile-rtl2-000082.scm:322 @@@ fn_926 @@@
static lval fn_926(lptr* var_927, lptr var_928)
{
lbl_929:;
lval var_930;
lval var_931;
var_931 = LVI_BOOL(var_928[0].vt == LV_NIL);
if (LV_IS_FALSE(var_931)) {
lval var_932;
lval var_933;
var_933 = LVI_BOOL(true);
do {
lval var_934;
if (var_928[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_934 = (var_928[0].v.pair.car ? *(var_928[0].v.pair.car) : LVI_NIL());
lval var_935;
{
var_935 = var_934;
while (var_935.vt == LV_PAIR) {
var_935 = (var_935.v.pair.cdr ? *(var_935.v.pair.cdr) : LVI_NIL());
}
var_935 = LVI_BOOL(var_935.vt == LV_NIL);
}
var_933 = var_935;
if (LV_IS_FALSE(var_933)) { break; }
lval var_936;
var_936 = LVI_BOOL(false);
do {
lval var_937;
var_937 = LVI_BOOL(true);
do {
lval var_938;
var_938 = LVI_STRING("caar");
lval var_939;
{
char* cp = strchr(var_938.v.str, 'r');
var_939 = var_928[0];
while (*(--cp) != 'c') {
if (var_939.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_939 = (var_939.v.pair.car ? *(var_939.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_939 = (var_939.v.pair.cdr ? *(var_939.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_938.v.str);
}
}
}
lval var_940;
{
var_940 = var_939;
while (var_940.vt == LV_PAIR) {
var_940 = (var_940.v.pair.cdr ? *(var_940.v.pair.cdr) : LVI_NIL());
}
var_940 = LVI_BOOL(var_940.vt == LV_NIL);
}
var_937 = var_940;
if (LV_IS_FALSE(var_937)) { break; }
lval var_941;
var_941 = LVI_STRING("caar");
lval var_942;
{
char* cp = strchr(var_941.v.str, 'r');
var_942 = var_928[0];
while (*(--cp) != 'c') {
if (var_942.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_942 = (var_942.v.pair.car ? *(var_942.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_942 = (var_942.v.pair.cdr ? *(var_942.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_941.v.str);
}
}
}
lval var_943;
var_943 = LVI_BOOL(var_942.vt == LV_NIL);
lval var_944;
var_944 = LVI_BOOL(LV_IS_FALSE(var_943));
var_937 = var_944;
if (LV_IS_FALSE(var_937)) { break; }
} while (0);
var_936 = var_937;
if (!LV_IS_FALSE(var_936)) { break; }
lval var_945;
var_945 = LVI_STRING("caar");
lval var_946;
{
char* cp = strchr(var_945.v.str, 'r');
var_946 = var_928[0];
while (*(--cp) != 'c') {
if (var_946.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_946 = (var_946.v.pair.car ? *(var_946.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_946 = (var_946.v.pair.cdr ? *(var_946.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_945.v.str);
}
}
}
lval var_947;
var_947 = LVI_SYMBOL("else");
lval var_948;
var_948 = LVI_BOOL(wile_do_eqv(&(var_946), &(var_947)));
var_936 = var_948;
if (!LV_IS_FALSE(var_936)) { break; }
} while (0);
var_933 = var_936;
if (LV_IS_FALSE(var_933)) { break; }
lval var_949;
var_949 = LVI_STRING("cdar");
lval var_950;
{
char* cp = strchr(var_949.v.str, 'r');
var_950 = var_928[0];
while (*(--cp) != 'c') {
if (var_950.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_950 = (var_950.v.pair.car ? *(var_950.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_950 = (var_950.v.pair.cdr ? *(var_950.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_949.v.str);
}
}
}
lval var_951;
var_951 = LVI_BOOL(var_950.vt == LV_NIL);
lval var_952;
var_952 = LVI_BOOL(LV_IS_FALSE(var_951));
var_933 = var_952;
if (LV_IS_FALSE(var_933)) { break; }
} while (0);
if (LV_IS_FALSE(var_933)) {
lval var_953;
var_953 = LVI_STRING("malformed \'case\' clause \'%v\'");
lval var_954;
if (var_928[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_954 = (var_928[0].v.pair.car ? *(var_928[0].v.pair.car) : LVI_NIL());
lval var_957[8];
var_957[0] = var_953;
lval var_958[8];
var_958[0] = var_954;
var_928[1] = wile_gen_list(1, var_958, NULL);
var_928[0] = var_957[0];
TAIL_CALL fn_7(NULL, var_928);
} else {
lval var_959;
lval var_960;
var_960 = LVI_BOOL(false);
do {
lval var_961;
var_961 = LVI_STRING("caar");
lval var_962;
{
char* cp = strchr(var_961.v.str, 'r');
var_962 = var_928[0];
while (*(--cp) != 'c') {
if (var_962.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_962 = (var_962.v.pair.car ? *(var_962.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_962 = (var_962.v.pair.cdr ? *(var_962.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_961.v.str);
}
}
}
lval var_963;
var_963 = LVI_SYMBOL("else");
lval var_964;
var_964 = LVI_BOOL(wile_do_eqv(&(var_962), &(var_963)));
var_960 = var_964;
if (!LV_IS_FALSE(var_960)) { break; }
lval var_965;
var_965 = LVI_STRING("caar");
lval var_966;
{
char* cp = strchr(var_965.v.str, 'r');
var_966 = var_928[0];
while (*(--cp) != 'c') {
if (var_966.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_966 = (var_966.v.pair.car ? *(var_966.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_966 = (var_966.v.pair.cdr ? *(var_966.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_965.v.str);
}
}
}
lval var_967;
{
lval var_968[8];
var_968[0] = V_CLOS(var_927,0);
var_968[1] = var_966;
var_967 = wile_memv(NULL, var_968);
}
var_960 = var_967;
if (!LV_IS_FALSE(var_960)) { break; }
} while (0);
if (LV_IS_FALSE(var_960)) {
lval var_969;
if (var_928[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_969 = (var_928[0].v.pair.cdr ? *(var_928[0].v.pair.cdr) : LVI_NIL());
lval var_972[8];
var_972[0] = var_969;
var_928[0] = var_972[0];
goto lbl_929;	// selfie
} else {
lval var_973;
var_973 = LVI_BOOL(false);
lval var_974;
var_974 = LVI_STRING("cdar");
lval var_975;
{
char* cp = strchr(var_974.v.str, 'r');
var_975 = var_928[0];
while (*(--cp) != 'c') {
if (var_975.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_975 = (var_975.v.pair.car ? *(var_975.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_975 = (var_975.v.pair.cdr ? *(var_975.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_974.v.str);
}
}
}
lval var_978[8];
var_978[0] = var_973;
var_978[1] = V_CLOS(var_927,1);
var_978[2] = var_975;
var_928[0] = var_978[0];
var_928[1] = var_978[1];
var_928[2] = var_978[2];
TAIL_CALL wile_eval_begin(NULL, var_928);
}
var_932 = var_959;
}
var_930 = var_932;
} else {
lval var_979;
var_979 = LVI_BOOL(false);
var_930 = var_979;
}
return var_930;
}
// end of lambda fn_926

// @@@ (eval-case env expr) @@@ bld-rtl-dir/wile-rtl2-000082.scm:319 @@@ fn_23 @@@
static lval fn_23(lptr* var_907, lptr var_908)
{
lval var_910;
lval var_911;
var_911 = LVI_BOOL(true);
do {
lval var_912;
{
var_912 = var_908[1];
while (var_912.vt == LV_PAIR) {
var_912 = (var_912.v.pair.cdr ? *(var_912.v.pair.cdr) : LVI_NIL());
}
var_912 = LVI_BOOL(var_912.vt == LV_NIL);
}
var_911 = var_912;
if (LV_IS_FALSE(var_911)) { break; }
lval var_913;
var_913 = LVI_INT(2);
lval var_914;
{
lval var_915[8];
var_915[0] = var_913;
var_915[1] = var_908[1];
var_914 = wile_list_length_ge(NULL, var_915);
}
var_911 = var_914;
if (LV_IS_FALSE(var_911)) { break; }
} while (0);
if (LV_IS_FALSE(var_911)) {
lval var_916;
var_916 = LVI_STRING("malformed \'case\' expression \'%v\'");
lval var_919[8];
var_919[0] = var_916;
lval var_920[8];
var_920[0] = var_908[1];
var_908[1] = wile_gen_list(1, var_920, NULL);
var_908[0] = var_919[0];
TAIL_CALL fn_7(NULL, var_908);
} else {
lval var_921;
lval var_922;
if (var_908[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_922 = (var_908[1].v.pair.car ? *(var_908[1].v.pair.car) : LVI_NIL());
lval var_923;
lval var_924[8];
var_924[0] = var_908[0];
var_924[1] = var_922;
var_923 = wile_eval(NULL, var_924);
var_921 = var_923;
MK_CLOS(var_927,2);
lptr var_980 = new_lv(VT_UNINIT);
var_980->v.pair.car = &(var_908[0]);
P_CLOS(var_927,1) = var_980;
lptr var_981 = new_lv(VT_UNINIT);
var_981->v.pair.car = &(var_921);
P_CLOS(var_927,0) = var_981;
lval var_982;
if (var_908[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_982 = (var_908[1].v.pair.cdr ? *(var_908[1].v.pair.cdr) : LVI_NIL());
lval var_983;
lval var_984[8];
var_984[0] = var_982;
var_983 = fn_926(var_927, var_984);
*var_980 = var_908[0];
*var_981 = var_921;
var_910 = var_983;
}
return var_910;
}
// end of function fn_23

// @@@ lambda (as pl na) @@@ bld-rtl-dir/wile-rtl2-000082.scm:348 @@@ fn_989 @@@
static lval fn_989(lptr* var_990, lptr var_991)
{
lbl_992:;
lval var_993;
do {
lval var_994;
var_994 = LVI_BOOL(var_991[0].vt == LV_NIL);
if (!LV_IS_FALSE(var_994)) {
lval var_995;
{
lval var_996[8];
var_996[0] = var_991[1];
var_995 = wile_list_reverse(NULL, var_996);
}
lval var_997;
{
lval var_998[2];
var_998[0] = var_991[2];
var_998[1] = var_995;
var_997 = wile_gen_list(2, var_998, NULL);
}
var_993 = var_997;
break;
}
lval var_999;
var_999 = LVI_BOOL(var_991[0].vt == LV_PAIR);
if (!LV_IS_FALSE(var_999)) {
lval var_1000;
if (var_991[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1000 = (var_991[0].v.pair.cdr ? *(var_991[0].v.pair.cdr) : LVI_NIL());
lval var_1001;
if (var_991[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1001 = (var_991[0].v.pair.car ? *(var_991[0].v.pair.car) : LVI_NIL());
lval var_1002;
{
lptr p1 = NULL, p2 = NULL;
if (var_1001.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_1001;
}
if (var_991[1].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_991[1];
}
var_1002 = LVI_PAIR(p1, p2);
}
lval var_1003;
var_1003 = LVI_INT(1);
lval var_1004;
{
lval var_1006[2];
var_1006[0] = var_991[2];
var_1006[1] = var_1003;
var_1004 = wile_gen_list(2, var_1006, NULL);
}
{
lval var_1005[8];
var_1005[0] = var_1004;
var_1004 = wile_add(NULL, var_1005);
}
lval var_1009[8];
var_1009[0] = var_1000;
var_1009[1] = var_1002;
var_1009[2] = var_1004;
var_991[0] = var_1009[0];
var_991[1] = var_1009[1];
var_991[2] = var_1009[2];
goto lbl_992;	// selfie
}
lval var_1010;
{
lval var_1012[1];
var_1012[0] = var_991[2];
var_1010 = wile_gen_list(1, var_1012, NULL);
}
{
lval var_1011[8];
var_1011[0] = var_1010;
var_1010 = wile_subtract(NULL, var_1011);
}
lval var_1013;
var_1013 = LVI_INT(1);
lval var_1014;
{
lval var_1016[2];
var_1016[0] = var_1010;
var_1016[1] = var_1013;
var_1014 = wile_gen_list(2, var_1016, NULL);
}
{
lval var_1015[8];
var_1015[0] = var_1014;
var_1014 = wile_subtract(NULL, var_1015);
}
lval var_1017;
{
lptr p1 = NULL, p2 = NULL;
if (var_991[0].vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_991[0];
}
if (var_991[1].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_991[1];
}
var_1017 = LVI_PAIR(p1, p2);
}
lval var_1018;
{
lval var_1019[8];
var_1019[0] = var_1017;
var_1018 = wile_list_reverse(NULL, var_1019);
}
lval var_1020;
{
lval var_1021[2];
var_1021[0] = var_1014;
var_1021[1] = var_1018;
var_1020 = wile_gen_list(2, var_1021, NULL);
}
var_993 = var_1020;
} while (0);
return var_993;
}
// end of lambda fn_989

// @@@ (args-list dotted-list) @@@ bld-rtl-dir/wile-rtl2-000082.scm:347 @@@ fn_24 @@@
static lval fn_24(lptr* var_986, lptr var_987)
{
MK_CLOS(var_990,0);
lval var_1022;
var_1022 = LVI_NIL();
lval var_1023;
var_1023 = LVI_INT(0);
lval var_1024;
lval var_1025[8];
var_1025[0] = var_987[0];
var_1025[1] = var_1022;
var_1025[2] = var_1023;
var_1024 = fn_989(var_990, var_1025);
return var_1024;
}
// end of function fn_24

// @@@ (eval-lambda env expr) @@@ bld-rtl-dir/wile-rtl2-000082.scm:355 @@@ fn_25 @@@
static lval fn_25(lptr* var_1027, lptr var_1028)
{
lval var_1030;
lval var_1031;
if (var_1028[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1031 = (var_1028[1].v.pair.car ? *(var_1028[1].v.pair.car) : LVI_NIL());
var_1030 = var_1031;
lval var_1032;
lval var_1033;
lval var_1034[8];
var_1034[0] = var_1030;
var_1033 = fn_24(NULL, var_1034);
var_1032 = var_1033;
lval var_1036;
lval var_1037;
if (var_1032.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1037 = (var_1032.v.pair.car ? *(var_1032.v.pair.car) : LVI_NIL());
var_1036 = var_1037;
lval var_1038;
lval var_1039;
var_1039 = LVI_STRING("cadr");
lval var_1040;
{
char* cp = strchr(var_1039.v.str, 'r');
var_1040 = var_1032;
while (*(--cp) != 'c') {
if (var_1040.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_1040 = (var_1040.v.pair.car ? *(var_1040.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_1040 = (var_1040.v.pair.cdr ? *(var_1040.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_1039.v.str);
}
}
}
var_1038 = var_1040;
lval var_1042;
lval var_1043[8];
var_1043[0] = var_1038;
var_1042 = fn_10(NULL, var_1043);
if (LV_IS_FALSE(var_1042)) {
lval var_1045;
var_1045 = LVI_STRING("malformed \'lambda\' args list \'%v\'");
lval var_1047[8];
var_1047[0] = var_1045;
lval var_1049[8];
var_1049[0] = var_1030;
var_1047[1] = wile_gen_list(1, var_1049, NULL);
(void)
 fn_7(NULL, var_1047);
} else {
(void)
 LVI_BOOL(false);
}
lval var_1051;
if (var_1028[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1051 = (var_1028[1].v.pair.cdr ? *(var_1028[1].v.pair.cdr) : LVI_NIL());
lval var_1052;
var_1052 = LVI_BOOL(false);
lval var_1053;
if ((var_1038.vt == LV_PAIR || var_1038.vt == LV_NIL) && var_1036.vt == LV_INT &&(var_1051.vt == LV_PAIR || var_1051.vt == LV_NIL) &&(var_1028[0].vt == LV_PAIR || var_1028[0].vt == LV_NIL) && var_1052.vt == LV_BOOL) {
var_1053.vt = LV_ILAMBDA;
var_1053.v.ilambda = LISP_ALLOC(lisp_ifunc_t, 1);
if (var_1053.v.ilambda == NULL) {
WILE_EX("make-interpreted-procedure", "memory allocation failed!");
}
var_1053.v.ilambda->args = var_1038;
var_1053.v.ilambda->arity = var_1036.v.iv;
var_1053.v.ilambda->body = var_1051;
var_1053.v.ilambda->env = var_1028[0];
var_1053.v.ilambda->macro = var_1052.v.bv;
} else {
WILE_EX("make-interpreted-procedure", "expects a list of arguments, an integer arity, a list of body expressions, an environment list, and a macro boolean");
}
return var_1053;
}
// end of function fn_25

// @@@ (check-syntax-do expr) @@@ bld-rtl-dir/wile-rtl2-000082.scm:364 @@@ fn_26 @@@
static lval fn_26(lptr* var_1054, lptr var_1055)
{
lval var_1057;
var_1057 = LVI_BOOL(true);
do {
lval var_1058;
{
var_1058 = var_1055[0];
while (var_1058.vt == LV_PAIR) {
var_1058 = (var_1058.v.pair.cdr ? *(var_1058.v.pair.cdr) : LVI_NIL());
}
var_1058 = LVI_BOOL(var_1058.vt == LV_NIL);
}
var_1057 = var_1058;
if (LV_IS_FALSE(var_1057)) { break; }
lval var_1059;
var_1059 = LVI_INT(2);
lval var_1060;
{
lval var_1061[8];
var_1061[0] = var_1059;
var_1061[1] = var_1055[0];
var_1060 = wile_list_length_ge(NULL, var_1061);
}
var_1057 = var_1060;
if (LV_IS_FALSE(var_1057)) { break; }
lval var_1062;
if (var_1055[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1062 = (var_1055[0].v.pair.car ? *(var_1055[0].v.pair.car) : LVI_NIL());
lval var_1063;
{
var_1063 = var_1062;
while (var_1063.vt == LV_PAIR) {
var_1063 = (var_1063.v.pair.cdr ? *(var_1063.v.pair.cdr) : LVI_NIL());
}
var_1063 = LVI_BOOL(var_1063.vt == LV_NIL);
}
var_1057 = var_1063;
if (LV_IS_FALSE(var_1057)) { break; }
lval var_1064;
var_1064 = LVI_STRING("cadr");
lval var_1065;
{
char* cp = strchr(var_1064.v.str, 'r');
var_1065 = var_1055[0];
while (*(--cp) != 'c') {
if (var_1065.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_1065 = (var_1065.v.pair.car ? *(var_1065.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_1065 = (var_1065.v.pair.cdr ? *(var_1065.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_1064.v.str);
}
}
}
lval var_1066;
{
var_1066 = var_1065;
while (var_1066.vt == LV_PAIR) {
var_1066 = (var_1066.v.pair.cdr ? *(var_1066.v.pair.cdr) : LVI_NIL());
}
var_1066 = LVI_BOOL(var_1066.vt == LV_NIL);
}
var_1057 = var_1066;
if (LV_IS_FALSE(var_1057)) { break; }
lval var_1067;
var_1067 = LVI_INT(0);
lval var_1068;
var_1068 = LVI_STRING("cadr");
lval var_1069;
{
char* cp = strchr(var_1068.v.str, 'r');
var_1069 = var_1055[0];
while (*(--cp) != 'c') {
if (var_1069.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_1069 = (var_1069.v.pair.car ? *(var_1069.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_1069 = (var_1069.v.pair.cdr ? *(var_1069.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_1068.v.str);
}
}
}
lval var_1070;
{
lval var_1071[8];
var_1071[0] = var_1067;
var_1071[1] = var_1069;
var_1070 = wile_list_length_gt(NULL, var_1071);
}
var_1057 = var_1070;
if (LV_IS_FALSE(var_1057)) { break; }
} while (0);
return var_1057;
}
// end of function fn_26

// @@@ lambda (vdef) @@@ bld-rtl-dir/wile-rtl2-000082.scm:376 @@@ fn_1092 @@@
static lval fn_1092(lptr* var_1093, lptr var_1094)
{
lval var_1096;
lval var_1097;
var_1097 = LVI_BOOL(true);
do {
lval var_1098;
{
var_1098 = var_1094[0];
while (var_1098.vt == LV_PAIR) {
var_1098 = (var_1098.v.pair.cdr ? *(var_1098.v.pair.cdr) : LVI_NIL());
}
var_1098 = LVI_BOOL(var_1098.vt == LV_NIL);
}
var_1097 = var_1098;
if (LV_IS_FALSE(var_1097)) { break; }
lval var_1099;
var_1099 = LVI_INT(2);
lval var_1100;
{
lval var_1101[8];
var_1101[0] = var_1099;
var_1101[1] = var_1094[0];
var_1100 = wile_list_length_ge(NULL, var_1101);
}
var_1097 = var_1100;
if (LV_IS_FALSE(var_1097)) { break; }
lval var_1102;
if (var_1094[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1102 = (var_1094[0].v.pair.car ? *(var_1094[0].v.pair.car) : LVI_NIL());
lval var_1103;
var_1103 = LVI_BOOL(var_1102.vt == LV_SYMBOL);
var_1097 = var_1103;
if (LV_IS_FALSE(var_1097)) { break; }
} while (0);
if (LV_IS_FALSE(var_1097)) {
lval var_1104;
var_1104 = LVI_STRING("malformed \'do\' variable-expr \'%v\'");
lval var_1107[8];
var_1107[0] = var_1104;
lval var_1108[8];
var_1108[0] = var_1094[0];
var_1094[1] = wile_gen_list(1, var_1108, NULL);
var_1094[0] = var_1107[0];
TAIL_CALL fn_7(NULL, var_1094);
} else {
lval var_1109;
var_1109 = LVI_BOOL(false);
var_1096 = var_1109;
}
return var_1096;
}
// end of lambda fn_1092

// @@@ lambda (e) @@@ bld-rtl-dir/wile-rtl2-000082.scm:394 @@@ fn_1137 @@@
static lval fn_1137(lptr* var_1138, lptr var_1139)
{
lval var_1143[8];
var_1143[0] = V_CLOS(var_1138,0);
var_1143[1] = var_1139[0];
var_1139[0] = var_1143[0];
var_1139[1] = var_1143[1];
TAIL_CALL wile_eval(NULL, var_1139);
}
// end of lambda fn_1137

// @@@ lambda (vdef) @@@ bld-rtl-dir/wile-rtl2-000082.scm:395 @@@ fn_1147 @@@
static lval fn_1147(lptr* var_1148, lptr var_1149)
{
lval var_1151;
lval var_1152;
lval var_1153;
var_1153 = LVI_STRING("cddr");
lval var_1154;
{
char* cp = strchr(var_1153.v.str, 'r');
var_1154 = var_1149[0];
while (*(--cp) != 'c') {
if (var_1154.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_1154 = (var_1154.v.pair.car ? *(var_1154.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_1154 = (var_1154.v.pair.cdr ? *(var_1154.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_1153.v.str);
}
}
}
lval var_1155;
var_1155 = LVI_BOOL(var_1154.vt == LV_NIL);
if (LV_IS_FALSE(var_1155)) {
lval var_1156;
var_1156 = LVI_STRING("caddr");
lval var_1157;
{
char* cp = strchr(var_1156.v.str, 'r');
var_1157 = var_1149[0];
while (*(--cp) != 'c') {
if (var_1157.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_1157 = (var_1157.v.pair.car ? *(var_1157.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_1157 = (var_1157.v.pair.cdr ? *(var_1157.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_1156.v.str);
}
}
}
var_1152 = var_1157;
} else {
lval var_1158;
if (var_1149[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1158 = (var_1149[0].v.pair.car ? *(var_1149[0].v.pair.car) : LVI_NIL());
var_1152 = var_1158;
}
var_1151 = var_1152;
lval var_1159;
if (var_1149[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1159 = (var_1149[0].v.pair.car ? *(var_1149[0].v.pair.car) : LVI_NIL());
lval var_1160;
lval var_1161[8];
var_1161[0] = V_CLOS(var_1148,0);
var_1161[1] = var_1151;
var_1160 = wile_eval(NULL, var_1161);
lval var_1165[8];
var_1165[0] = var_1159;
var_1165[1] = var_1160;
var_1149[0] = var_1165[0];
var_1149[1] = var_1165[1];
TAIL_CALL fn_1(NULL, var_1149);
}
// end of lambda fn_1147

// @@@ lambda (new-bindings) @@@ bld-rtl-dir/wile-rtl2-000082.scm:386 @@@ fn_1124 @@@
static lval fn_1124(lptr* var_1125, lptr var_1126)
{
lbl_1127:;
lval var_1128;
lval var_1129;
{
lval var_1131[2];
var_1131[0] = var_1126[0];
var_1131[1] = V_CLOS(var_1125,0);
var_1129 = wile_gen_list(2, var_1131, NULL);
}
{
lval var_1130[8];
var_1130[0] = var_1129;
var_1129 = wile_list_append(NULL, var_1130);
}
var_1128 = var_1129;
lval var_1132;
lval var_1133;
if (V_CLOS(var_1125,1).vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1133 = (V_CLOS(var_1125,1).v.pair.car ? *(V_CLOS(var_1125,1).v.pair.car) : LVI_NIL());
lval var_1134;
lval var_1135[8];
var_1135[0] = var_1128;
var_1135[1] = var_1133;
var_1134 = wile_eval(NULL, var_1135);
if (LV_IS_FALSE(var_1134)) {
MK_CLOS(var_1138,1);
lptr var_1144 = new_lv(VT_UNINIT);
var_1144->v.pair.car = &(var_1128);
P_CLOS(var_1138,0) = var_1144;
lval var_1145;
var_1145 = LVI_NIL();
{
lval var_1146[8];
var_1146[0] = LVI_PROC(fn_1137,var_1138,1);
var_1146[1] = V_CLOS(var_1125,2);
var_1146[2] = var_1145;
var_1145 = wile_for_each(NULL, var_1146);
}
MK_CLOS(var_1148,1);
P_CLOS(var_1148,0) = var_1144;
lval var_1166;
var_1166 = LVI_NIL();
{
lval var_1167[8];
var_1167[0] = LVI_PROC(fn_1147,var_1148,1);
var_1167[1] = V_CLOS(var_1125,3);
var_1167[2] = var_1166;
var_1166 = wile_map(NULL, var_1167);
}
lval var_1170[8];
var_1170[0] = var_1166;
*var_1144 = var_1128;
var_1126[0] = var_1170[0];
goto lbl_1127;	// selfie
} else {
lval var_1171;
var_1171 = LVI_BOOL(false);
lval var_1172;
if (V_CLOS(var_1125,1).vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1172 = (V_CLOS(var_1125,1).v.pair.cdr ? *(V_CLOS(var_1125,1).v.pair.cdr) : LVI_NIL());
lval var_1175[8];
var_1175[0] = var_1171;
var_1175[1] = var_1128;
var_1175[2] = var_1172;
var_1126[0] = var_1175[0];
var_1126[1] = var_1175[1];
var_1126[2] = var_1175[2];
TAIL_CALL wile_eval_begin(NULL, var_1126);
}
return var_1132;
}
// end of lambda fn_1124

// @@@ lambda (vdef) @@@ bld-rtl-dir/wile-rtl2-000082.scm:387 @@@ fn_1180 @@@
static lval fn_1180(lptr* var_1181, lptr var_1182)
{
lval var_1184;
if (var_1182[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1184 = (var_1182[0].v.pair.car ? *(var_1182[0].v.pair.car) : LVI_NIL());
lval var_1185;
var_1185 = LVI_STRING("cadr");
lval var_1186;
{
char* cp = strchr(var_1185.v.str, 'r');
var_1186 = var_1182[0];
while (*(--cp) != 'c') {
if (var_1186.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_1186 = (var_1186.v.pair.car ? *(var_1186.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_1186 = (var_1186.v.pair.cdr ? *(var_1186.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_1185.v.str);
}
}
}
lval var_1187;
lval var_1188[8];
var_1188[0] = V_CLOS(var_1181,0);
var_1188[1] = var_1186;
var_1187 = wile_eval(NULL, var_1188);
lval var_1192[8];
var_1192[0] = var_1184;
var_1192[1] = var_1187;
var_1182[0] = var_1192[0];
var_1182[1] = var_1192[1];
TAIL_CALL fn_1(NULL, var_1182);
}
// end of lambda fn_1180

// @@@ (eval-do env expr) @@@ bld-rtl-dir/wile-rtl2-000082.scm:371 @@@ fn_27 @@@
static lval fn_27(lptr* var_1072, lptr var_1073)
{
lval var_1075;
lval var_1076;
lval var_1077[8];
var_1077[0] = var_1073[1];
var_1076 = fn_26(NULL, var_1077);
if (LV_IS_FALSE(var_1076)) {
lval var_1079;
var_1079 = LVI_STRING("malformed \'do\' expression \'%v\'");
lval var_1082[8];
var_1082[0] = var_1079;
lval var_1083[8];
var_1083[0] = var_1073[1];
var_1073[1] = wile_gen_list(1, var_1083, NULL);
var_1073[0] = var_1082[0];
TAIL_CALL fn_7(NULL, var_1073);
} else {
lval var_1084;
lval var_1085;
if (var_1073[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1085 = (var_1073[1].v.pair.car ? *(var_1073[1].v.pair.car) : LVI_NIL());
var_1084 = var_1085;
lval var_1086;
lval var_1087;
var_1087 = LVI_STRING("cadr");
lval var_1088;
{
char* cp = strchr(var_1087.v.str, 'r');
var_1088 = var_1073[1];
while (*(--cp) != 'c') {
if (var_1088.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_1088 = (var_1088.v.pair.car ? *(var_1088.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_1088 = (var_1088.v.pair.cdr ? *(var_1088.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_1087.v.str);
}
}
}
var_1086 = var_1088;
lval var_1089;
lval var_1090;
var_1090 = LVI_STRING("cddr");
lval var_1091;
{
char* cp = strchr(var_1090.v.str, 'r');
var_1091 = var_1073[1];
while (*(--cp) != 'c') {
if (var_1091.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_1091 = (var_1091.v.pair.car ? *(var_1091.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_1091 = (var_1091.v.pair.cdr ? *(var_1091.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_1090.v.str);
}
}
}
var_1089 = var_1091;
MK_CLOS(var_1093,0);
lval var_1110;
var_1110 = LVI_NIL();
{
lval var_1111[8];
var_1111[0] = LVI_PROC(fn_1092,var_1093,1);
var_1111[1] = var_1084;
var_1111[2] = var_1110;
var_1110 = wile_for_each(NULL, var_1111);
}
lval var_1113;
var_1113 = LVI_BOOL(true);
do {
lval var_1114;
{
var_1114 = var_1086;
while (var_1114.vt == LV_PAIR) {
var_1114 = (var_1114.v.pair.cdr ? *(var_1114.v.pair.cdr) : LVI_NIL());
}
var_1114 = LVI_BOOL(var_1114.vt == LV_NIL);
}
var_1113 = var_1114;
if (LV_IS_FALSE(var_1113)) { break; }
lval var_1115;
var_1115 = LVI_INT(1);
lval var_1116;
{
lval var_1117[8];
var_1117[0] = var_1115;
var_1117[1] = var_1086;
var_1116 = wile_list_length_ge(NULL, var_1117);
}
var_1113 = var_1116;
if (LV_IS_FALSE(var_1113)) { break; }
} while (0);
if (LV_IS_FALSE(var_1113)) {
lval var_1118;
var_1118 = LVI_STRING("malformed \'do\' test-expr \'%v\'");
lval var_1120[8];
var_1120[0] = var_1118;
lval var_1122[8];
var_1122[0] = var_1086;
var_1120[1] = wile_gen_list(1, var_1122, NULL);
(void)
 fn_7(NULL, var_1120);
} else {
(void)
 LVI_BOOL(false);
}
MK_CLOS(var_1125,4);
lptr var_1176 = new_lv(VT_UNINIT);
var_1176->v.pair.car = &(var_1084);
P_CLOS(var_1125,3) = var_1176;
lptr var_1177 = new_lv(VT_UNINIT);
var_1177->v.pair.car = &(var_1089);
P_CLOS(var_1125,2) = var_1177;
lptr var_1178 = new_lv(VT_UNINIT);
var_1178->v.pair.car = &(var_1086);
P_CLOS(var_1125,1) = var_1178;
lptr var_1179 = new_lv(VT_UNINIT);
var_1179->v.pair.car = &(var_1073[0]);
P_CLOS(var_1125,0) = var_1179;
MK_CLOS(var_1181,1);
P_CLOS(var_1181,0) = var_1179;
lval var_1193;
var_1193 = LVI_NIL();
{
lval var_1194[8];
var_1194[0] = LVI_PROC(fn_1180,var_1181,1);
var_1194[1] = var_1084;
var_1194[2] = var_1193;
var_1193 = wile_map(NULL, var_1194);
}
lval var_1195;
lval var_1196[8];
var_1196[0] = var_1193;
var_1195 = fn_1124(var_1125, var_1196);
*var_1179 = var_1073[0];
*var_1177 = var_1089;
*var_1176 = var_1084;
*var_1178 = var_1086;
var_1075 = var_1195;
}
return var_1075;
}
// end of function fn_27

// @@@ lambda (fs as env) @@@ bld-rtl-dir/wile-rtl2-000082.scm:422 @@@ fn_1244 @@@
static lval fn_1244(lptr* var_1245, lptr var_1246)
{
lbl_1247:;
lval var_1248;
lval var_1249;
var_1249 = LVI_BOOL(var_1246[0].vt == LV_NIL);
if (LV_IS_FALSE(var_1249)) {
lval var_1250;
if (var_1246[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1250 = (var_1246[0].v.pair.cdr ? *(var_1246[0].v.pair.cdr) : LVI_NIL());
lval var_1251;
if (var_1246[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1251 = (var_1246[1].v.pair.cdr ? *(var_1246[1].v.pair.cdr) : LVI_NIL());
lval var_1252;
if (var_1246[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1252 = (var_1246[0].v.pair.car ? *(var_1246[0].v.pair.car) : LVI_NIL());
lval var_1253;
if (var_1246[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1253 = (var_1246[1].v.pair.car ? *(var_1246[1].v.pair.car) : LVI_NIL());
lval var_1254;
lval var_1255[8];
var_1255[0] = var_1252;
var_1255[1] = var_1253;
var_1254 = fn_1(NULL, var_1255);
lval var_1257;
{
lptr p1 = NULL, p2 = NULL;
if (var_1254.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_1254;
}
if (var_1246[2].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_1246[2];
}
var_1257 = LVI_PAIR(p1, p2);
}
lval var_1260[8];
var_1260[0] = var_1250;
var_1260[1] = var_1251;
var_1260[2] = var_1257;
var_1246[0] = var_1260[0];
var_1246[1] = var_1260[1];
var_1246[2] = var_1260[2];
goto lbl_1247;	// selfie
} else {
var_1248 = var_1246[2];
}
return var_1248;
}
// end of lambda fn_1244

// @@@ (apply-lambda fn args) @@@ bld-rtl-dir/wile-rtl2-000082.scm:406 @@@ wile_eval_apply_lambda @@@
lval wile_eval_apply_lambda(lptr* var_1198, lptr var_1199)
{
lval var_1201;
lval var_1202;
if (var_1199[0].vt == LV_ILAMBDA) {
var_1202 = var_1199[0].v.ilambda->args;
} else {
WILE_EX("get-interpreted-procedure-arguments", "expects an interpreted procedure");
}
var_1201 = var_1202;
lval var_1203;
lval var_1204;
if (var_1199[0].vt == LV_ILAMBDA) {
var_1204 = LVI_INT(var_1199[0].v.ilambda->arity);
} else {
WILE_EX("get-interpreted-procedure-arity", "expects an interpreted procedure");
}
var_1203 = var_1204;
lval var_1205;
lval var_1206;
{
lval var_1207[8];
var_1207[0] = var_1199[1];
var_1206 = wile_list_length(NULL, var_1207);
}
var_1205 = var_1206;
lval var_1209;
switch (var_1203.vt) {
case LV_REAL:
var_1209 = LVI_BOOL(var_1203.v.rv < 0.0);
break;
case LV_RAT:
var_1209 = LVI_BOOL((var_1203.v.irv.num < 0 && var_1203.v.irv.den >= 0) || (var_1203.v.irv.num > 0 && var_1203.v.irv.den < 0));
break;
case LV_INT:
var_1209 = LVI_BOOL(var_1203.v.iv < 0);
break;
default:
WILE_EX("negative?", "expects a real-valued number");
}
if (LV_IS_FALSE(var_1209)) {
lval var_1211;
switch (TYPE_COMBO(var_1205.vt,var_1203.vt)) {
case TYPE_COMBO(LV_INT,LV_INT):
var_1211 = LVI_BOOL(var_1205.v.iv == var_1203.v.iv);
break;
case TYPE_COMBO(LV_INT,LV_RAT):
var_1211 = LVI_BOOL(var_1205.v.iv * var_1203.v.irv.den == var_1203.v.irv.num);
break;
case TYPE_COMBO(LV_INT,LV_REAL):
var_1211 = LVI_BOOL(var_1205.v.iv == var_1203.v.rv);
break;
case TYPE_COMBO(LV_RAT,LV_INT):
var_1211 = LVI_BOOL(var_1205.v.irv.num == var_1203.v.iv * var_1205.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_RAT):
var_1211 = LVI_BOOL(var_1205.v.irv.num * var_1203.v.irv.den == var_1203.v.irv.num * var_1205.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_REAL):
var_1211 = LVI_BOOL(var_1205.v.irv.num == var_1203.v.rv * var_1205.v.irv.den);
break;
case TYPE_COMBO(LV_REAL,LV_INT):
var_1211 = LVI_BOOL(var_1205.v.rv == var_1203.v.iv);
break;
case TYPE_COMBO(LV_REAL,LV_RAT):
var_1211 = LVI_BOOL(var_1205.v.rv * var_1203.v.irv.den == var_1203.v.irv.num);
break;
case TYPE_COMBO(LV_REAL,LV_REAL):
var_1211 = LVI_BOOL(var_1205.v.rv == var_1203.v.rv);
break;
default:
WILE_EX("==", "inputs are not real-valued numbers");
break;
}
if (LV_IS_FALSE(var_1211)) {
lval var_1212;
var_1212 = LVI_STRING("malformed \'lambda\' evaluation: %d formal vs %d actual args");
lval var_1214[8];
var_1214[0] = var_1212;
lval var_1216[8];
var_1216[0] = var_1203;
var_1216[1] = var_1205;
var_1214[1] = wile_gen_list(2, var_1216, NULL);
(void)
 fn_7(NULL, var_1214);
} else {
(void)
 LVI_BOOL(false);
}
} else {
lval var_1218;
lval var_1219;
{
lval var_1221[1];
var_1221[0] = var_1203;
var_1219 = wile_gen_list(1, var_1221, NULL);
}
{
lval var_1220[8];
var_1220[0] = var_1219;
var_1219 = wile_subtract(NULL, var_1220);
}
lval var_1222;
var_1222 = LVI_INT(1);
lval var_1223;
{
lval var_1225[2];
var_1225[0] = var_1219;
var_1225[1] = var_1222;
var_1223 = wile_gen_list(2, var_1225, NULL);
}
{
lval var_1224[8];
var_1224[0] = var_1223;
var_1223 = wile_subtract(NULL, var_1224);
}
var_1218 = var_1223;
lval var_1227;
switch (TYPE_COMBO(var_1205.vt,var_1218.vt)) {
case TYPE_COMBO(LV_INT,LV_INT):
var_1227 = LVI_BOOL(var_1205.v.iv >= var_1218.v.iv);
break;
case TYPE_COMBO(LV_INT,LV_RAT):
var_1227 = LVI_BOOL(var_1205.v.iv * var_1218.v.irv.den >= var_1218.v.irv.num);
break;
case TYPE_COMBO(LV_INT,LV_REAL):
var_1227 = LVI_BOOL(var_1205.v.iv >= var_1218.v.rv);
break;
case TYPE_COMBO(LV_RAT,LV_INT):
var_1227 = LVI_BOOL(var_1205.v.irv.num >= var_1218.v.iv * var_1205.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_RAT):
var_1227 = LVI_BOOL(var_1205.v.irv.num * var_1218.v.irv.den >= var_1218.v.irv.num * var_1205.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_REAL):
var_1227 = LVI_BOOL(var_1205.v.irv.num >= var_1218.v.rv * var_1205.v.irv.den);
break;
case TYPE_COMBO(LV_REAL,LV_INT):
var_1227 = LVI_BOOL(var_1205.v.rv >= var_1218.v.iv);
break;
case TYPE_COMBO(LV_REAL,LV_RAT):
var_1227 = LVI_BOOL(var_1205.v.rv * var_1218.v.irv.den >= var_1218.v.irv.num);
break;
case TYPE_COMBO(LV_REAL,LV_REAL):
var_1227 = LVI_BOOL(var_1205.v.rv >= var_1218.v.rv);
break;
default:
WILE_EX(">=", "inputs are not real-valued numbers");
break;
}
if (LV_IS_FALSE(var_1227)) {
lval var_1228;
var_1228 = LVI_STRING("malformed \'lambda\' evaluation: %d required vs %d given args");
lval var_1230[8];
var_1230[0] = var_1228;
lval var_1232[8];
var_1232[0] = var_1218;
var_1232[1] = var_1205;
var_1230[1] = wile_gen_list(2, var_1232, NULL);
(void)
 fn_7(NULL, var_1230);
} else {
(void)
 LVI_BOOL(false);
}
lval var_1234;
{
lval var_1235[8];
var_1235[0] = var_1199[1];
var_1235[1] = var_1218;
var_1234 = wile_list_head(NULL, var_1235);
}
lval var_1236;
{
lval var_1237[8];
var_1237[0] = var_1199[1];
var_1237[1] = var_1218;
var_1236 = wile_list_tail(NULL, var_1237);
}
lval var_1238;
{
lval var_1239[1];
var_1239[0] = var_1236;
var_1238 = wile_gen_list(1, var_1239, NULL);
}
lval var_1240;
{
lval var_1242[2];
var_1242[0] = var_1234;
var_1242[1] = var_1238;
var_1240 = wile_gen_list(2, var_1242, NULL);
}
{
lval var_1241[8];
var_1241[0] = var_1240;
var_1240 = wile_list_append(NULL, var_1241);
}
var_1199[1] = var_1240;
(void)
 var_1199[1];
}
lval var_1243;
var_1243 = LVI_BOOL(false);
MK_CLOS(var_1245,0);
lval var_1261;
if (var_1199[0].vt == LV_ILAMBDA) {
var_1261 = var_1199[0].v.ilambda->env;
} else {
WILE_EX("get-interpreted-procedure-environment", "expects an interpreted procedure");
}
lval var_1262;
lval var_1263[8];
var_1263[0] = var_1201;
var_1263[1] = var_1199[1];
var_1263[2] = var_1261;
var_1262 = fn_1244(var_1245, var_1263);
lval var_1265;
if (var_1199[0].vt == LV_ILAMBDA) {
var_1265 = var_1199[0].v.ilambda->body;
} else {
WILE_EX("get-interpreted-procedure-body", "expects an interpreted procedure");
}
lval var_1268[8];
var_1268[0] = var_1243;
var_1268[1] = var_1262;
var_1268[2] = var_1265;
var_1199[0] = var_1268[0];
var_1199[1] = var_1268[1];
var_1199[2] = var_1268[2];
TAIL_CALL wile_eval_begin(NULL, var_1199);
}
// end of function wile_eval_apply_lambda

// @@@ lambda (acc lst) @@@ bld-rtl-dir/wile-rtl2-000082.scm:435 @@@ fn_1276 @@@
static lval fn_1276(lptr* var_1277, lptr var_1278)
{
lbl_1279:;
lval var_1280;
lval var_1281;
var_1281 = LVI_BOOL(var_1278[1].vt == LV_NIL);
if (LV_IS_FALSE(var_1281)) {
lval var_1282;
if (var_1278[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1282 = (var_1278[1].v.pair.car ? *(var_1278[1].v.pair.car) : LVI_NIL());
lval var_1283;
{
lptr p1 = NULL, p2 = NULL;
if (var_1282.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_1282;
}
if (var_1278[0].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_1278[0];
}
var_1283 = LVI_PAIR(p1, p2);
}
lval var_1284;
if (var_1278[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1284 = (var_1278[1].v.pair.cdr ? *(var_1278[1].v.pair.cdr) : LVI_NIL());
lval var_1287[8];
var_1287[0] = var_1283;
var_1287[1] = var_1284;
var_1278[0] = var_1287[0];
var_1278[1] = var_1287[1];
goto lbl_1279;	// selfie
} else {
var_1280 = var_1278[0];
}
return var_1280;
}
// end of lambda fn_1276

// @@@ (apply-interp fn . args) @@@ bld-rtl-dir/wile-rtl2-000082.scm:433 @@@ wile_eval_apply_interp @@@
lval wile_eval_apply_interp(lptr* var_1269, lptr var_1270)
{
lval var_1272;
lval var_1273;
{
lval var_1274[8];
var_1274[0] = var_1270[1];
var_1273 = wile_list_reverse(NULL, var_1274);
}
var_1272 = var_1273;
lval var_1275;
MK_CLOS(var_1277,0);
lval var_1288;
if (var_1272.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1288 = (var_1272.v.pair.car ? *(var_1272.v.pair.car) : LVI_NIL());
lval var_1289;
if (var_1272.vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1289 = (var_1272.v.pair.cdr ? *(var_1272.v.pair.cdr) : LVI_NIL());
lval var_1290;
lval var_1291[8];
var_1291[0] = var_1288;
var_1291[1] = var_1289;
var_1290 = fn_1276(var_1277, var_1291);
var_1275 = var_1290;
lval var_1293;
lval var_1294;
var_1294 = LVI_BOOL(var_1270[0].vt == LV_ILAMBDA);
if (LV_IS_FALSE(var_1294)) {
lval var_1295;
{
lval var_1296[2];
var_1296[0] = var_1270[0];
var_1296[1] = var_1275;
var_1295 = wile_gen_list(2, var_1296, NULL);
}
var_1295 = wile_apply_function(&(var_1295), __FILE__, __LINE__);
var_1293 = var_1295;
} else {
lval var_1299[8];
var_1299[0] = var_1270[0];
var_1299[1] = var_1275;
var_1270[0] = var_1299[0];
var_1270[1] = var_1299[1];
TAIL_CALL wile_eval_apply_lambda(NULL, var_1270);
}
return var_1293;
}
// end of function wile_eval_apply_interp

// @@@ lambda (e) @@@ bld-rtl-dir/wile-rtl2-000082.scm:490 @@@ fn_1444 @@@
static lval fn_1444(lptr* var_1445, lptr var_1446)
{
lval var_1450[8];
var_1450[0] = V_CLOS(var_1445,0);
var_1450[1] = var_1446[0];
var_1446[0] = var_1450[0];
var_1446[1] = var_1450[1];
TAIL_CALL wile_eval(NULL, var_1446);
}
// end of lambda fn_1444

// @@@ lambda (e) @@@ bld-rtl-dir/wile-rtl2-000082.scm:487 @@@ fn_1459 @@@
static lval fn_1459(lptr* var_1460, lptr var_1461)
{
lval var_1465[8];
var_1465[0] = V_CLOS(var_1460,0);
var_1465[1] = var_1461[0];
var_1461[0] = var_1465[0];
var_1461[1] = var_1465[1];
TAIL_CALL wile_eval(NULL, var_1461);
}
// end of lambda fn_1459

// @@@ (eval env expr) @@@ bld-rtl-dir/wile-rtl2-000082.scm:446 @@@ wile_eval @@@
lval wile_eval(lptr* var_1300, lptr var_1301)
{
lbl_1302:;
lval var_1303;
do {
lval var_1304;
var_1304 = LVI_BOOL(false);
do {
lval var_1305;
lval var_1306[8];
var_1306[0] = var_1301[1];
var_1305 = fn_8(NULL, var_1306);
var_1304 = var_1305;
if (!LV_IS_FALSE(var_1304)) { break; }
lval var_1308;
var_1308 = LVI_BOOL(var_1301[1].vt == LV_VECTOR);
var_1304 = var_1308;
if (!LV_IS_FALSE(var_1304)) { break; }
lval var_1309;
var_1309 = LVI_BOOL(var_1301[1].vt == LV_BVECTOR);
var_1304 = var_1309;
if (!LV_IS_FALSE(var_1304)) { break; }
} while (0);
if (!LV_IS_FALSE(var_1304)) {
var_1303 = var_1301[1];
break;
}
lval var_1310;
var_1310 = LVI_BOOL(var_1301[1].vt == LV_SYMBOL);
if (!LV_IS_FALSE(var_1310)) {
lval var_1311;
var_1311 = LVI_BOOL(false);
lval var_1314[8];
var_1314[0] = var_1311;
var_1314[1] = var_1301[0];
var_1314[2] = var_1301[1];
var_1301[0] = var_1314[0];
var_1301[1] = var_1314[1];
var_1301[2] = var_1314[2];
TAIL_CALL fn_11(NULL, var_1301);
}
lval var_1315;
var_1315 = LVI_BOOL(var_1301[1].vt == LV_PAIR);
if (!LV_IS_FALSE(var_1315)) {
lval var_1316;
do {
lval var_1317;
if (var_1301[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1317 = (var_1301[1].v.pair.car ? *(var_1301[1].v.pair.car) : LVI_NIL());
lval var_1318;
lval var_1319[8];
var_1319[0] = var_1317;
var_1318 = fn_9(NULL, var_1319);
if (!LV_IS_FALSE(var_1318)) {
lval var_1321;
if (var_1301[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1321 = (var_1301[1].v.pair.car ? *(var_1301[1].v.pair.car) : LVI_NIL());
lval var_1322;
if (var_1321.vt != LV_SYMBOL) {
wile_exception2("case", __FILE__, __LINE__, "case-value type does not match case type");
}
do {
if ((strcmp(var_1321.v.str, "quote") == 0)) {
lval var_1323;
var_1323 = LVI_STRING("cadr");
lval var_1324;
{
char* cp = strchr(var_1323.v.str, 'r');
var_1324 = var_1301[1];
while (*(--cp) != 'c') {
if (var_1324.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_1324 = (var_1324.v.pair.car ? *(var_1324.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_1324 = (var_1324.v.pair.cdr ? *(var_1324.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_1323.v.str);
}
}
}
var_1322 = var_1324;
break;
}
if ((strcmp(var_1321.v.str, "begin") == 0)) {
lval var_1325;
var_1325 = LVI_BOOL(false);
lval var_1326;
if (var_1301[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1326 = (var_1301[1].v.pair.cdr ? *(var_1301[1].v.pair.cdr) : LVI_NIL());
lval var_1329[8];
var_1329[0] = var_1325;
var_1329[1] = var_1301[0];
var_1329[2] = var_1326;
var_1301[0] = var_1329[0];
var_1301[1] = var_1329[1];
var_1301[2] = var_1329[2];
TAIL_CALL wile_eval_begin(NULL, var_1301);
}
if ((strcmp(var_1321.v.str, "if") == 0)) {
lval var_1330;
if (var_1301[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1330 = (var_1301[1].v.pair.cdr ? *(var_1301[1].v.pair.cdr) : LVI_NIL());
lval var_1333[8];
var_1333[0] = var_1301[0];
var_1333[1] = var_1330;
var_1301[0] = var_1333[0];
var_1301[1] = var_1333[1];
TAIL_CALL fn_13(NULL, var_1301);
}
if ((strcmp(var_1321.v.str, "and") == 0)) {
lval var_1334;
var_1334 = LVI_BOOL(true);
lval var_1335;
if (var_1301[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1335 = (var_1301[1].v.pair.cdr ? *(var_1301[1].v.pair.cdr) : LVI_NIL());
lval var_1338[8];
var_1338[0] = var_1334;
var_1338[1] = var_1301[0];
var_1338[2] = var_1335;
var_1301[0] = var_1338[0];
var_1301[1] = var_1338[1];
var_1301[2] = var_1338[2];
TAIL_CALL fn_14(NULL, var_1301);
}
if ((strcmp(var_1321.v.str, "or") == 0)) {
lval var_1339;
var_1339 = LVI_BOOL(false);
lval var_1340;
if (var_1301[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1340 = (var_1301[1].v.pair.cdr ? *(var_1301[1].v.pair.cdr) : LVI_NIL());
lval var_1343[8];
var_1343[0] = var_1339;
var_1343[1] = var_1301[0];
var_1343[2] = var_1340;
var_1301[0] = var_1343[0];
var_1301[1] = var_1343[1];
var_1301[2] = var_1343[2];
TAIL_CALL fn_15(NULL, var_1301);
}
if ((strcmp(var_1321.v.str, "let") == 0)) {
lval var_1344;
var_1344 = LVI_BOOL(false);
lval var_1345;
var_1345 = LVI_BOOL(false);
lval var_1346;
if (var_1301[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1346 = (var_1301[1].v.pair.cdr ? *(var_1301[1].v.pair.cdr) : LVI_NIL());
lval var_1349[8];
var_1349[0] = var_1344;
var_1349[1] = var_1345;
var_1349[2] = var_1301[0];
var_1349[3] = var_1346;
var_1301[0] = var_1349[0];
var_1301[1] = var_1349[1];
var_1301[2] = var_1349[2];
var_1301[3] = var_1349[3];
TAIL_CALL fn_17(NULL, var_1301);
}
if ((strcmp(var_1321.v.str, "let*") == 0)) {
lval var_1350;
var_1350 = LVI_BOOL(false);
lval var_1351;
var_1351 = LVI_BOOL(true);
lval var_1352;
if (var_1301[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1352 = (var_1301[1].v.pair.cdr ? *(var_1301[1].v.pair.cdr) : LVI_NIL());
lval var_1355[8];
var_1355[0] = var_1350;
var_1355[1] = var_1351;
var_1355[2] = var_1301[0];
var_1355[3] = var_1352;
var_1301[0] = var_1355[0];
var_1301[1] = var_1355[1];
var_1301[2] = var_1355[2];
var_1301[3] = var_1355[3];
TAIL_CALL fn_17(NULL, var_1301);
}
if ((strcmp(var_1321.v.str, "letrec") == 0)) {
lval var_1356;
var_1356 = LVI_BOOL(true);
lval var_1357;
var_1357 = LVI_BOOL(false);
lval var_1358;
if (var_1301[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1358 = (var_1301[1].v.pair.cdr ? *(var_1301[1].v.pair.cdr) : LVI_NIL());
lval var_1361[8];
var_1361[0] = var_1356;
var_1361[1] = var_1357;
var_1361[2] = var_1301[0];
var_1361[3] = var_1358;
var_1301[0] = var_1361[0];
var_1301[1] = var_1361[1];
var_1301[2] = var_1361[2];
var_1301[3] = var_1361[3];
TAIL_CALL fn_17(NULL, var_1301);
}
if ((strcmp(var_1321.v.str, "letrec*") == 0)) {
lval var_1362;
var_1362 = LVI_BOOL(true);
lval var_1363;
var_1363 = LVI_BOOL(true);
lval var_1364;
if (var_1301[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1364 = (var_1301[1].v.pair.cdr ? *(var_1301[1].v.pair.cdr) : LVI_NIL());
lval var_1367[8];
var_1367[0] = var_1362;
var_1367[1] = var_1363;
var_1367[2] = var_1301[0];
var_1367[3] = var_1364;
var_1301[0] = var_1367[0];
var_1301[1] = var_1367[1];
var_1301[2] = var_1367[2];
var_1301[3] = var_1367[3];
TAIL_CALL fn_17(NULL, var_1301);
}
if ((strcmp(var_1321.v.str, "cond") == 0)) {
lval var_1368;
var_1368 = LVI_SYMBOL("else");
lval var_1369;
var_1369 = LVI_BOOL(true);
lval var_1370;
lval var_1371[8];
var_1371[0] = var_1368;
var_1371[1] = var_1369;
var_1370 = fn_1(NULL, var_1371);
lval var_1373;
{
lptr p1 = NULL, p2 = NULL;
if (var_1370.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_1370;
}
if (var_1301[0].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_1301[0];
}
var_1373 = LVI_PAIR(p1, p2);
}
lval var_1374;
if (var_1301[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1374 = (var_1301[1].v.pair.cdr ? *(var_1301[1].v.pair.cdr) : LVI_NIL());
lval var_1377[8];
var_1377[0] = var_1373;
var_1377[1] = var_1374;
var_1301[0] = var_1377[0];
var_1301[1] = var_1377[1];
TAIL_CALL fn_20(NULL, var_1301);
}
if ((strcmp(var_1321.v.str, "set!") == 0)) {
lval var_1378;
if (var_1301[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1378 = (var_1301[1].v.pair.cdr ? *(var_1301[1].v.pair.cdr) : LVI_NIL());
lval var_1381[8];
var_1381[0] = var_1301[0];
var_1381[1] = var_1378;
var_1301[0] = var_1381[0];
var_1301[1] = var_1381[1];
TAIL_CALL fn_21(NULL, var_1301);
}
if ((strcmp(var_1321.v.str, "guard") == 0)) {
lval var_1382;
if (var_1301[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1382 = (var_1301[1].v.pair.cdr ? *(var_1301[1].v.pair.cdr) : LVI_NIL());
lval var_1385[8];
var_1385[0] = var_1301[0];
var_1385[1] = var_1382;
var_1301[0] = var_1385[0];
var_1301[1] = var_1385[1];
TAIL_CALL fn_22(NULL, var_1301);
}
if ((strcmp(var_1321.v.str, "case") == 0)) {
lval var_1386;
if (var_1301[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1386 = (var_1301[1].v.pair.cdr ? *(var_1301[1].v.pair.cdr) : LVI_NIL());
lval var_1389[8];
var_1389[0] = var_1301[0];
var_1389[1] = var_1386;
var_1301[0] = var_1389[0];
var_1301[1] = var_1389[1];
TAIL_CALL fn_23(NULL, var_1301);
}
if ((strcmp(var_1321.v.str, "lambda") == 0)) {
lval var_1390;
if (var_1301[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1390 = (var_1301[1].v.pair.cdr ? *(var_1301[1].v.pair.cdr) : LVI_NIL());
lval var_1393[8];
var_1393[0] = var_1301[0];
var_1393[1] = var_1390;
var_1301[0] = var_1393[0];
var_1301[1] = var_1393[1];
TAIL_CALL fn_25(NULL, var_1301);
}
if ((strcmp(var_1321.v.str, "do") == 0)) {
lval var_1394;
if (var_1301[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1394 = (var_1301[1].v.pair.cdr ? *(var_1301[1].v.pair.cdr) : LVI_NIL());
lval var_1397[8];
var_1397[0] = var_1301[0];
var_1397[1] = var_1394;
var_1301[0] = var_1397[0];
var_1301[1] = var_1397[1];
TAIL_CALL fn_27(NULL, var_1301);
}
if ((strcmp(var_1321.v.str, "pragma") == 0)) {
lval var_1398;
var_1398 = LVI_STRING(";;; ignoring %v\n");
lval var_1399;
{
lval var_1401[1];
var_1401[0] = var_1301[1];
var_1399 = wile_gen_list(1, var_1401, NULL);
}
{
lval var_1400[8];
var_1400[0] = var_stderr;
var_1400[1] = var_1398;
var_1400[2] = var_1399;
var_1399 = wile_fprintf(NULL, var_1400);
}
var_1322 = var_1399;
break;
}
if ((strcmp(var_1321.v.str, "quasiquote") == 0)) {
lval var_1402;
lval var_1403;
var_1403 = LVI_INT(2);
lval var_1404;
{
lval var_1405[8];
var_1405[0] = var_1403;
var_1405[1] = var_1301[1];
var_1404 = wile_list_length_eq(NULL, var_1405);
}
if (LV_IS_FALSE(var_1404)) {
lval var_1406;
var_1406 = LVI_STRING("malformed \'quasiquote\' expression \'%v\'");
lval var_1407;
if (var_1301[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1407 = (var_1301[1].v.pair.cdr ? *(var_1301[1].v.pair.cdr) : LVI_NIL());
lval var_1410[8];
var_1410[0] = var_1406;
lval var_1411[8];
var_1411[0] = var_1407;
var_1301[1] = wile_gen_list(1, var_1411, NULL);
var_1301[0] = var_1410[0];
TAIL_CALL fn_7(NULL, var_1301);
} else {
lval var_1412;
var_1412 = LVI_INT(1);
lval var_1413;
var_1413 = LVI_STRING("cadr");
lval var_1414;
{
char* cp = strchr(var_1413.v.str, 'r');
var_1414 = var_1301[1];
while (*(--cp) != 'c') {
if (var_1414.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_1414 = (var_1414.v.pair.car ? *(var_1414.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_1414 = (var_1414.v.pair.cdr ? *(var_1414.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_1413.v.str);
}
}
}
lval var_1417[8];
var_1417[0] = var_1412;
var_1417[1] = var_1301[0];
var_1417[2] = var_1414;
var_1301[0] = var_1417[0];
var_1301[1] = var_1417[1];
var_1301[2] = var_1417[2];
TAIL_CALL fn_19(NULL, var_1301);
}
var_1322 = var_1402;
break;
}
if ((strcmp(var_1321.v.str, "unquote") == 0)) {
lval var_1418;
var_1418 = LVI_STRING("naked \'unquote\' expression \'%v\'");
lval var_1421[8];
var_1421[0] = var_1418;
lval var_1422[8];
var_1422[0] = var_1301[1];
var_1301[1] = wile_gen_list(1, var_1422, NULL);
var_1301[0] = var_1421[0];
TAIL_CALL fn_7(NULL, var_1301);
}
if ((strcmp(var_1321.v.str, "unquote-splicing") == 0)) {
lval var_1423;
var_1423 = LVI_STRING("naked \'unquote-splicing\' expression \'%v\'");
lval var_1426[8];
var_1426[0] = var_1423;
lval var_1427[8];
var_1427[0] = var_1301[1];
var_1301[1] = wile_gen_list(1, var_1427, NULL);
var_1301[0] = var_1426[0];
TAIL_CALL fn_7(NULL, var_1301);
}
{
lval var_1428;
var_1428 = LVI_SYMBOL("unimplemented-special-form");
var_1322 = var_1428;
break;
}
} while (0);
var_1316 = var_1322;
break;
}
lval var_1429;
lval var_1430[8];
var_1430[0] = var_1301[1];
var_1429 = wile_eval_define_form(NULL, var_1430);
if (!LV_IS_FALSE(var_1429)) {
lval var_1432;
var_1432 = LVI_STRING("misplaced \'define\' expression \'%v\'");
lval var_1435[8];
var_1435[0] = var_1432;
lval var_1436[8];
var_1436[0] = var_1301[1];
var_1301[1] = wile_gen_list(1, var_1436, NULL);
var_1301[0] = var_1435[0];
TAIL_CALL fn_7(NULL, var_1301);
}
lval var_1437;
lval var_1438;
if (var_1301[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1438 = (var_1301[1].v.pair.car ? *(var_1301[1].v.pair.car) : LVI_NIL());
lval var_1439;
lval var_1440[8];
var_1440[0] = var_1301[0];
var_1440[1] = var_1438;
var_1439 = wile_eval(NULL, var_1440);
var_1437 = var_1439;
lval var_1442;
lval var_1443;
var_1443 = LVI_BOOL(var_1437.vt == LV_ILAMBDA);
if (LV_IS_FALSE(var_1443)) {
MK_CLOS(var_1445,1);
lptr var_1451 = new_lv(VT_UNINIT);
var_1451->v.pair.car = &(var_1301[0]);
P_CLOS(var_1445,0) = var_1451;
lval var_1452;
if (var_1301[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1452 = (var_1301[1].v.pair.cdr ? *(var_1301[1].v.pair.cdr) : LVI_NIL());
lval var_1453;
var_1453 = LVI_NIL();
{
lval var_1454[8];
var_1454[0] = LVI_PROC(fn_1444,var_1445,1);
var_1454[1] = var_1452;
var_1454[2] = var_1453;
var_1453 = wile_map(NULL, var_1454);
}
lval var_1455;
{
lval var_1456[2];
var_1456[0] = var_1437;
var_1456[1] = var_1453;
var_1455 = wile_gen_list(2, var_1456, NULL);
}
var_1455 = wile_apply_function(&(var_1455), __FILE__, __LINE__);
*var_1451 = var_1301[0];
var_1442 = var_1455;
} else {
lval var_1457;
lval var_1458;
if (var_1437.vt == LV_ILAMBDA) {
var_1458 = LVI_BOOL(var_1437.v.ilambda->macro);
} else {
WILE_EX("get-interpreted-procedure-macro", "expects an interpreted procedure");
}
if (LV_IS_FALSE(var_1458)) {
MK_CLOS(var_1460,1);
lptr var_1466 = new_lv(VT_UNINIT);
var_1466->v.pair.car = &(var_1301[0]);
P_CLOS(var_1460,0) = var_1466;
lval var_1467;
if (var_1301[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1467 = (var_1301[1].v.pair.cdr ? *(var_1301[1].v.pair.cdr) : LVI_NIL());
lval var_1468;
var_1468 = LVI_NIL();
{
lval var_1469[8];
var_1469[0] = LVI_PROC(fn_1459,var_1460,1);
var_1469[1] = var_1467;
var_1469[2] = var_1468;
var_1468 = wile_map(NULL, var_1469);
}
lval var_1472[8];
var_1472[0] = var_1437;
var_1472[1] = var_1468;
*var_1466 = var_1301[0];
var_1301[0] = var_1472[0];
var_1301[1] = var_1472[1];
TAIL_CALL wile_eval_apply_lambda(NULL, var_1301);
} else {
lval var_1473;
if (var_1301[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1473 = (var_1301[1].v.pair.cdr ? *(var_1301[1].v.pair.cdr) : LVI_NIL());
lval var_1474;
lval var_1475[8];
var_1475[0] = var_1437;
var_1475[1] = var_1473;
var_1474 = wile_eval_apply_lambda(NULL, var_1475);
lval var_1479[8];
var_1479[0] = var_1301[0];
var_1479[1] = var_1474;
var_1301[0] = var_1479[0];
var_1301[1] = var_1479[1];
goto lbl_1302;	// selfie
}
var_1442 = var_1457;
}
var_1316 = var_1442;
} while (0);
var_1303 = var_1316;
break;
}
var_1303 = LVI_BOOL(false);
} while (0);
return var_1303;
}
// end of function wile_eval
