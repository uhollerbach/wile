// Generated by wile, the extremely stable scheming genius compiler

#include "wile-rtl1.h"
#include "wile-rtl2.h"

// declarations

extern lval var_argv;
extern lval var_cmd_name;
extern lval var_stdin;
extern lval var_stdout;
extern lval var_stderr;
extern lval var_pi;
extern lval var_euler_gamma;
extern lval var_show_sign;
extern lval var_int_base;
extern lval var_flt_base;
extern lval var_flt_precision;
#include "wile-rtl2.h"
static lval fn_1(lptr*, lptr);	// (make-bbox name value)
static lval fn_2(lptr*, lptr);	// (isa-bbox? it)
static lval fn_3(lptr*, lptr);	// (get-bbox-name it)
static lval fn_4(lptr*, lptr);	// (get-bbox-value it)
static lval fn_5(lptr*, lptr);	// (set-bbox-name! it val)
static lval fn_6(lptr*, lptr);	// (set-bbox-value! it val)
static lval fn_7(lptr*, lptr);	// (ERR fmt . args)
static lval fn_8(lptr*, lptr);	// (atom? val)
static lval fn_9(lptr*, lptr);	// (special-form? val)
static lval fn_10(lptr*, lptr);	// (unique-symbols? lst)
static lval fn_11(lptr*, lptr);	// (symbol-lookup box? env sym)
static lval fn_12(lptr*, lptr);	// (eval-binding env expr)
static lval fn_13(lptr*, lptr);	// (eval-begin env expr)
static lval fn_14(lptr*, lptr);	// (eval-if env exprs)
static lval fn_15(lptr*, lptr);	// (eval-and init env exprs)
static lval fn_16(lptr*, lptr);	// (eval-or init env exprs)
static lval fn_17(lptr*, lptr);	// (check-let-bindings type llist)
static lval fn_18(lptr*, lptr);	// (eval-let star? env exprs)
static lval fn_19(lptr*, lptr);	// (eval-letrec env exprs)
static lval fn_20(lptr*, lptr);	// (eval-qq-olist level env expr)
static lval fn_21(lptr*, lptr);	// (eval-qq level env expr)
static lval fn_22(lptr*, lptr);	// (eval-cond env expr)
static lval fn_23(lptr*, lptr);	// (eval-set! env expr)
static lval fn_24(lptr*, lptr);	// (eval-guard env expr)
static lval fn_25(lptr*, lptr);	// (eval-case env expr)
static lval fn_26(lptr*, lptr);	// (args-list dotted-list)
static lval fn_27(lptr*, lptr);	// (eval-lambda env expr)
static lval fn_28(lptr*, lptr);	// (check-syntax-do expr)
static lval fn_29(lptr*, lptr);	// (eval-do env expr)
static lval fn_166(lptr*, lptr);
static lval fn_185(lptr*, lptr);
static lval fn_204(lptr*, lptr);
static lval fn_315(lptr*, lptr);
static lval fn_370(lptr*, lptr);
static lval fn_376(lptr*, lptr);
static lval fn_437(lptr*, lptr);
static lval fn_496(lptr*, lptr);
static lval fn_533(lptr*, lptr);
static lval fn_564(lptr*, lptr);
static lval fn_577(lptr*, lptr);
static lval fn_589(lptr*, lptr);
static lval fn_786(lptr*, lptr);
static lval fn_832(lptr*, lptr);
static lval fn_891(lptr*, lptr);
static lval fn_982(lptr*, lptr);
static lval fn_1011(lptr*, lptr);
static lval fn_1022(lptr*, lptr);
static lval fn_1030(lptr*, lptr);
static lval fn_1057(lptr*, lptr);
static lval fn_1109(lptr*, lptr);
static lval fn_1140(lptr*, lptr);
static lval fn_1293(lptr*, lptr);
static lval fn_1305(lptr*, lptr);

// definitions

// @@@ (make-bbox name value) @@@ bld-rtl-dir/wile-rtl2-000078.scm:20 @@@ fn_1 @@@
static lval fn_1(lptr* var_30, lptr var_31)
{
lval var_33;
lval var_34;
var_34 = LVI_INT(3);
lval var_35;
{
size_t i, capa;
var_35.vt = LV_VECTOR;
capa = var_34.v.iv;
var_35.v.vec.capa = capa;
var_35.v.vec.arr = LISP_ALLOC(lptr, (capa > 0 ? capa : 1));
if (var_35.v.vec.arr == NULL) {
WILE_EX("vector-create", "memory allocation failed!");
}
for (i = 0; i < capa; ++i) {
var_35.v.vec.arr[i] = NULL;
}
}
var_33 = var_35;
lval var_36;
var_36 = LVI_INT(0);
lval var_37;
var_37 = LVI_SYMBOL("bbox");
{
if (var_33.vt != LV_VECTOR) {
WILE_EX("vector-set!", "input is not a vector");
}
if (var_36.vt != LV_INT || var_36.v.iv < 0 || (size_t) var_36.v.iv >= var_33.v.vec.capa) {
WILE_EX("vector-set!", "got bad index value");
}
var_33.v.vec.arr[var_36.v.iv] = new_lv(LV_NIL);
*(var_33.v.vec.arr[var_36.v.iv]) = var_37;
}
lval var_39;
var_39 = LVI_INT(1);
{
if (var_33.vt != LV_VECTOR) {
WILE_EX("vector-set!", "input is not a vector");
}
if (var_39.vt != LV_INT || var_39.v.iv < 0 || (size_t) var_39.v.iv >= var_33.v.vec.capa) {
WILE_EX("vector-set!", "got bad index value");
}
var_33.v.vec.arr[var_39.v.iv] = new_lv(LV_NIL);
*(var_33.v.vec.arr[var_39.v.iv]) = var_31[0];
}
lval var_41;
var_41 = LVI_INT(2);
{
if (var_33.vt != LV_VECTOR) {
WILE_EX("vector-set!", "input is not a vector");
}
if (var_41.vt != LV_INT || var_41.v.iv < 0 || (size_t) var_41.v.iv >= var_33.v.vec.capa) {
WILE_EX("vector-set!", "got bad index value");
}
var_33.v.vec.arr[var_41.v.iv] = new_lv(LV_NIL);
*(var_33.v.vec.arr[var_41.v.iv]) = var_31[1];
}
return var_33;
}
// end of function fn_1

// @@@ (isa-bbox? it) @@@ bld-rtl-dir/wile-rtl2-000078.scm:20 @@@ fn_2 @@@
static lval fn_2(lptr* var_43, lptr var_44)
{
lval var_46;
var_46 = LVI_BOOL(true);
do {
lval var_47;
var_47 = LVI_BOOL(var_44[0].vt == LV_VECTOR);
var_46 = var_47;
if (LV_IS_FALSE(var_46)) { break; }
lval var_48;
var_48 = LVI_INT(0);
lval var_49;
{
if (var_44[0].vt != LV_VECTOR) {
WILE_EX("vector-ref", "input is not a vector");
}
if (var_48.vt != LV_INT || var_48.v.iv < 0 || (size_t) var_48.v.iv >= var_44[0].v.vec.capa) {
WILE_EX("vector-ref", "got bad index value");
}
var_49 = var_44[0].v.vec.arr[var_48.v.iv] ? *(var_44[0].v.vec.arr[var_48.v.iv]) : LVI_NIL();
}
lval var_50;
var_50 = LVI_SYMBOL("bbox");
lval var_51;
var_51 = LVI_BOOL(wile_do_eqv(&(var_49), &(var_50)));
var_46 = var_51;
if (LV_IS_FALSE(var_46)) { break; }
} while (0);
return var_46;
}
// end of function fn_2

// @@@ (get-bbox-name it) @@@ ./wrtl.sch:0 @@@ fn_3 @@@
static lval fn_3(lptr* var_52, lptr var_53)
{
lval var_55;
var_55 = LVI_INT(1);
lval var_56;
{
if (var_53[0].vt != LV_VECTOR) {
WILE_EX("vector-ref", "input is not a vector");
}
if (var_55.vt != LV_INT || var_55.v.iv < 0 || (size_t) var_55.v.iv >= var_53[0].v.vec.capa) {
WILE_EX("vector-ref", "got bad index value");
}
var_56 = var_53[0].v.vec.arr[var_55.v.iv] ? *(var_53[0].v.vec.arr[var_55.v.iv]) : LVI_NIL();
}
return var_56;
}
// end of function fn_3

// @@@ (get-bbox-value it) @@@ ./wrtl.sch:0 @@@ fn_4 @@@
static lval fn_4(lptr* var_57, lptr var_58)
{
lval var_60;
var_60 = LVI_INT(2);
lval var_61;
{
if (var_58[0].vt != LV_VECTOR) {
WILE_EX("vector-ref", "input is not a vector");
}
if (var_60.vt != LV_INT || var_60.v.iv < 0 || (size_t) var_60.v.iv >= var_58[0].v.vec.capa) {
WILE_EX("vector-ref", "got bad index value");
}
var_61 = var_58[0].v.vec.arr[var_60.v.iv] ? *(var_58[0].v.vec.arr[var_60.v.iv]) : LVI_NIL();
}
return var_61;
}
// end of function fn_4

// @@@ (set-bbox-name! it val) @@@ ./wrtl.sch:0 @@@ fn_5 @@@
static lval fn_5(lptr* var_62, lptr var_63)
{
lval var_65;
var_65 = LVI_INT(1);
lval var_66;
{
if (var_63[0].vt != LV_VECTOR) {
WILE_EX("vector-set!", "input is not a vector");
}
if (var_65.vt != LV_INT || var_65.v.iv < 0 || (size_t) var_65.v.iv >= var_63[0].v.vec.capa) {
WILE_EX("vector-set!", "got bad index value");
}
var_63[0].v.vec.arr[var_65.v.iv] = new_lv(LV_NIL);
*(var_63[0].v.vec.arr[var_65.v.iv]) = var_63[1];
var_66 = var_63[0];
}
return var_66;
}
// end of function fn_5

// @@@ (set-bbox-value! it val) @@@ ./wrtl.sch:0 @@@ fn_6 @@@
static lval fn_6(lptr* var_67, lptr var_68)
{
lval var_70;
var_70 = LVI_INT(2);
lval var_71;
{
if (var_68[0].vt != LV_VECTOR) {
WILE_EX("vector-set!", "input is not a vector");
}
if (var_70.vt != LV_INT || var_70.v.iv < 0 || (size_t) var_70.v.iv >= var_68[0].v.vec.capa) {
WILE_EX("vector-set!", "got bad index value");
}
var_68[0].v.vec.arr[var_70.v.iv] = new_lv(LV_NIL);
*(var_68[0].v.vec.arr[var_70.v.iv]) = var_68[1];
var_71 = var_68[0];
}
return var_71;
}
// end of function fn_6

// @@@ sprintf @@@ bld-rtl-dir/wile-rtl2-000078.scm:24 @@@ fn_76 @@@
static lval fn_76(lptr* var_77, lptr var_78)
{
lval var_80;
var_80 = var_78[1];
{
lval vs[8];
vs[0] = var_78[0];
vs[1] = var_80;
var_80 = wile_sprintf(NULL, vs);
}
return var_80;
}
// end of prim fn_76

// @@@ (ERR fmt . args) @@@ bld-rtl-dir/wile-rtl2-000078.scm:22 @@@ fn_7 @@@
static lval fn_7(lptr* var_72, lptr var_73)
{
{
lval vs[8];
vs[0] = var_stderr;
(void)
 wile_flushport(NULL, vs);
}
lval var_81;
var_81 = LVI_STRING(" at ");
lval var_82;
var_82 = LVI_STRING(wile_decode_line_loc(wile_get_lisp_loc(&var_73[1])));
lval var_83;
{
lval vs[3];
vs[0] = var_73[0];
vs[1] = var_81;
vs[2] = var_82;
var_83 = wile_gen_list(3, vs, NULL);
}
{
lval vs[8];
vs[0] = var_83;
var_83 = wile_string_append(NULL, vs);
}
lval var_84;
{
lval vs[3];
vs[0] = LVI_PROC(fn_76,NULL,-2);
vs[1] = var_83;
vs[2] = var_73[1];
var_84 = wile_gen_list(3, vs, NULL);
}
var_84 = wile_apply_function(&(var_84), __FILE__, __LINE__);
lval var_85;
{
lval vs[1];
vs[0] = var_84;
var_85 = wile_gen_list(1, vs, NULL);
}
if (var_85.vt == LV_PAIR && (var_85.v.pair.cdr == NULL || var_85.v.pair.cdr->vt == LV_NIL)) {
var_85 = (var_85.v.pair.car ? *(var_85.v.pair.car) : LVI_NIL());
}
cachalot->errval = new_lv(LV_NIL);
*(cachalot->errval) = var_85;
cachalot->l_whence = 0;
cachalot->c_whence = LISP_WHENCE;
longjmp(cachalot->cenv, 1);
return var_85;
}
// end of function fn_7

// @@@ (atom? val) @@@ bld-rtl-dir/wile-rtl2-000078.scm:28 @@@ fn_8 @@@
static lval fn_8(lptr* var_86, lptr var_87)
{
lval var_89;
var_89 = LVI_BOOL(false);
do {
lval var_90;
var_90 = LVI_BOOL(var_87[0].vt == LV_NIL);
var_89 = var_90;
if (!LV_IS_FALSE(var_89)) { break; }
lval var_91;
var_91 = LVI_BOOL(var_87[0].vt == LV_BOOL);
var_89 = var_91;
if (!LV_IS_FALSE(var_89)) { break; }
lval var_92;
var_92 = LVI_BOOL(var_87[0].vt == LV_CHAR);
var_89 = var_92;
if (!LV_IS_FALSE(var_89)) { break; }
lval var_93;
var_93 = LVI_BOOL(var_87[0].vt == LV_STRING);
var_89 = var_93;
if (!LV_IS_FALSE(var_89)) { break; }
lval var_94;
var_94 = LVI_BOOL(var_87[0].vt == LV_INT);
var_89 = var_94;
if (!LV_IS_FALSE(var_89)) { break; }
lval var_95;
var_95 = LVI_BOOL(var_87[0].vt == LV_RAT || var_87[0].vt == LV_INT);
var_89 = var_95;
if (!LV_IS_FALSE(var_89)) { break; }
lval var_96;
var_96 = LVI_BOOL(var_87[0].vt == LV_REAL || var_87[0].vt == LV_RAT || var_87[0].vt == LV_INT);
var_89 = var_96;
if (!LV_IS_FALSE(var_89)) { break; }
lval var_97;
var_97 = LVI_BOOL(var_87[0].vt == LV_CMPLX || var_87[0].vt == LV_REAL || var_87[0].vt == LV_RAT || var_87[0].vt == LV_INT);
var_89 = var_97;
if (!LV_IS_FALSE(var_89)) { break; }
lval var_98;
var_98 = LVI_BOOL(var_87[0].vt == LV_FILE_PORT);
var_89 = var_98;
if (!LV_IS_FALSE(var_89)) { break; }
lval var_99;
var_99 = LVI_BOOL(var_87[0].vt == LV_PIPE_PORT);
var_89 = var_99;
if (!LV_IS_FALSE(var_89)) { break; }
lval var_100;
var_100 = LVI_BOOL(var_87[0].vt == LV_SOCK_PORT);
var_89 = var_100;
if (!LV_IS_FALSE(var_89)) { break; }
lval var_101;
var_101 = LVI_BOOL(var_87[0].vt == LV_STR_PORT);
var_89 = var_101;
if (!LV_IS_FALSE(var_89)) { break; }
lval var_102;
var_102 = LVI_BOOL(var_87[0].vt == LV_SQLITE_PORT);
var_89 = var_102;
if (!LV_IS_FALSE(var_89)) { break; }
lval var_103;
var_103 = LVI_BOOL(var_87[0].vt == LV_SQLITE_STMT);
var_89 = var_103;
if (!LV_IS_FALSE(var_89)) { break; }
} while (0);
return var_89;
}
// end of function fn_8

// @@@ (special-form? val) @@@ bld-rtl-dir/wile-rtl2-000078.scm:44 @@@ fn_9 @@@
static lval fn_9(lptr* var_104, lptr var_105)
{
lval var_107;
var_107 = LVI_BOOL(true);
do {
lval var_108;
var_108 = LVI_BOOL(var_105[0].vt == LV_SYMBOL);
var_107 = var_108;
if (LV_IS_FALSE(var_107)) { break; }
lval var_109;
var_109 = LVI_BOOL(false);
do {
lval var_110;
var_110 = LVI_SYMBOL("quote");
lval var_111;
var_111 = LVI_BOOL(strcmp(var_105[0].v.str, var_110.v.str) == 0);
var_109 = var_111;
if (!LV_IS_FALSE(var_109)) { break; }
lval var_112;
var_112 = LVI_SYMBOL("and");
lval var_113;
var_113 = LVI_BOOL(strcmp(var_105[0].v.str, var_112.v.str) == 0);
var_109 = var_113;
if (!LV_IS_FALSE(var_109)) { break; }
lval var_114;
var_114 = LVI_SYMBOL("begin");
lval var_115;
var_115 = LVI_BOOL(strcmp(var_105[0].v.str, var_114.v.str) == 0);
var_109 = var_115;
if (!LV_IS_FALSE(var_109)) { break; }
lval var_116;
var_116 = LVI_SYMBOL("case");
lval var_117;
var_117 = LVI_BOOL(strcmp(var_105[0].v.str, var_116.v.str) == 0);
var_109 = var_117;
if (!LV_IS_FALSE(var_109)) { break; }
lval var_118;
var_118 = LVI_SYMBOL("cond");
lval var_119;
var_119 = LVI_BOOL(strcmp(var_105[0].v.str, var_118.v.str) == 0);
var_109 = var_119;
if (!LV_IS_FALSE(var_109)) { break; }
lval var_120;
var_120 = LVI_SYMBOL("do");
lval var_121;
var_121 = LVI_BOOL(strcmp(var_105[0].v.str, var_120.v.str) == 0);
var_109 = var_121;
if (!LV_IS_FALSE(var_109)) { break; }
lval var_122;
var_122 = LVI_SYMBOL("guard");
lval var_123;
var_123 = LVI_BOOL(strcmp(var_105[0].v.str, var_122.v.str) == 0);
var_109 = var_123;
if (!LV_IS_FALSE(var_109)) { break; }
lval var_124;
var_124 = LVI_SYMBOL("if");
lval var_125;
var_125 = LVI_BOOL(strcmp(var_105[0].v.str, var_124.v.str) == 0);
var_109 = var_125;
if (!LV_IS_FALSE(var_109)) { break; }
lval var_126;
var_126 = LVI_SYMBOL("lambda");
lval var_127;
var_127 = LVI_BOOL(strcmp(var_105[0].v.str, var_126.v.str) == 0);
var_109 = var_127;
if (!LV_IS_FALSE(var_109)) { break; }
lval var_128;
var_128 = LVI_SYMBOL("let");
lval var_129;
var_129 = LVI_BOOL(strcmp(var_105[0].v.str, var_128.v.str) == 0);
var_109 = var_129;
if (!LV_IS_FALSE(var_109)) { break; }
lval var_130;
var_130 = LVI_SYMBOL("let*");
lval var_131;
var_131 = LVI_BOOL(strcmp(var_105[0].v.str, var_130.v.str) == 0);
var_109 = var_131;
if (!LV_IS_FALSE(var_109)) { break; }
lval var_132;
var_132 = LVI_SYMBOL("letrec");
lval var_133;
var_133 = LVI_BOOL(strcmp(var_105[0].v.str, var_132.v.str) == 0);
var_109 = var_133;
if (!LV_IS_FALSE(var_109)) { break; }
lval var_134;
var_134 = LVI_SYMBOL("letrec*");
lval var_135;
var_135 = LVI_BOOL(strcmp(var_105[0].v.str, var_134.v.str) == 0);
var_109 = var_135;
if (!LV_IS_FALSE(var_109)) { break; }
lval var_136;
var_136 = LVI_SYMBOL("or");
lval var_137;
var_137 = LVI_BOOL(strcmp(var_105[0].v.str, var_136.v.str) == 0);
var_109 = var_137;
if (!LV_IS_FALSE(var_109)) { break; }
lval var_138;
var_138 = LVI_SYMBOL("set!");
lval var_139;
var_139 = LVI_BOOL(strcmp(var_105[0].v.str, var_138.v.str) == 0);
var_109 = var_139;
if (!LV_IS_FALSE(var_109)) { break; }
lval var_140;
var_140 = LVI_SYMBOL("quasiquote");
lval var_141;
var_141 = LVI_BOOL(strcmp(var_105[0].v.str, var_140.v.str) == 0);
var_109 = var_141;
if (!LV_IS_FALSE(var_109)) { break; }
lval var_142;
var_142 = LVI_SYMBOL("unquote");
lval var_143;
var_143 = LVI_BOOL(strcmp(var_105[0].v.str, var_142.v.str) == 0);
var_109 = var_143;
if (!LV_IS_FALSE(var_109)) { break; }
lval var_144;
var_144 = LVI_SYMBOL("unquote-splicing");
lval var_145;
var_145 = LVI_BOOL(strcmp(var_105[0].v.str, var_144.v.str) == 0);
var_109 = var_145;
if (!LV_IS_FALSE(var_109)) { break; }
lval var_146;
var_146 = LVI_SYMBOL("pragma");
lval var_147;
var_147 = LVI_BOOL(strcmp(var_105[0].v.str, var_146.v.str) == 0);
var_109 = var_147;
if (!LV_IS_FALSE(var_109)) { break; }
} while (0);
var_107 = var_109;
if (LV_IS_FALSE(var_107)) { break; }
} while (0);
return var_107;
}
// end of function fn_9

// @@@ (define-form? expr) @@@ bld-rtl-dir/wile-rtl2-000078.scm:72 @@@ wile_eval_define_form @@@
lval wile_eval_define_form(lptr* var_148, lptr var_149)
{
lval var_151;
var_151 = LVI_BOOL(true);
do {
lval var_152;
var_152 = LVI_BOOL(var_149[0].vt == LV_PAIR);
var_151 = var_152;
if (LV_IS_FALSE(var_151)) { break; }
lval var_153;
if (var_149[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_153 = (var_149[0].v.pair.car ? *(var_149[0].v.pair.car) : LVI_NIL());
lval var_154;
var_154 = LVI_BOOL(var_153.vt == LV_SYMBOL);
var_151 = var_154;
if (LV_IS_FALSE(var_151)) { break; }
lval var_155;
var_155 = LVI_BOOL(false);
do {
lval var_156;
if (var_149[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_156 = (var_149[0].v.pair.car ? *(var_149[0].v.pair.car) : LVI_NIL());
lval var_157;
var_157 = LVI_SYMBOL("define");
lval var_158;
var_158 = LVI_BOOL(strcmp(var_156.v.str, var_157.v.str) == 0);
var_155 = var_158;
if (!LV_IS_FALSE(var_155)) { break; }
lval var_159;
if (var_149[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_159 = (var_149[0].v.pair.car ? *(var_149[0].v.pair.car) : LVI_NIL());
lval var_160;
var_160 = LVI_SYMBOL("defmacro");
lval var_161;
var_161 = LVI_BOOL(strcmp(var_159.v.str, var_160.v.str) == 0);
var_155 = var_161;
if (!LV_IS_FALSE(var_155)) { break; }
} while (0);
var_151 = var_155;
if (LV_IS_FALSE(var_151)) { break; }
} while (0);
return var_151;
}
// end of function wile_eval_define_form

// @@@ lambda (ls) @@@ bld-rtl-dir/wile-rtl2-000078.scm:79 @@@ fn_166 @@@
static lval fn_166(lptr* var_167, lptr var_168)
{
lbl_169:;
lval var_170;
do {
lval var_171;
var_171 = LVI_BOOL(var_168[0].vt == LV_NIL);
if (!LV_IS_FALSE(var_171)) {
lval var_172;
var_172 = LVI_BOOL(true);
var_170 = var_172;
break;
}
lval var_173;
if (var_168[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_173 = (var_168[0].v.pair.car ? *(var_168[0].v.pair.car) : LVI_NIL());
lval var_174;
var_174 = LVI_BOOL(var_173.vt == LV_SYMBOL);
if (!LV_IS_FALSE(var_174)) {
lval var_175;
if (var_168[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_175 = (var_168[0].v.pair.cdr ? *(var_168[0].v.pair.cdr) : LVI_NIL());
lval var_178[8];
var_178[0] = var_175;
var_168[0] = var_178[0];
goto lbl_169;	// selfie
}
lval var_179;
var_179 = LVI_BOOL(false);
var_170 = var_179;
} while (0);
return var_170;
}
// end of lambda fn_166

// @@@ lambda (ss) @@@ bld-rtl-dir/wile-rtl2-000078.scm:84 @@@ fn_185 @@@
static lval fn_185(lptr* var_186, lptr var_187)
{
lbl_188:;
lval var_189;
do {
lval var_190;
var_190 = LVI_BOOL(var_187[0].vt == LV_NIL);
if (!LV_IS_FALSE(var_190)) {
lval var_191;
var_191 = LVI_BOOL(true);
var_189 = var_191;
break;
}
lval var_192;
if (var_187[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_192 = (var_187[0].v.pair.cdr ? *(var_187[0].v.pair.cdr) : LVI_NIL());
lval var_193;
var_193 = LVI_BOOL(var_192.vt == LV_NIL);
if (!LV_IS_FALSE(var_193)) {
lval var_194;
var_194 = LVI_BOOL(true);
var_189 = var_194;
break;
}
lval var_195;
if (var_187[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_195 = (var_187[0].v.pair.car ? *(var_187[0].v.pair.car) : LVI_NIL());
lval var_196;
var_196 = LVI_STRING("cadr");
lval var_197;
{
char* cp = strchr(var_196.v.str, 'r');
var_197 = var_187[0];
while (*(--cp) != 'c') {
if (var_197.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_197 = (var_197.v.pair.car ? *(var_197.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_197 = (var_197.v.pair.cdr ? *(var_197.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_196.v.str);
}
}
}
lval var_198;
var_198 = LVI_BOOL(strcmp(var_195.v.str, var_197.v.str) == 0);
if (!LV_IS_FALSE(var_198)) {
lval var_199;
var_199 = LVI_BOOL(false);
var_189 = var_199;
break;
}
lval var_200;
if (var_187[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_200 = (var_187[0].v.pair.cdr ? *(var_187[0].v.pair.cdr) : LVI_NIL());
lval var_203[8];
var_203[0] = var_200;
var_187[0] = var_203[0];
goto lbl_188;	// selfie
} while (0);
return var_189;
}
// end of lambda fn_185

// @@@ lambda (a b) @@@ bld-rtl-dir/wile-rtl2-000078.scm:84 @@@ fn_204 @@@
static lval fn_204(lptr* var_205, lptr var_206)
{
lval var_208;
var_208 = LVI_BOOL(strcmp(var_206[0].v.str, var_206[1].v.str) < 0);
return var_208;
}
// end of lambda fn_204

// @@@ symbol->string @@@ bld-rtl-dir/wile-rtl2-000078.scm:85 @@@ fn_209 @@@
static lval fn_209(lptr* var_210, lptr var_211)
{
lval var_213;
var_213 = LVI_STRING(var_211[0].v.str);
return var_213;
}
// end of prim fn_209

// @@@ (unique-symbols? lst) @@@ bld-rtl-dir/wile-rtl2-000078.scm:78 @@@ fn_10 @@@
static lval fn_10(lptr* var_162, lptr var_163)
{
lval var_165;
MK_CLOS(var_167,0);
lval var_180;
lval var_181[8];
var_181[0] = var_163[0];
var_180 = fn_166(var_167, var_181);
var_165 = var_180;
lval var_183;
if (LV_IS_FALSE(var_165)) {
lval var_184;
var_184 = LVI_BOOL(false);
var_183 = var_184;
} else {
MK_CLOS(var_186,0);
MK_CLOS(var_205,0);
lval var_214;
var_214 = LVI_NIL();
{
lval vs[8];
vs[0] = LVI_PROC(fn_209,NULL,1);
vs[1] = var_163[0];
vs[2] = var_214;
var_214 = wile_map(NULL, vs);
}
lval var_215;
{
lval vs[8];
vs[0] = LVI_PROC(fn_204,var_205,2);
vs[1] = var_214;
var_215 = wile_list_sort(NULL, vs);
}
lval var_216;
lval var_217[8];
var_217[0] = var_215;
var_216 = fn_185(var_186, var_217);
var_183 = var_216;
}
return var_183;
}
// end of function fn_10

// @@@ (symbol-lookup box? env sym) @@@ bld-rtl-dir/wile-rtl2-000078.scm:92 @@@ fn_11 @@@
static lval fn_11(lptr* var_219, lptr var_220)
{
lbl_221:;
lval var_222;
do {
lval var_223;
var_223 = LVI_BOOL(var_220[1].vt == LV_NIL);
if (!LV_IS_FALSE(var_223)) {
lval var_224;
var_224 = LVI_STRING("symbol \'%s\' lookup failed!");
lval var_227[8];
var_227[0] = var_224;
lval var_228[8];
var_228[0] = var_220[2];
var_220[1] = wile_gen_list(1, var_228, NULL);
var_220[0] = var_227[0];
TAIL_CALL fn_7(NULL, var_220);
}
lval var_229;
if (var_220[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_229 = (var_220[1].v.pair.car ? *(var_220[1].v.pair.car) : LVI_NIL());
lval var_230;
lval var_231[8];
var_231[0] = var_229;
var_230 = fn_3(NULL, var_231);
lval var_233;
var_233 = LVI_BOOL(strcmp(var_220[2].v.str, var_230.v.str) == 0);
if (!LV_IS_FALSE(var_233)) {
lval var_234;
if (LV_IS_FALSE(var_220[0])) {
lval var_235;
if (var_220[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_235 = (var_220[1].v.pair.car ? *(var_220[1].v.pair.car) : LVI_NIL());
lval var_238[8];
var_238[0] = var_235;
var_220[0] = var_238[0];
TAIL_CALL fn_4(NULL, var_220);
} else {
lval var_239;
if (var_220[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_239 = (var_220[1].v.pair.car ? *(var_220[1].v.pair.car) : LVI_NIL());
var_234 = var_239;
}
var_222 = var_234;
break;
}
lval var_240;
if (var_220[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_240 = (var_220[1].v.pair.cdr ? *(var_220[1].v.pair.cdr) : LVI_NIL());
lval var_243[8];
var_243[0] = var_220[0];
var_243[1] = var_240;
var_243[2] = var_220[2];
var_220[0] = var_243[0];
var_220[1] = var_243[1];
var_220[2] = var_243[2];
goto lbl_221;	// selfie
} while (0);
return var_222;
}
// end of function fn_11

// @@@ (eval-binding env expr) @@@ bld-rtl-dir/wile-rtl2-000078.scm:99 @@@ fn_12 @@@
static lval fn_12(lptr* var_244, lptr var_245)
{
lval var_247;
lval var_248;
var_248 = LVI_BOOL(true);
do {
lval var_249;
var_249 = LVI_BOOL(var_245[1].vt == LV_PAIR);
var_248 = var_249;
if (LV_IS_FALSE(var_248)) { break; }
lval var_250;
if (var_245[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_250 = (var_245[1].v.pair.car ? *(var_245[1].v.pair.car) : LVI_NIL());
lval var_251;
var_251 = LVI_BOOL(var_250.vt == LV_SYMBOL);
var_248 = var_251;
if (LV_IS_FALSE(var_248)) { break; }
} while (0);
if (LV_IS_FALSE(var_248)) {
lval var_252;
var_252 = LVI_STRING("malformed binding expression \'%v\'");
lval var_255[8];
var_255[0] = var_252;
lval var_256[8];
var_256[0] = var_245[1];
var_245[1] = wile_gen_list(1, var_256, NULL);
var_245[0] = var_255[0];
TAIL_CALL fn_7(NULL, var_245);
} else {
lval var_257;
if (var_245[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_257 = (var_245[1].v.pair.car ? *(var_245[1].v.pair.car) : LVI_NIL());
lval var_258;
var_258 = LVI_STRING("cadr");
lval var_259;
{
char* cp = strchr(var_258.v.str, 'r');
var_259 = var_245[1];
while (*(--cp) != 'c') {
if (var_259.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_259 = (var_259.v.pair.car ? *(var_259.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_259 = (var_259.v.pair.cdr ? *(var_259.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_258.v.str);
}
}
}
lval var_260;
lval var_261[8];
var_261[0] = var_245[0];
var_261[1] = var_259;
var_260 = wile_eval(NULL, var_261);
lval var_265[8];
var_265[0] = var_257;
var_265[1] = var_260;
var_245[0] = var_265[0];
var_245[1] = var_265[1];
TAIL_CALL fn_1(NULL, var_245);
}
return var_247;
}
// end of function fn_12

// @@@ (eval-define macro env expr) @@@ bld-rtl-dir/wile-rtl2-000078.scm:106 @@@ wile_eval_define @@@
lval wile_eval_define(lptr* var_266, lptr var_267)
{
lval var_269;
lval var_270;
do {
lval var_271;
if (var_267[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_271 = (var_267[2].v.pair.car ? *(var_267[2].v.pair.car) : LVI_NIL());
lval var_272;
var_272 = LVI_BOOL(var_271.vt == LV_SYMBOL);
if (!LV_IS_FALSE(var_272)) {
lval var_273;
lval var_274[8];
var_274[0] = var_267[1];
var_274[1] = var_267[2];
var_273 = fn_12(NULL, var_274);
var_270 = var_273;
break;
}
lval var_276;
var_276 = LVI_BOOL(true);
do {
lval var_277;
if (var_267[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_277 = (var_267[2].v.pair.car ? *(var_267[2].v.pair.car) : LVI_NIL());
lval var_278;
var_278 = LVI_BOOL(var_277.vt == LV_PAIR);
var_276 = var_278;
if (LV_IS_FALSE(var_276)) { break; }
lval var_279;
var_279 = LVI_STRING("caar");
lval var_280;
{
char* cp = strchr(var_279.v.str, 'r');
var_280 = var_267[2];
while (*(--cp) != 'c') {
if (var_280.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_280 = (var_280.v.pair.car ? *(var_280.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_280 = (var_280.v.pair.cdr ? *(var_280.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_279.v.str);
}
}
}
lval var_281;
var_281 = LVI_BOOL(var_280.vt == LV_SYMBOL);
var_276 = var_281;
if (LV_IS_FALSE(var_276)) { break; }
} while (0);
if (!LV_IS_FALSE(var_276)) {
lval var_282;
var_282 = LVI_STRING("caar");
lval var_283;
{
char* cp = strchr(var_282.v.str, 'r');
var_283 = var_267[2];
while (*(--cp) != 'c') {
if (var_283.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_283 = (var_283.v.pair.car ? *(var_283.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_283 = (var_283.v.pair.cdr ? *(var_283.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_282.v.str);
}
}
}
lval var_284;
var_284 = LVI_SYMBOL("lambda");
lval var_285;
var_285 = LVI_STRING("cdar");
lval var_286;
{
char* cp = strchr(var_285.v.str, 'r');
var_286 = var_267[2];
while (*(--cp) != 'c') {
if (var_286.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_286 = (var_286.v.pair.car ? *(var_286.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_286 = (var_286.v.pair.cdr ? *(var_286.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_285.v.str);
}
}
}
lval var_287;
if (var_267[2].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_287 = (var_267[2].v.pair.cdr ? *(var_267[2].v.pair.cdr) : LVI_NIL());
lval var_288;
{
lptr p1 = NULL, p2 = NULL;
if (var_286.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_286;
}
if (var_287.vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_287;
}
var_288 = LVI_PAIR(p1, p2);
}
lval var_289;
{
lptr p1 = NULL, p2 = NULL;
if (var_284.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_284;
}
if (var_288.vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_288;
}
var_289 = LVI_PAIR(p1, p2);
}
lval var_290;
{
lval vs[2];
vs[0] = var_283;
vs[1] = var_289;
var_290 = wile_gen_list(2, vs, NULL);
}
lval var_291;
lval var_292[8];
var_292[0] = var_267[1];
var_292[1] = var_290;
var_291 = fn_12(NULL, var_292);
var_270 = var_291;
break;
}
lval var_294;
var_294 = LVI_STRING("malformed \'define\' expression \'%v\'");
lval var_295;
lval var_296[8];
var_296[0] = var_294;
lval var_298[8];
var_298[0] = var_267[2];
var_296[1] = wile_gen_list(1, var_298, NULL);
var_295 = fn_7(NULL, var_296);
var_270 = var_295;
} while (0);
var_269 = var_270;
lval var_299;
lval var_300;
lval var_301[8];
var_301[0] = var_269;
var_300 = fn_4(NULL, var_301);
var_299 = var_300;
lval var_303;
lval var_304;
{
lptr p1 = NULL, p2 = NULL;
if (var_269.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_269;
}
if (var_267[1].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_267[1];
}
var_304 = LVI_PAIR(p1, p2);
}
var_303 = var_304;
lval var_306;
var_306 = LVI_BOOL(var_299.vt == LV_ILAMBDA);
if (LV_IS_FALSE(var_306)) {
(void)
 LVI_BOOL(false);
} else {
if (var_299.vt == LV_ILAMBDA && var_267[0].vt == LV_BOOL) {
var_299.v.ilambda->macro = var_267[0].v.bv;
} else {
WILE_EX("set-interpreted-procedure-macro!", "expects an interpreted procedure and a boolean");
}
if (var_299.vt == LV_ILAMBDA && var_303.vt == LV_PAIR) {
var_299.v.ilambda->env = var_303;
} else {
WILE_EX("set-interpreted-procedure-environment!", "expects an interpreted procedure and an environment list");
}
}
return var_303;
}
// end of function wile_eval_define

// @@@ lambda (es) @@@ bld-rtl-dir/wile-rtl2-000078.scm:126 @@@ fn_315 @@@
static lval fn_315(lptr* var_316, lptr var_317)
{
lbl_318:;
lval var_319;
lval var_320;
lval var_321;
if (var_317[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_321 = (var_317[0].v.pair.car ? *(var_317[0].v.pair.car) : LVI_NIL());
lval var_322;
lval var_323[8];
var_323[0] = var_321;
var_322 = wile_eval_define_form(NULL, var_323);
if (LV_IS_FALSE(var_322)) {
lval var_325;
if (var_317[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_325 = (var_317[0].v.pair.car ? *(var_317[0].v.pair.car) : LVI_NIL());
lval var_326;
lval var_327[8];
var_327[0] = V_CLOS(var_316,0);
var_327[1] = var_325;
var_326 = wile_eval(NULL, var_327);
var_320 = var_326;
} else {
lval var_329;
var_329 = LVI_STRING("caar");
lval var_330;
{
char* cp = strchr(var_329.v.str, 'r');
var_330 = var_317[0];
while (*(--cp) != 'c') {
if (var_330.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_330 = (var_330.v.pair.car ? *(var_330.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_330 = (var_330.v.pair.cdr ? *(var_330.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_329.v.str);
}
}
}
lval var_331;
var_331 = LVI_SYMBOL("defmacro");
lval var_332;
var_332 = LVI_BOOL(strcmp(var_330.v.str, var_331.v.str) == 0);
lval var_333;
var_333 = LVI_STRING("cdar");
lval var_334;
{
char* cp = strchr(var_333.v.str, 'r');
var_334 = var_317[0];
while (*(--cp) != 'c') {
if (var_334.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_334 = (var_334.v.pair.car ? *(var_334.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_334 = (var_334.v.pair.cdr ? *(var_334.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_333.v.str);
}
}
}
lval var_335;
lval var_336[8];
var_336[0] = var_332;
var_336[1] = V_CLOS(var_316,0);
var_336[2] = var_334;
var_335 = wile_eval_define(NULL, var_336);
V_CLOS(var_316,0) = var_335;
lval var_338;
if (V_CLOS(var_316,0).vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_338 = (V_CLOS(var_316,0).v.pair.car ? *(V_CLOS(var_316,0).v.pair.car) : LVI_NIL());
lval var_339;
lval var_340[8];
var_340[0] = var_338;
var_339 = fn_4(NULL, var_340);
var_320 = var_339;
}
var_319 = var_320;
lval var_342;
lval var_343;
if (var_317[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_343 = (var_317[0].v.pair.cdr ? *(var_317[0].v.pair.cdr) : LVI_NIL());
lval var_344;
var_344 = LVI_BOOL(var_343.vt == LV_NIL);
if (LV_IS_FALSE(var_344)) {
lval var_345;
if (var_317[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_345 = (var_317[0].v.pair.cdr ? *(var_317[0].v.pair.cdr) : LVI_NIL());
lval var_348[8];
var_348[0] = var_345;
var_317[0] = var_348[0];
goto lbl_318;	// selfie
} else {
var_342 = var_319;
}
return var_342;
}
// end of lambda fn_315

// @@@ (eval-begin env expr) @@@ bld-rtl-dir/wile-rtl2-000078.scm:123 @@@ fn_13 @@@
static lval fn_13(lptr* var_310, lptr var_311)
{
lval var_313;
lval var_314;
var_314 = LVI_BOOL(var_311[1].vt == LV_NIL);
if (LV_IS_FALSE(var_314)) {
MK_CLOS(var_316,1);
P_CLOS(var_316,0) = &(var_311[0]);
lval var_349;
lval var_350[8];
var_350[0] = var_311[1];
var_349 = fn_315(var_316, var_350);
var_313 = var_349;
} else {
lval var_352;
var_352 = LVI_NIL();
var_313 = var_352;
}
return var_313;
}
// end of function fn_13

// @@@ lambda (a1) @@@ bld-rtl-dir/wile-rtl2-000078.scm:141 @@@ fn_370 @@@
static lval fn_370(lptr* var_371, lptr var_372)
{
lval var_374;
var_374 = LVI_STRING("caddr");
lval var_375;
{
char* cp = strchr(var_374.v.str, 'r');
var_375 = var_372[0];
while (*(--cp) != 'c') {
if (var_375.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_375 = (var_375.v.pair.car ? *(var_375.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_375 = (var_375.v.pair.cdr ? *(var_375.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_374.v.str);
}
}
}
return var_375;
}
// end of lambda fn_370

// @@@ lambda (a1) @@@ bld-rtl-dir/wile-rtl2-000078.scm:141 @@@ fn_376 @@@
static lval fn_376(lptr* var_377, lptr var_378)
{
lval var_380;
var_380 = LVI_STRING("cadr");
lval var_381;
{
char* cp = strchr(var_380.v.str, 'r');
var_381 = var_378[0];
while (*(--cp) != 'c') {
if (var_381.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_381 = (var_381.v.pair.car ? *(var_381.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_381 = (var_381.v.pair.cdr ? *(var_381.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_380.v.str);
}
}
}
return var_381;
}
// end of lambda fn_376

// @@@ (eval-if env exprs) @@@ bld-rtl-dir/wile-rtl2-000078.scm:138 @@@ fn_14 @@@
static lval fn_14(lptr* var_353, lptr var_354)
{
lval var_356;
lval var_357;
var_357 = LVI_INT(3);
lval var_358;
{
lval vs[8];
vs[0] = var_357;
vs[1] = var_354[1];
var_358 = wile_list_length_eq(NULL, vs);
}
if (LV_IS_FALSE(var_358)) {
lval var_359;
var_359 = LVI_STRING("malformed \'if\' expression \'%v\'");
lval var_362[8];
var_362[0] = var_359;
lval var_363[8];
var_363[0] = var_354[1];
var_354[1] = wile_gen_list(1, var_363, NULL);
var_354[0] = var_362[0];
TAIL_CALL fn_7(NULL, var_354);
} else {
lval var_364;
lval var_365;
if (var_354[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_365 = (var_354[1].v.pair.car ? *(var_354[1].v.pair.car) : LVI_NIL());
lval var_366;
lval var_367[8];
var_367[0] = var_354[0];
var_367[1] = var_365;
var_366 = wile_eval(NULL, var_367);
var_364 = var_366;
lval var_369;
if (LV_IS_FALSE(var_364)) {
MK_CLOS(var_371,0);
var_369 = LVI_PROC(fn_370,var_371,1);
} else {
MK_CLOS(var_377,0);
var_369 = LVI_PROC(fn_376,var_377,1);
}
lval var_382;
{
lval vs[1];
vs[0] = var_354[1];
var_382 = wile_gen_list(1, vs, NULL);
}
lval var_383;
{
lval vs[2];
vs[0] = var_369;
vs[1] = var_382;
var_383 = wile_gen_list(2, vs, NULL);
}
var_383 = wile_apply_function(&(var_383), __FILE__, __LINE__);
lval var_386[8];
var_386[0] = var_354[0];
var_386[1] = var_383;
var_354[0] = var_386[0];
var_354[1] = var_386[1];
TAIL_CALL wile_eval(NULL, var_354);
}
return var_356;
}
// end of function fn_14

// @@@ (eval-and init env exprs) @@@ bld-rtl-dir/wile-rtl2-000078.scm:144 @@@ fn_15 @@@
static lval fn_15(lptr* var_387, lptr var_388)
{
lbl_389:;
lval var_390;
do {
lval var_391;
var_391 = LVI_BOOL(LV_IS_FALSE(var_388[0]));
if (!LV_IS_FALSE(var_391)) {
var_390 = var_388[0];
break;
}
lval var_392;
var_392 = LVI_BOOL(var_388[2].vt == LV_NIL);
if (!LV_IS_FALSE(var_392)) {
var_390 = var_388[0];
break;
}
lval var_393;
if (var_388[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_393 = (var_388[2].v.pair.car ? *(var_388[2].v.pair.car) : LVI_NIL());
lval var_394;
lval var_395[8];
var_395[0] = var_388[1];
var_395[1] = var_393;
var_394 = wile_eval(NULL, var_395);
lval var_397;
if (var_388[2].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_397 = (var_388[2].v.pair.cdr ? *(var_388[2].v.pair.cdr) : LVI_NIL());
lval var_400[8];
var_400[0] = var_394;
var_400[1] = var_388[1];
var_400[2] = var_397;
var_388[0] = var_400[0];
var_388[1] = var_400[1];
var_388[2] = var_400[2];
goto lbl_389;	// selfie
} while (0);
return var_390;
}
// end of function fn_15

// @@@ (eval-or init env exprs) @@@ bld-rtl-dir/wile-rtl2-000078.scm:150 @@@ fn_16 @@@
static lval fn_16(lptr* var_401, lptr var_402)
{
lbl_403:;
lval var_404;
do {
if (!LV_IS_FALSE(var_402[0])) {
var_404 = var_402[0];
break;
}
lval var_405;
var_405 = LVI_BOOL(var_402[2].vt == LV_NIL);
if (!LV_IS_FALSE(var_405)) {
var_404 = var_402[0];
break;
}
lval var_406;
if (var_402[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_406 = (var_402[2].v.pair.car ? *(var_402[2].v.pair.car) : LVI_NIL());
lval var_407;
lval var_408[8];
var_408[0] = var_402[1];
var_408[1] = var_406;
var_407 = wile_eval(NULL, var_408);
lval var_410;
if (var_402[2].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_410 = (var_402[2].v.pair.cdr ? *(var_402[2].v.pair.cdr) : LVI_NIL());
lval var_413[8];
var_413[0] = var_407;
var_413[1] = var_402[1];
var_413[2] = var_410;
var_402[0] = var_413[0];
var_402[1] = var_413[1];
var_402[2] = var_413[2];
goto lbl_403;	// selfie
} while (0);
return var_404;
}
// end of function fn_16

// @@@ lambda (bv) @@@ bld-rtl-dir/wile-rtl2-000078.scm:161 @@@ fn_437 @@@
static lval fn_437(lptr* var_438, lptr var_439)
{
lval var_441;
lval var_442;
{
var_442 = var_439[0];
while (var_442.vt == LV_PAIR) {
var_442 = (var_442.v.pair.cdr ? *(var_442.v.pair.cdr) : LVI_NIL());
}
var_442 = LVI_BOOL(var_442.vt == LV_NIL);
}
if (LV_IS_FALSE(var_442)) {
lval var_443;
var_443 = LVI_STRING("malformed \'%s\' binding \'%v\' is not a list");
lval var_446[8];
var_446[0] = var_443;
lval var_447[8];
var_447[0] = V_CLOS(var_438,0);
var_447[1] = var_439[0];
var_439[1] = wile_gen_list(2, var_447, NULL);
var_439[0] = var_446[0];
TAIL_CALL fn_7(NULL, var_439);
} else {
lval var_448;
var_448 = LVI_BOOL(false);
var_441 = var_448;
}
return var_441;
}
// end of lambda fn_437

// @@@ car @@@ bld-rtl-dir/wile-rtl2-000078.scm:166 @@@ fn_451 @@@
static lval fn_451(lptr* var_452, lptr var_453)
{
lval var_455;
if (var_453[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_455 = (var_453[0].v.pair.car ? *(var_453[0].v.pair.car) : LVI_NIL());
return var_455;
}
// end of prim fn_451

// @@@ (check-let-bindings type llist) @@@ bld-rtl-dir/wile-rtl2-000078.scm:156 @@@ fn_17 @@@
static lval fn_17(lptr* var_414, lptr var_415)
{
lval var_417;
lval var_418;
var_418 = LVI_BOOL(true);
do {
lval var_419;
{
var_419 = var_415[1];
while (var_419.vt == LV_PAIR) {
var_419 = (var_419.v.pair.cdr ? *(var_419.v.pair.cdr) : LVI_NIL());
}
var_419 = LVI_BOOL(var_419.vt == LV_NIL);
}
var_418 = var_419;
if (LV_IS_FALSE(var_418)) { break; }
lval var_420;
var_420 = LVI_INT(2);
lval var_421;
{
lval vs[8];
vs[0] = var_420;
vs[1] = var_415[1];
var_421 = wile_list_length_ge(NULL, vs);
}
var_418 = var_421;
if (LV_IS_FALSE(var_418)) { break; }
} while (0);
if (LV_IS_FALSE(var_418)) {
lval var_422;
var_422 = LVI_STRING("malformed \'%s\' expression \'%v\'");
lval var_425[8];
var_425[0] = var_422;
lval var_426[8];
var_426[0] = var_415[0];
var_426[1] = var_415[1];
var_415[1] = wile_gen_list(2, var_426, NULL);
var_415[0] = var_425[0];
TAIL_CALL fn_7(NULL, var_415);
} else {
lval var_427;
lval var_428;
if (var_415[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_428 = (var_415[1].v.pair.car ? *(var_415[1].v.pair.car) : LVI_NIL());
var_427 = var_428;
lval var_430;
{
var_430 = var_427;
while (var_430.vt == LV_PAIR) {
var_430 = (var_430.v.pair.cdr ? *(var_430.v.pair.cdr) : LVI_NIL());
}
var_430 = LVI_BOOL(var_430.vt == LV_NIL);
}
if (LV_IS_FALSE(var_430)) {
lval var_431;
var_431 = LVI_STRING("malformed \'%s\' bindings \'%v\' are not a list");
lval var_433[8];
var_433[0] = var_431;
lval var_435[8];
var_435[0] = var_415[0];
var_435[1] = var_427;
var_433[1] = wile_gen_list(2, var_435, NULL);
(void)
 fn_7(NULL, var_433);
} else {
(void)
 LVI_BOOL(false);
}
MK_CLOS(var_438,1);
P_CLOS(var_438,0) = &(var_415[0]);
lval var_449;
var_449 = LVI_NIL();
{
lval vs[8];
vs[0] = LVI_PROC(fn_437,var_438,1);
vs[1] = var_427;
vs[2] = var_449;
var_449 = wile_for_each(NULL, vs);
}
lval var_450;
lval var_456;
var_456 = LVI_NIL();
{
lval vs[8];
vs[0] = LVI_PROC(fn_451,NULL,1);
vs[1] = var_427;
vs[2] = var_456;
var_456 = wile_map(NULL, vs);
}
var_450 = var_456;
lval var_457;
lval var_458;
lval var_459[8];
var_459[0] = var_450;
var_458 = fn_10(NULL, var_459);
if (LV_IS_FALSE(var_458)) {
lval var_461;
var_461 = LVI_STRING("malformed \'%s\' bindings list \'%v\'");
lval var_464[8];
var_464[0] = var_461;
lval var_465[8];
var_465[0] = var_415[0];
var_465[1] = var_450;
var_415[1] = wile_gen_list(2, var_465, NULL);
var_415[0] = var_464[0];
TAIL_CALL fn_7(NULL, var_415);
} else {
lval var_466;
var_466 = LVI_BOOL(false);
var_457 = var_466;
}
var_417 = var_457;
}
return var_417;
}
// end of function fn_17

// @@@ car @@@ bld-rtl-dir/wile-rtl2-000078.scm:176 @@@ fn_487 @@@
static lval fn_487(lptr* var_488, lptr var_489)
{
lval var_491;
if (var_489[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_491 = (var_489[0].v.pair.car ? *(var_489[0].v.pair.car) : LVI_NIL());
return var_491;
}
// end of prim fn_487

// @@@ lambda (v) @@@ bld-rtl-dir/wile-rtl2-000078.scm:177 @@@ fn_496 @@@
static lval fn_496(lptr* var_497, lptr var_498)
{
lval var_500;
var_500 = LVI_STRING("cadr");
lval var_501;
{
char* cp = strchr(var_500.v.str, 'r');
var_501 = var_498[0];
while (*(--cp) != 'c') {
if (var_501.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_501 = (var_501.v.pair.car ? *(var_501.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_501 = (var_501.v.pair.cdr ? *(var_501.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_500.v.str);
}
}
}
lval var_504[8];
var_504[0] = V_CLOS(var_497,0);
var_504[1] = var_501;
var_498[0] = var_504[0];
var_498[1] = var_504[1];
TAIL_CALL wile_eval(NULL, var_498);
}
// end of lambda fn_496

// @@@ lambda (iex) @@@ bld-rtl-dir/wile-rtl2-000078.scm:185 @@@ fn_533 @@@
static lval fn_533(lptr* var_534, lptr var_535)
{
lval var_537;
lval var_538;
lval var_539[8];
var_539[0] = V_CLOS(var_534,0);
var_539[1] = var_535[0];
var_538 = fn_12(NULL, var_539);
var_537 = var_538;
if (LV_IS_FALSE(V_CLOS(var_534,1))) {
(void)
 LVI_BOOL(false);
} else {
lval var_543;
{
lptr p1 = NULL, p2 = NULL;
if (var_537.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_537;
}
if (V_CLOS(var_534,0).vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = V_CLOS(var_534,0);
}
var_543 = LVI_PAIR(p1, p2);
}
V_CLOS(var_534,0) = var_543;
(void)
 V_CLOS(var_534,0);
}
return var_537;
}
// end of lambda fn_533

// @@@ (eval-let star? env exprs) @@@ bld-rtl-dir/wile-rtl2-000078.scm:171 @@@ fn_18 @@@
static lval fn_18(lptr* var_467, lptr var_468)
{
lval var_470;
do {
lval var_471;
var_471 = LVI_BOOL(var_468[2].vt == LV_NIL);
if (!LV_IS_FALSE(var_471)) {
lval var_472;
var_472 = LVI_STRING("malformed \'let\' expression \'%v\'");
lval var_475[8];
var_475[0] = var_472;
lval var_476[8];
var_476[0] = var_468[2];
var_468[1] = wile_gen_list(1, var_476, NULL);
var_468[0] = var_475[0];
TAIL_CALL fn_7(NULL, var_468);
}
lval var_477;
var_477 = LVI_BOOL(true);
do {
lval var_478;
{
var_478 = var_468[2];
while (var_478.vt == LV_PAIR) {
var_478 = (var_478.v.pair.cdr ? *(var_478.v.pair.cdr) : LVI_NIL());
}
var_478 = LVI_BOOL(var_478.vt == LV_NIL);
}
var_477 = var_478;
if (LV_IS_FALSE(var_477)) { break; }
lval var_479;
if (var_468[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_479 = (var_468[2].v.pair.car ? *(var_468[2].v.pair.car) : LVI_NIL());
lval var_480;
var_480 = LVI_BOOL(var_479.vt == LV_SYMBOL);
var_477 = var_480;
if (LV_IS_FALSE(var_477)) { break; }
} while (0);
if (!LV_IS_FALSE(var_477)) {
lval var_481;
var_481 = LVI_STRING("named-let");
lval var_482;
if (var_468[2].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_482 = (var_468[2].v.pair.cdr ? *(var_468[2].v.pair.cdr) : LVI_NIL());
lval var_484[8];
var_484[0] = var_481;
var_484[1] = var_482;
(void)
 fn_17(NULL, var_484);
lval var_486;
lval var_492;
var_492 = LVI_STRING("cadr");
lval var_493;
{
char* cp = strchr(var_492.v.str, 'r');
var_493 = var_468[2];
while (*(--cp) != 'c') {
if (var_493.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_493 = (var_493.v.pair.car ? *(var_493.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_493 = (var_493.v.pair.cdr ? *(var_493.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_492.v.str);
}
}
}
lval var_494;
var_494 = LVI_NIL();
{
lval vs[8];
vs[0] = LVI_PROC(fn_487,NULL,1);
vs[1] = var_493;
vs[2] = var_494;
var_494 = wile_map(NULL, vs);
}
var_486 = var_494;
lval var_495;
MK_CLOS(var_497,1);
P_CLOS(var_497,0) = &(var_468[1]);
lval var_505;
var_505 = LVI_STRING("cadr");
lval var_506;
{
char* cp = strchr(var_505.v.str, 'r');
var_506 = var_468[2];
while (*(--cp) != 'c') {
if (var_506.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_506 = (var_506.v.pair.car ? *(var_506.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_506 = (var_506.v.pair.cdr ? *(var_506.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_505.v.str);
}
}
}
lval var_507;
var_507 = LVI_NIL();
{
lval vs[8];
vs[0] = LVI_PROC(fn_496,var_497,1);
vs[1] = var_506;
vs[2] = var_507;
var_507 = wile_map(NULL, vs);
}
var_495 = var_507;
lval var_508;
lval var_509;
{
lval vs[8];
vs[0] = var_486;
var_509 = wile_list_length(NULL, vs);
}
lval var_510;
var_510 = LVI_STRING("cddr");
lval var_511;
{
char* cp = strchr(var_510.v.str, 'r');
var_511 = var_468[2];
while (*(--cp) != 'c') {
if (var_511.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_511 = (var_511.v.pair.car ? *(var_511.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_511 = (var_511.v.pair.cdr ? *(var_511.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_510.v.str);
}
}
}
lval var_512;
var_512 = LVI_NIL();
lval var_513;
var_513 = LVI_BOOL(false);
lval var_514;
if ((var_486.vt == LV_PAIR || var_486.vt == LV_NIL) && var_509.vt == LV_INT &&(var_511.vt == LV_PAIR || var_511.vt == LV_NIL) &&(var_512.vt == LV_PAIR || var_512.vt == LV_NIL) && var_513.vt == LV_BOOL) {
var_514.vt = LV_ILAMBDA;
var_514.v.ilambda = LISP_ALLOC(lisp_ifunc_t, 1);
if (var_514.v.ilambda == NULL) {
WILE_EX("make-interpreted-procedure", "memory allocation failed!");
}
var_514.v.ilambda->args = var_486;
var_514.v.ilambda->arity = var_509.v.iv;
var_514.v.ilambda->body = var_511;
var_514.v.ilambda->env = var_512;
var_514.v.ilambda->macro = var_513.v.bv;
} else {
WILE_EX("make-interpreted-procedure", "expects a list of arguments, an integer arity, a list of body expressions, an environment list, and a macro boolean");
}
var_508 = var_514;
lval var_515;
lval var_516;
if (var_468[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_516 = (var_468[2].v.pair.car ? *(var_468[2].v.pair.car) : LVI_NIL());
lval var_517;
lval var_518[8];
var_518[0] = var_516;
var_518[1] = var_508;
var_517 = fn_1(NULL, var_518);
lval var_520;
{
lptr p1 = NULL, p2 = NULL;
if (var_517.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_517;
}
if (var_468[1].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_468[1];
}
var_520 = LVI_PAIR(p1, p2);
}
var_515 = var_520;
if (var_508.vt == LV_ILAMBDA && var_515.vt == LV_PAIR) {
var_508.v.ilambda->env = var_515;
} else {
WILE_EX("set-interpreted-procedure-environment!", "expects an interpreted procedure and an environment list");
}
lval var_524[8];
var_524[0] = var_508;
var_524[1] = var_495;
var_468[0] = var_524[0];
var_468[1] = var_524[1];
TAIL_CALL wile_eval_apply_lambda(NULL, var_468);
}
lval var_525;
if (LV_IS_FALSE(var_468[0])) {
lval var_526;
var_526 = LVI_STRING("let");
var_525 = var_526;
} else {
lval var_527;
var_527 = LVI_STRING("let*");
var_525 = var_527;
}
lval var_529[8];
var_529[0] = var_525;
var_529[1] = var_468[2];
(void)
 fn_17(NULL, var_529);
lval var_531;
var_531 = var_468[1];
lval var_532;
MK_CLOS(var_534,2);
P_CLOS(var_534,1) = &(var_468[0]);
P_CLOS(var_534,0) = &(var_531);
lval var_544;
if (var_468[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_544 = (var_468[2].v.pair.car ? *(var_468[2].v.pair.car) : LVI_NIL());
lval var_545;
var_545 = LVI_NIL();
{
lval vs[8];
vs[0] = LVI_PROC(fn_533,var_534,1);
vs[1] = var_544;
vs[2] = var_545;
var_545 = wile_map(NULL, vs);
}
var_532 = var_545;
if (LV_IS_FALSE(var_468[0])) {
lval var_547;
{
lval vs[8];
vs[0] = var_532;
var_547 = wile_list_reverse(NULL, vs);
}
lval var_548;
{
lval vs[2];
vs[0] = var_547;
vs[1] = var_468[1];
var_548 = wile_gen_list(2, vs, NULL);
}
{
lval vs[8];
vs[0] = var_548;
var_548 = wile_list_append(NULL, vs);
}
var_531 = var_548;
} else {
(void)
 LVI_BOOL(false);
}
lval var_550;
if (var_468[2].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_550 = (var_468[2].v.pair.cdr ? *(var_468[2].v.pair.cdr) : LVI_NIL());
lval var_553[8];
var_553[0] = var_531;
var_553[1] = var_550;
var_468[0] = var_553[0];
var_468[1] = var_553[1];
TAIL_CALL fn_13(NULL, var_468);
} while (0);
return var_470;
}
// end of function fn_18

// @@@ lambda (iex) @@@ bld-rtl-dir/wile-rtl2-000078.scm:199 @@@ fn_564 @@@
static lval fn_564(lptr* var_565, lptr var_566)
{
lval var_568;
if (var_566[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_568 = (var_566[0].v.pair.car ? *(var_566[0].v.pair.car) : LVI_NIL());
lval var_569;
var_569 = LVI_BOOL(false);
lval var_570;
{
lptr p1 = NULL, p2 = NULL;
if (var_568.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_568;
}
if (var_569.vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_569;
}
var_570 = LVI_PAIR(p1, p2);
}
return var_570;
}
// end of lambda fn_564

// @@@ lambda (iex) @@@ bld-rtl-dir/wile-rtl2-000078.scm:201 @@@ fn_577 @@@
static lval fn_577(lptr* var_578, lptr var_579)
{
lval var_583[8];
var_583[0] = V_CLOS(var_578,0);
var_583[1] = var_579[0];
var_579[0] = var_583[0];
var_579[1] = var_583[1];
TAIL_CALL fn_12(NULL, var_579);
}
// end of lambda fn_577

// @@@ lambda (box) @@@ bld-rtl-dir/wile-rtl2-000078.scm:205 @@@ fn_589 @@@
static lval fn_589(lptr* var_590, lptr var_591)
{
lval var_593;
lval var_594;
lval var_595[8];
var_595[0] = var_591[0];
var_594 = fn_4(NULL, var_595);
var_593 = var_594;
lval var_597;
lval var_598;
var_598 = LVI_BOOL(var_593.vt == LV_ILAMBDA);
if (LV_IS_FALSE(var_598)) {
lval var_599;
var_599 = LVI_BOOL(false);
var_597 = var_599;
} else {
lval var_600;
if (var_593.vt == LV_ILAMBDA && V_CLOS(var_590,0).vt == LV_PAIR) {
var_593.v.ilambda->env = V_CLOS(var_590,0);
var_600 = var_593;
} else {
WILE_EX("set-interpreted-procedure-environment!", "expects an interpreted procedure and an environment list");
}
var_597 = var_600;
}
return var_597;
}
// end of lambda fn_589

// @@@ (eval-letrec env exprs) @@@ bld-rtl-dir/wile-rtl2-000078.scm:194 @@@ fn_19 @@@
static lval fn_19(lptr* var_554, lptr var_555)
{
lval var_557;
lval var_558;
var_558 = LVI_BOOL(var_555[1].vt == LV_NIL);
if (LV_IS_FALSE(var_558)) {
lval var_559;
var_559 = LVI_STRING("letrec");
lval var_561[8];
var_561[0] = var_559;
var_561[1] = var_555[1];
(void)
 fn_17(NULL, var_561);
lval var_563;
MK_CLOS(var_565,0);
lval var_571;
if (var_555[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_571 = (var_555[1].v.pair.car ? *(var_555[1].v.pair.car) : LVI_NIL());
lval var_572;
var_572 = LVI_NIL();
{
lval vs[8];
vs[0] = LVI_PROC(fn_564,var_565,1);
vs[1] = var_571;
vs[2] = var_572;
var_572 = wile_map(NULL, vs);
}
var_563 = var_572;
lval var_573;
lval var_574;
{
lval vs[8];
vs[0] = var_563;
var_574 = wile_list_reverse(NULL, vs);
}
lval var_575;
{
lval vs[2];
vs[0] = var_574;
vs[1] = var_555[0];
var_575 = wile_gen_list(2, vs, NULL);
}
{
lval vs[8];
vs[0] = var_575;
var_575 = wile_list_append(NULL, vs);
}
var_573 = var_575;
lval var_576;
MK_CLOS(var_578,1);
P_CLOS(var_578,0) = &(var_573);
lval var_584;
if (var_555[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_584 = (var_555[1].v.pair.car ? *(var_555[1].v.pair.car) : LVI_NIL());
lval var_585;
var_585 = LVI_NIL();
{
lval vs[8];
vs[0] = LVI_PROC(fn_577,var_578,1);
vs[1] = var_584;
vs[2] = var_585;
var_585 = wile_map(NULL, vs);
}
var_576 = var_585;
lval var_586;
lval var_587;
{
lval vs[8];
vs[0] = var_576;
var_587 = wile_list_reverse(NULL, vs);
}
lval var_588;
{
lval vs[2];
vs[0] = var_587;
vs[1] = var_555[0];
var_588 = wile_gen_list(2, vs, NULL);
}
{
lval vs[8];
vs[0] = var_588;
var_588 = wile_list_append(NULL, vs);
}
var_586 = var_588;
MK_CLOS(var_590,1);
P_CLOS(var_590,0) = &(var_586);
lval var_601;
var_601 = LVI_NIL();
{
lval vs[8];
vs[0] = LVI_PROC(fn_589,var_590,1);
vs[1] = var_576;
vs[2] = var_601;
var_601 = wile_for_each(NULL, vs);
}
lval var_602;
if (var_555[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_602 = (var_555[1].v.pair.cdr ? *(var_555[1].v.pair.cdr) : LVI_NIL());
lval var_605[8];
var_605[0] = var_586;
var_605[1] = var_602;
var_555[0] = var_605[0];
var_555[1] = var_605[1];
TAIL_CALL fn_13(NULL, var_555);
} else {
lval var_606;
var_606 = LVI_STRING("malformed \'letrec\' expression \'%v\'");
lval var_609[8];
var_609[0] = var_606;
lval var_610[8];
var_610[0] = var_555[1];
var_555[1] = wile_gen_list(1, var_610, NULL);
var_555[0] = var_609[0];
TAIL_CALL fn_7(NULL, var_555);
}
return var_557;
}
// end of function fn_19

// @@@ (eval-qq-olist level env expr) @@@ bld-rtl-dir/wile-rtl2-000078.scm:212 @@@ fn_20 @@@
static lval fn_20(lptr* var_611, lptr var_612)
{
lval var_614;
lval var_615;
if (var_612[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_615 = (var_612[2].v.pair.car ? *(var_612[2].v.pair.car) : LVI_NIL());
lval var_616;
lval var_617[8];
var_617[0] = var_612[0];
var_617[1] = var_612[1];
var_617[2] = var_615;
var_616 = fn_21(NULL, var_617);
var_614 = var_616;
lval var_619;
lval var_620;
if (var_612[2].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_620 = (var_612[2].v.pair.cdr ? *(var_612[2].v.pair.cdr) : LVI_NIL());
lval var_621;
lval var_622[8];
var_622[0] = var_612[0];
var_622[1] = var_612[1];
var_622[2] = var_620;
var_621 = fn_21(NULL, var_622);
var_619 = var_621;
lval var_624;
lval var_625;
var_625 = LVI_BOOL(true);
do {
lval var_626;
if (var_612[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_626 = (var_612[2].v.pair.car ? *(var_612[2].v.pair.car) : LVI_NIL());
lval var_627;
var_627 = LVI_BOOL(var_626.vt == LV_PAIR);
var_625 = var_627;
if (LV_IS_FALSE(var_625)) { break; }
lval var_628;
var_628 = LVI_STRING("caar");
lval var_629;
{
char* cp = strchr(var_628.v.str, 'r');
var_629 = var_612[2];
while (*(--cp) != 'c') {
if (var_629.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_629 = (var_629.v.pair.car ? *(var_629.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_629 = (var_629.v.pair.cdr ? *(var_629.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_628.v.str);
}
}
}
lval var_630;
var_630 = LVI_BOOL(var_629.vt == LV_SYMBOL);
var_625 = var_630;
if (LV_IS_FALSE(var_625)) { break; }
lval var_631;
var_631 = LVI_STRING("caar");
lval var_632;
{
char* cp = strchr(var_631.v.str, 'r');
var_632 = var_612[2];
while (*(--cp) != 'c') {
if (var_632.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_632 = (var_632.v.pair.car ? *(var_632.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_632 = (var_632.v.pair.cdr ? *(var_632.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_631.v.str);
}
}
}
lval var_633;
var_633 = LVI_SYMBOL("unquote-splicing");
lval var_634;
var_634 = LVI_BOOL(strcmp(var_632.v.str, var_633.v.str) == 0);
var_625 = var_634;
if (LV_IS_FALSE(var_625)) { break; }
} while (0);
var_624 = var_625;
lval var_635;
if (LV_IS_FALSE(var_624)) {
lval var_636;
{
lptr p1 = NULL, p2 = NULL;
if (var_614.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_614;
}
if (var_619.vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_619;
}
var_636 = LVI_PAIR(p1, p2);
}
var_635 = var_636;
} else {
lval var_637;
{
lval vs[2];
vs[0] = var_614;
vs[1] = var_619;
var_637 = wile_gen_list(2, vs, NULL);
}
{
lval vs[8];
vs[0] = var_637;
var_637 = wile_list_append(NULL, vs);
}
var_635 = var_637;
}
return var_635;
}
// end of function fn_20

// @@@ (eval-qq level env expr) @@@ bld-rtl-dir/wile-rtl2-000078.scm:220 @@@ fn_21 @@@
static lval fn_21(lptr* var_638, lptr var_639)
{
lval var_641;
do {
lval var_642;
lval var_643[8];
var_643[0] = var_639[2];
var_642 = fn_8(NULL, var_643);
if (!LV_IS_FALSE(var_642)) {
var_641 = var_639[2];
break;
}
lval var_645;
var_645 = LVI_BOOL(var_639[2].vt == LV_SYMBOL);
if (!LV_IS_FALSE(var_645)) {
lval var_646;
lval var_647;
switch (var_639[0].vt) {
case LV_REAL:
var_647 = LVI_BOOL(var_639[0].v.rv > 0.0);
break;
case LV_RAT:
var_647 = LVI_BOOL((var_639[0].v.irv.num > 0 && var_639[0].v.irv.den >= 0) || (var_639[0].v.irv.num < 0 && var_639[0].v.irv.den < 0));
break;
case LV_INT:
var_647 = LVI_BOOL(var_639[0].v.iv > 0);
break;
default:
WILE_EX("positive?", "expects a real-valued number");
}
if (LV_IS_FALSE(var_647)) {
lval var_648;
var_648 = LVI_BOOL(false);
lval var_651[8];
var_651[0] = var_648;
var_651[1] = var_639[1];
var_651[2] = var_639[2];
var_639[0] = var_651[0];
var_639[1] = var_651[1];
var_639[2] = var_651[2];
TAIL_CALL fn_11(NULL, var_639);
} else {
var_646 = var_639[2];
}
var_641 = var_646;
break;
}
lval var_652;
var_652 = LVI_BOOL(var_639[2].vt == LV_PAIR);
if (!LV_IS_FALSE(var_652)) {
lval var_653;
lval var_654;
if (var_639[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_654 = (var_639[2].v.pair.car ? *(var_639[2].v.pair.car) : LVI_NIL());
lval var_655;
var_655 = LVI_BOOL(var_654.vt == LV_SYMBOL);
if (LV_IS_FALSE(var_655)) {
lval var_658[8];
var_658[0] = var_639[0];
var_658[1] = var_639[1];
var_658[2] = var_639[2];
var_639[0] = var_658[0];
var_639[1] = var_658[1];
var_639[2] = var_658[2];
TAIL_CALL fn_20(NULL, var_639);
} else {
lval var_659;
do {
lval var_660;
var_660 = LVI_BOOL(false);
do {
lval var_661;
if (var_639[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_661 = (var_639[2].v.pair.car ? *(var_639[2].v.pair.car) : LVI_NIL());
lval var_662;
var_662 = LVI_SYMBOL("unquote");
lval var_663;
var_663 = LVI_BOOL(strcmp(var_661.v.str, var_662.v.str) == 0);
var_660 = var_663;
if (!LV_IS_FALSE(var_660)) { break; }
lval var_664;
if (var_639[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_664 = (var_639[2].v.pair.car ? *(var_639[2].v.pair.car) : LVI_NIL());
lval var_665;
var_665 = LVI_SYMBOL("unquote-splicing");
lval var_666;
var_666 = LVI_BOOL(strcmp(var_664.v.str, var_665.v.str) == 0);
var_660 = var_666;
if (!LV_IS_FALSE(var_660)) { break; }
} while (0);
if (!LV_IS_FALSE(var_660)) {
lval var_667;
lval var_668;
var_668 = LVI_INT(1);
lval var_669;
switch (TYPE_COMBO(var_639[0].vt,var_668.vt)) {
case TYPE_COMBO(LV_INT,LV_INT):
var_669 = LVI_BOOL(var_639[0].v.iv == var_668.v.iv);
break;
case TYPE_COMBO(LV_INT,LV_RAT):
var_669 = LVI_BOOL(var_639[0].v.iv * var_668.v.irv.den == var_668.v.irv.num);
break;
case TYPE_COMBO(LV_INT,LV_REAL):
var_669 = LVI_BOOL(var_639[0].v.iv == var_668.v.rv);
break;
case TYPE_COMBO(LV_RAT,LV_INT):
var_669 = LVI_BOOL(var_639[0].v.irv.num == var_668.v.iv * var_639[0].v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_RAT):
var_669 = LVI_BOOL(var_639[0].v.irv.num * var_668.v.irv.den == var_668.v.irv.num * var_639[0].v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_REAL):
var_669 = LVI_BOOL(var_639[0].v.irv.num == var_668.v.rv * var_639[0].v.irv.den);
break;
case TYPE_COMBO(LV_REAL,LV_INT):
var_669 = LVI_BOOL(var_639[0].v.rv == var_668.v.iv);
break;
case TYPE_COMBO(LV_REAL,LV_RAT):
var_669 = LVI_BOOL(var_639[0].v.rv * var_668.v.irv.den == var_668.v.irv.num);
break;
case TYPE_COMBO(LV_REAL,LV_REAL):
var_669 = LVI_BOOL(var_639[0].v.rv == var_668.v.rv);
break;
default:
WILE_EX("==", "inputs are not real-valued numbers");
break;
}
if (LV_IS_FALSE(var_669)) {
lval var_670;
var_670 = LVI_INT(1);
lval var_671;
{
lval vs[2];
vs[0] = var_639[0];
vs[1] = var_670;
var_671 = wile_gen_list(2, vs, NULL);
}
{
lval vs[8];
vs[0] = var_671;
var_671 = wile_subtract(NULL, vs);
}
lval var_674[8];
var_674[0] = var_671;
var_674[1] = var_639[1];
var_674[2] = var_639[2];
var_639[0] = var_674[0];
var_639[1] = var_674[1];
var_639[2] = var_674[2];
TAIL_CALL fn_20(NULL, var_639);
} else {
lval var_675;
var_675 = LVI_STRING("cadr");
lval var_676;
{
char* cp = strchr(var_675.v.str, 'r');
var_676 = var_639[2];
while (*(--cp) != 'c') {
if (var_676.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_676 = (var_676.v.pair.car ? *(var_676.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_676 = (var_676.v.pair.cdr ? *(var_676.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_675.v.str);
}
}
}
lval var_679[8];
var_679[0] = var_639[1];
var_679[1] = var_676;
var_639[0] = var_679[0];
var_639[1] = var_679[1];
TAIL_CALL wile_eval(NULL, var_639);
}
var_659 = var_667;
break;
}
lval var_680;
if (var_639[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_680 = (var_639[2].v.pair.car ? *(var_639[2].v.pair.car) : LVI_NIL());
lval var_681;
var_681 = LVI_SYMBOL("quasiquote");
lval var_682;
var_682 = LVI_BOOL(strcmp(var_680.v.str, var_681.v.str) == 0);
if (!LV_IS_FALSE(var_682)) {
lval var_683;
var_683 = LVI_INT(1);
lval var_684;
{
lval vs[2];
vs[0] = var_639[0];
vs[1] = var_683;
var_684 = wile_gen_list(2, vs, NULL);
}
{
lval vs[8];
vs[0] = var_684;
var_684 = wile_add(NULL, vs);
}
lval var_687[8];
var_687[0] = var_684;
var_687[1] = var_639[1];
var_687[2] = var_639[2];
var_639[0] = var_687[0];
var_639[1] = var_687[1];
var_639[2] = var_687[2];
TAIL_CALL fn_20(NULL, var_639);
}
lval var_690[8];
var_690[0] = var_639[0];
var_690[1] = var_639[1];
var_690[2] = var_639[2];
var_639[0] = var_690[0];
var_639[1] = var_690[1];
var_639[2] = var_690[2];
TAIL_CALL fn_20(NULL, var_639);
} while (0);
var_653 = var_659;
}
var_641 = var_653;
break;
}
lval var_691;
var_691 = LVI_BOOL(var_639[2].vt == LV_VECTOR);
if (!LV_IS_FALSE(var_691)) {
lval var_692;
{
lval vs[8];
vs[0] = var_639[2];
var_692 = wile_vector2list(NULL, vs);
}
lval var_693;
lval var_694[8];
var_694[0] = var_639[0];
var_694[1] = var_639[1];
var_694[2] = var_692;
var_693 = fn_20(NULL, var_694);
lval var_696;
{
lval vs[8];
vs[0] = var_693;
var_696 = wile_list2vector(NULL, vs);
}
var_641 = var_696;
break;
}
lval var_697;
var_697 = LVI_STRING("malformed \'quasiquote\' expression \'%v\'");
lval var_700[8];
var_700[0] = var_697;
lval var_701[8];
var_701[0] = var_639[2];
var_639[1] = wile_gen_list(1, var_701, NULL);
var_639[0] = var_700[0];
TAIL_CALL fn_7(NULL, var_639);
} while (0);
return var_641;
}
// end of function fn_21

// @@@ (eval-cond env expr) @@@ bld-rtl-dir/wile-rtl2-000078.scm:256 @@@ fn_22 @@@
static lval fn_22(lptr* var_702, lptr var_703)
{
lbl_704:;
lval var_705;
do {
lval var_706;
var_706 = LVI_BOOL(var_703[1].vt == LV_NIL);
if (!LV_IS_FALSE(var_706)) {
lval var_707;
var_707 = LVI_BOOL(false);
var_705 = var_707;
break;
}
lval var_708;
if (var_703[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_708 = (var_703[1].v.pair.car ? *(var_703[1].v.pair.car) : LVI_NIL());
lval var_709;
var_709 = LVI_BOOL(var_708.vt == LV_PAIR);
if (!LV_IS_FALSE(var_709)) {
lval var_710;
lval var_711;
var_711 = LVI_STRING("caar");
lval var_712;
{
char* cp = strchr(var_711.v.str, 'r');
var_712 = var_703[1];
while (*(--cp) != 'c') {
if (var_712.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_712 = (var_712.v.pair.car ? *(var_712.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_712 = (var_712.v.pair.cdr ? *(var_712.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_711.v.str);
}
}
}
lval var_713;
lval var_714[8];
var_714[0] = var_703[0];
var_714[1] = var_712;
var_713 = wile_eval(NULL, var_714);
if (LV_IS_FALSE(var_713)) {
lval var_716;
if (var_703[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_716 = (var_703[1].v.pair.cdr ? *(var_703[1].v.pair.cdr) : LVI_NIL());
lval var_719[8];
var_719[0] = var_703[0];
var_719[1] = var_716;
var_703[0] = var_719[0];
var_703[1] = var_719[1];
goto lbl_704;	// selfie
} else {
lval var_720;
var_720 = LVI_STRING("cdar");
lval var_721;
{
char* cp = strchr(var_720.v.str, 'r');
var_721 = var_703[1];
while (*(--cp) != 'c') {
if (var_721.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_721 = (var_721.v.pair.car ? *(var_721.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_721 = (var_721.v.pair.cdr ? *(var_721.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_720.v.str);
}
}
}
lval var_724[8];
var_724[0] = var_703[0];
var_724[1] = var_721;
var_703[0] = var_724[0];
var_703[1] = var_724[1];
TAIL_CALL fn_13(NULL, var_703);
}
var_705 = var_710;
break;
}
lval var_725;
var_725 = LVI_STRING("malformed \'cond\' expression \'%v\'");
lval var_728[8];
var_728[0] = var_725;
lval var_729[8];
var_729[0] = var_703[1];
var_703[1] = wile_gen_list(1, var_729, NULL);
var_703[0] = var_728[0];
TAIL_CALL fn_7(NULL, var_703);
} while (0);
return var_705;
}
// end of function fn_22

// @@@ (eval-set! env expr) @@@ bld-rtl-dir/wile-rtl2-000078.scm:264 @@@ fn_23 @@@
static lval fn_23(lptr* var_730, lptr var_731)
{
lval var_733;
lval var_734;
var_734 = LVI_BOOL(true);
do {
lval var_735;
var_735 = LVI_BOOL(var_731[1].vt == LV_PAIR);
var_734 = var_735;
if (LV_IS_FALSE(var_734)) { break; }
lval var_736;
if (var_731[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_736 = (var_731[1].v.pair.car ? *(var_731[1].v.pair.car) : LVI_NIL());
lval var_737;
var_737 = LVI_BOOL(var_736.vt == LV_SYMBOL);
var_734 = var_737;
if (LV_IS_FALSE(var_734)) { break; }
lval var_738;
var_738 = LVI_INT(2);
lval var_739;
{
lval vs[8];
vs[0] = var_738;
vs[1] = var_731[1];
var_739 = wile_list_length_eq(NULL, vs);
}
var_734 = var_739;
if (LV_IS_FALSE(var_734)) { break; }
} while (0);
if (LV_IS_FALSE(var_734)) {
lval var_740;
var_740 = LVI_STRING("malformed \'set!\' expression \'%v\'");
lval var_743[8];
var_743[0] = var_740;
lval var_744[8];
var_744[0] = var_731[1];
var_731[1] = wile_gen_list(1, var_744, NULL);
var_731[0] = var_743[0];
TAIL_CALL fn_7(NULL, var_731);
} else {
lval var_745;
lval var_746;
var_746 = LVI_BOOL(true);
lval var_747;
if (var_731[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_747 = (var_731[1].v.pair.car ? *(var_731[1].v.pair.car) : LVI_NIL());
lval var_748;
lval var_749[8];
var_749[0] = var_746;
var_749[1] = var_731[0];
var_749[2] = var_747;
var_748 = fn_11(NULL, var_749);
var_745 = var_748;
lval var_751;
var_751 = LVI_STRING("cadr");
lval var_752;
{
char* cp = strchr(var_751.v.str, 'r');
var_752 = var_731[1];
while (*(--cp) != 'c') {
if (var_752.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_752 = (var_752.v.pair.car ? *(var_752.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_752 = (var_752.v.pair.cdr ? *(var_752.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_751.v.str);
}
}
}
lval var_753;
lval var_754[8];
var_754[0] = var_731[0];
var_754[1] = var_752;
var_753 = wile_eval(NULL, var_754);
lval var_757[8];
var_757[0] = var_745;
var_757[1] = var_753;
(void)
 fn_6(NULL, var_757);
lval var_761[8];
var_761[0] = var_745;
var_731[0] = var_761[0];
TAIL_CALL fn_4(NULL, var_731);
}
return var_733;
}
// end of function fn_23

// @@@ lambda (cs) @@@ bld-rtl-dir/wile-rtl2-000078.scm:279 @@@ fn_786 @@@
static lval fn_786(lptr* var_787, lptr var_788)
{
lbl_789:;
lval var_790;
do {
lval var_791;
var_791 = LVI_BOOL(var_788[0].vt == LV_NIL);
if (!LV_IS_FALSE(var_791)) {
lval var_792;
var_792 = LVI_BOOL(true);
V_CLOS(var_787,0) = var_792;
V_CLOS(var_787,1) = V_CLOS(var_787,2);
var_790 = V_CLOS(var_787,1);
break;
}
lval var_793;
var_793 = LVI_STRING("caar");
lval var_794;
{
char* cp = strchr(var_793.v.str, 'r');
var_794 = var_788[0];
while (*(--cp) != 'c') {
if (var_794.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_794 = (var_794.v.pair.car ? *(var_794.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_794 = (var_794.v.pair.cdr ? *(var_794.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_793.v.str);
}
}
}
lval var_795;
lval var_796[8];
var_796[0] = V_CLOS(var_787,3);
var_796[1] = var_794;
var_795 = wile_eval(NULL, var_796);
if (!LV_IS_FALSE(var_795)) {
lval var_798;
var_798 = LVI_STRING("cdar");
lval var_799;
{
char* cp = strchr(var_798.v.str, 'r');
var_799 = var_788[0];
while (*(--cp) != 'c') {
if (var_799.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_799 = (var_799.v.pair.car ? *(var_799.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_799 = (var_799.v.pair.cdr ? *(var_799.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_798.v.str);
}
}
}
lval var_802[8];
var_802[0] = V_CLOS(var_787,3);
var_802[1] = var_799;
var_788[0] = var_802[0];
var_788[1] = var_802[1];
TAIL_CALL fn_13(NULL, var_788);
}
lval var_803;
if (var_788[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_803 = (var_788[0].v.pair.cdr ? *(var_788[0].v.pair.cdr) : LVI_NIL());
lval var_806[8];
var_806[0] = var_803;
var_788[0] = var_806[0];
goto lbl_789;	// selfie
} while (0);
return var_790;
}
// end of lambda fn_786

// @@@ (eval-guard env expr) @@@ bld-rtl-dir/wile-rtl2-000078.scm:273 @@@ fn_24 @@@
static lval fn_24(lptr* var_762, lptr var_763)
{
lval var_765;
lval var_766;
var_766 = LVI_BOOL(false);
var_765 = var_766;
lval var_767;
lval var_768;
var_768 = LVI_BOOL(false);
var_767 = var_768;
lval var_769;
lval var_770;
{
struct lisp_escape_info var_772;
var_772.errval = NULL;
var_772.next = cachalot;
cachalot = &var_772;
if (setjmp(var_772.cenv) == 0) {
lval var_773;
if (var_763[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_773 = (var_763[1].v.pair.cdr ? *(var_763[1].v.pair.cdr) : LVI_NIL());
lval var_774;
lval var_775[8];
var_775[0] = var_763[0];
var_775[1] = var_773;
var_774 = fn_13(NULL, var_775);
var_770 = var_774;
cachalot = var_772.next;
} else {
lval var_771;
var_771 = (var_772.errval ? *(var_772.errval) : LVI_NIL());
lval var_777;
do {
lval var_778;
var_778 = LVI_BOOL(true);
if (!LV_IS_FALSE(var_778)) {
lval var_779;
lval var_780;
var_780 = LVI_STRING("caar");
lval var_781;
{
char* cp = strchr(var_780.v.str, 'r');
var_781 = var_763[1];
while (*(--cp) != 'c') {
if (var_781.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_781 = (var_781.v.pair.car ? *(var_781.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_781 = (var_781.v.pair.cdr ? *(var_781.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_780.v.str);
}
}
}
lval var_782;
lval var_783[8];
var_783[0] = var_781;
var_783[1] = var_771;
var_782 = fn_1(NULL, var_783);
lval var_785;
{
lptr p1 = NULL, p2 = NULL;
if (var_782.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_782;
}
if (var_763[0].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_763[0];
}
var_785 = LVI_PAIR(p1, p2);
}
var_779 = var_785;
MK_CLOS(var_787,4);
P_CLOS(var_787,3) = &(var_779);
P_CLOS(var_787,2) = &(var_771);
P_CLOS(var_787,1) = &(var_767);
P_CLOS(var_787,0) = &(var_765);
lval var_807;
var_807 = LVI_STRING("cdar");
lval var_808;
{
char* cp = strchr(var_807.v.str, 'r');
var_808 = var_763[1];
while (*(--cp) != 'c') {
if (var_808.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_808 = (var_808.v.pair.car ? *(var_808.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_808 = (var_808.v.pair.cdr ? *(var_808.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_807.v.str);
}
}
}
lval var_809;
lval var_810[8];
var_810[0] = var_808;
var_809 = fn_786(var_787, var_810);
var_777 = var_809;
break;
}
cachalot = var_772.next;
cachalot->errval = var_772.errval;
cachalot->l_whence = 0;
cachalot->c_whence = LISP_WHENCE;
fflush(NULL);
longjmp(cachalot->cenv, 1);
} while (0);
cachalot = var_772.next;
var_770 = var_777;
}
}
var_769 = var_770;
lval var_812;
if (LV_IS_FALSE(var_765)) {
var_812 = var_769;
} else {
lval var_813;
{
lval vs[1];
vs[0] = var_767;
var_813 = wile_gen_list(1, vs, NULL);
}
if (var_813.vt == LV_PAIR && (var_813.v.pair.cdr == NULL || var_813.v.pair.cdr->vt == LV_NIL)) {
var_813 = (var_813.v.pair.car ? *(var_813.v.pair.car) : LVI_NIL());
}
cachalot->errval = new_lv(LV_NIL);
*(cachalot->errval) = var_813;
cachalot->l_whence = 0;
cachalot->c_whence = LISP_WHENCE;
longjmp(cachalot->cenv, 1);
var_812 = var_813;
}
return var_812;
}
// end of function fn_24

// @@@ lambda (cs) @@@ bld-rtl-dir/wile-rtl2-000078.scm:296 @@@ fn_832 @@@
static lval fn_832(lptr* var_833, lptr var_834)
{
lbl_835:;
lval var_836;
lval var_837;
var_837 = LVI_BOOL(var_834[0].vt == LV_NIL);
if (LV_IS_FALSE(var_837)) {
lval var_838;
lval var_839;
var_839 = LVI_BOOL(true);
do {
lval var_840;
if (var_834[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_840 = (var_834[0].v.pair.car ? *(var_834[0].v.pair.car) : LVI_NIL());
lval var_841;
{
var_841 = var_840;
while (var_841.vt == LV_PAIR) {
var_841 = (var_841.v.pair.cdr ? *(var_841.v.pair.cdr) : LVI_NIL());
}
var_841 = LVI_BOOL(var_841.vt == LV_NIL);
}
var_839 = var_841;
if (LV_IS_FALSE(var_839)) { break; }
lval var_842;
var_842 = LVI_BOOL(false);
do {
lval var_843;
var_843 = LVI_BOOL(true);
do {
lval var_844;
var_844 = LVI_STRING("caar");
lval var_845;
{
char* cp = strchr(var_844.v.str, 'r');
var_845 = var_834[0];
while (*(--cp) != 'c') {
if (var_845.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_845 = (var_845.v.pair.car ? *(var_845.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_845 = (var_845.v.pair.cdr ? *(var_845.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_844.v.str);
}
}
}
lval var_846;
{
var_846 = var_845;
while (var_846.vt == LV_PAIR) {
var_846 = (var_846.v.pair.cdr ? *(var_846.v.pair.cdr) : LVI_NIL());
}
var_846 = LVI_BOOL(var_846.vt == LV_NIL);
}
var_843 = var_846;
if (LV_IS_FALSE(var_843)) { break; }
lval var_847;
var_847 = LVI_STRING("caar");
lval var_848;
{
char* cp = strchr(var_847.v.str, 'r');
var_848 = var_834[0];
while (*(--cp) != 'c') {
if (var_848.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_848 = (var_848.v.pair.car ? *(var_848.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_848 = (var_848.v.pair.cdr ? *(var_848.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_847.v.str);
}
}
}
lval var_849;
var_849 = LVI_BOOL(var_848.vt == LV_NIL);
lval var_850;
var_850 = LVI_BOOL(LV_IS_FALSE(var_849));
var_843 = var_850;
if (LV_IS_FALSE(var_843)) { break; }
} while (0);
var_842 = var_843;
if (!LV_IS_FALSE(var_842)) { break; }
lval var_851;
var_851 = LVI_STRING("caar");
lval var_852;
{
char* cp = strchr(var_851.v.str, 'r');
var_852 = var_834[0];
while (*(--cp) != 'c') {
if (var_852.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_852 = (var_852.v.pair.car ? *(var_852.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_852 = (var_852.v.pair.cdr ? *(var_852.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_851.v.str);
}
}
}
lval var_853;
var_853 = LVI_SYMBOL("else");
lval var_854;
var_854 = LVI_BOOL(wile_do_eqv(&(var_852), &(var_853)));
var_842 = var_854;
if (!LV_IS_FALSE(var_842)) { break; }
} while (0);
var_839 = var_842;
if (LV_IS_FALSE(var_839)) { break; }
lval var_855;
var_855 = LVI_STRING("cdar");
lval var_856;
{
char* cp = strchr(var_855.v.str, 'r');
var_856 = var_834[0];
while (*(--cp) != 'c') {
if (var_856.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_856 = (var_856.v.pair.car ? *(var_856.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_856 = (var_856.v.pair.cdr ? *(var_856.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_855.v.str);
}
}
}
lval var_857;
var_857 = LVI_BOOL(var_856.vt == LV_NIL);
lval var_858;
var_858 = LVI_BOOL(LV_IS_FALSE(var_857));
var_839 = var_858;
if (LV_IS_FALSE(var_839)) { break; }
} while (0);
if (LV_IS_FALSE(var_839)) {
lval var_859;
var_859 = LVI_STRING("malformed \'case\' clause \'%v\'");
lval var_860;
if (var_834[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_860 = (var_834[0].v.pair.car ? *(var_834[0].v.pair.car) : LVI_NIL());
lval var_863[8];
var_863[0] = var_859;
lval var_864[8];
var_864[0] = var_860;
var_834[1] = wile_gen_list(1, var_864, NULL);
var_834[0] = var_863[0];
TAIL_CALL fn_7(NULL, var_834);
} else {
lval var_865;
lval var_866;
var_866 = LVI_BOOL(false);
do {
lval var_867;
var_867 = LVI_STRING("caar");
lval var_868;
{
char* cp = strchr(var_867.v.str, 'r');
var_868 = var_834[0];
while (*(--cp) != 'c') {
if (var_868.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_868 = (var_868.v.pair.car ? *(var_868.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_868 = (var_868.v.pair.cdr ? *(var_868.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_867.v.str);
}
}
}
lval var_869;
var_869 = LVI_SYMBOL("else");
lval var_870;
var_870 = LVI_BOOL(wile_do_eqv(&(var_868), &(var_869)));
var_866 = var_870;
if (!LV_IS_FALSE(var_866)) { break; }
lval var_871;
var_871 = LVI_STRING("caar");
lval var_872;
{
char* cp = strchr(var_871.v.str, 'r');
var_872 = var_834[0];
while (*(--cp) != 'c') {
if (var_872.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_872 = (var_872.v.pair.car ? *(var_872.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_872 = (var_872.v.pair.cdr ? *(var_872.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_871.v.str);
}
}
}
lval var_873;
{
lval vs[8];
vs[0] = V_CLOS(var_833,0);
vs[1] = var_872;
var_873 = wile_memv(NULL, vs);
}
var_866 = var_873;
if (!LV_IS_FALSE(var_866)) { break; }
} while (0);
if (LV_IS_FALSE(var_866)) {
lval var_874;
if (var_834[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_874 = (var_834[0].v.pair.cdr ? *(var_834[0].v.pair.cdr) : LVI_NIL());
lval var_877[8];
var_877[0] = var_874;
var_834[0] = var_877[0];
goto lbl_835;	// selfie
} else {
lval var_878;
var_878 = LVI_STRING("cdar");
lval var_879;
{
char* cp = strchr(var_878.v.str, 'r');
var_879 = var_834[0];
while (*(--cp) != 'c') {
if (var_879.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_879 = (var_879.v.pair.car ? *(var_879.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_879 = (var_879.v.pair.cdr ? *(var_879.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_878.v.str);
}
}
}
lval var_882[8];
var_882[0] = V_CLOS(var_833,1);
var_882[1] = var_879;
var_834[0] = var_882[0];
var_834[1] = var_882[1];
TAIL_CALL fn_13(NULL, var_834);
}
var_838 = var_865;
}
var_836 = var_838;
} else {
lval var_883;
var_883 = LVI_BOOL(false);
var_836 = var_883;
}
return var_836;
}
// end of lambda fn_832

// @@@ (eval-case env expr) @@@ bld-rtl-dir/wile-rtl2-000078.scm:293 @@@ fn_25 @@@
static lval fn_25(lptr* var_814, lptr var_815)
{
lval var_817;
lval var_818;
var_818 = LVI_BOOL(true);
do {
lval var_819;
{
var_819 = var_815[1];
while (var_819.vt == LV_PAIR) {
var_819 = (var_819.v.pair.cdr ? *(var_819.v.pair.cdr) : LVI_NIL());
}
var_819 = LVI_BOOL(var_819.vt == LV_NIL);
}
var_818 = var_819;
if (LV_IS_FALSE(var_818)) { break; }
lval var_820;
var_820 = LVI_INT(2);
lval var_821;
{
lval vs[8];
vs[0] = var_820;
vs[1] = var_815[1];
var_821 = wile_list_length_ge(NULL, vs);
}
var_818 = var_821;
if (LV_IS_FALSE(var_818)) { break; }
} while (0);
if (LV_IS_FALSE(var_818)) {
lval var_822;
var_822 = LVI_STRING("malformed \'case\' expression \'%v\'");
lval var_825[8];
var_825[0] = var_822;
lval var_826[8];
var_826[0] = var_815[1];
var_815[1] = wile_gen_list(1, var_826, NULL);
var_815[0] = var_825[0];
TAIL_CALL fn_7(NULL, var_815);
} else {
lval var_827;
lval var_828;
if (var_815[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_828 = (var_815[1].v.pair.car ? *(var_815[1].v.pair.car) : LVI_NIL());
lval var_829;
lval var_830[8];
var_830[0] = var_815[0];
var_830[1] = var_828;
var_829 = wile_eval(NULL, var_830);
var_827 = var_829;
MK_CLOS(var_833,2);
P_CLOS(var_833,1) = &(var_815[0]);
P_CLOS(var_833,0) = &(var_827);
lval var_884;
if (var_815[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_884 = (var_815[1].v.pair.cdr ? *(var_815[1].v.pair.cdr) : LVI_NIL());
lval var_885;
lval var_886[8];
var_886[0] = var_884;
var_885 = fn_832(var_833, var_886);
var_817 = var_885;
}
return var_817;
}
// end of function fn_25

// @@@ lambda (as pl na) @@@ bld-rtl-dir/wile-rtl2-000078.scm:322 @@@ fn_891 @@@
static lval fn_891(lptr* var_892, lptr var_893)
{
lbl_894:;
lval var_895;
do {
lval var_896;
var_896 = LVI_BOOL(var_893[0].vt == LV_NIL);
if (!LV_IS_FALSE(var_896)) {
lval var_897;
{
lval vs[8];
vs[0] = var_893[1];
var_897 = wile_list_reverse(NULL, vs);
}
lval var_898;
{
lval vs[2];
vs[0] = var_893[2];
vs[1] = var_897;
var_898 = wile_gen_list(2, vs, NULL);
}
var_895 = var_898;
break;
}
lval var_899;
var_899 = LVI_BOOL(var_893[0].vt == LV_PAIR);
if (!LV_IS_FALSE(var_899)) {
lval var_900;
if (var_893[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_900 = (var_893[0].v.pair.cdr ? *(var_893[0].v.pair.cdr) : LVI_NIL());
lval var_901;
if (var_893[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_901 = (var_893[0].v.pair.car ? *(var_893[0].v.pair.car) : LVI_NIL());
lval var_902;
{
lptr p1 = NULL, p2 = NULL;
if (var_901.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_901;
}
if (var_893[1].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_893[1];
}
var_902 = LVI_PAIR(p1, p2);
}
lval var_903;
var_903 = LVI_INT(1);
lval var_904;
{
lval vs[2];
vs[0] = var_893[2];
vs[1] = var_903;
var_904 = wile_gen_list(2, vs, NULL);
}
{
lval vs[8];
vs[0] = var_904;
var_904 = wile_add(NULL, vs);
}
lval var_907[8];
var_907[0] = var_900;
var_907[1] = var_902;
var_907[2] = var_904;
var_893[0] = var_907[0];
var_893[1] = var_907[1];
var_893[2] = var_907[2];
goto lbl_894;	// selfie
}
lval var_908;
{
lval vs[1];
vs[0] = var_893[2];
var_908 = wile_gen_list(1, vs, NULL);
}
{
lval vs[8];
vs[0] = var_908;
var_908 = wile_subtract(NULL, vs);
}
lval var_909;
var_909 = LVI_INT(1);
lval var_910;
{
lval vs[2];
vs[0] = var_908;
vs[1] = var_909;
var_910 = wile_gen_list(2, vs, NULL);
}
{
lval vs[8];
vs[0] = var_910;
var_910 = wile_subtract(NULL, vs);
}
lval var_911;
{
lptr p1 = NULL, p2 = NULL;
if (var_893[0].vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_893[0];
}
if (var_893[1].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_893[1];
}
var_911 = LVI_PAIR(p1, p2);
}
lval var_912;
{
lval vs[8];
vs[0] = var_911;
var_912 = wile_list_reverse(NULL, vs);
}
lval var_913;
{
lval vs[2];
vs[0] = var_910;
vs[1] = var_912;
var_913 = wile_gen_list(2, vs, NULL);
}
var_895 = var_913;
} while (0);
return var_895;
}
// end of lambda fn_891

// @@@ (args-list dotted-list) @@@ bld-rtl-dir/wile-rtl2-000078.scm:321 @@@ fn_26 @@@
static lval fn_26(lptr* var_888, lptr var_889)
{
MK_CLOS(var_892,0);
lval var_914;
var_914 = LVI_NIL();
lval var_915;
var_915 = LVI_INT(0);
lval var_916;
lval var_917[8];
var_917[0] = var_889[0];
var_917[1] = var_914;
var_917[2] = var_915;
var_916 = fn_891(var_892, var_917);
return var_916;
}
// end of function fn_26

// @@@ (eval-lambda env expr) @@@ bld-rtl-dir/wile-rtl2-000078.scm:329 @@@ fn_27 @@@
static lval fn_27(lptr* var_919, lptr var_920)
{
lval var_922;
lval var_923;
if (var_920[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_923 = (var_920[1].v.pair.car ? *(var_920[1].v.pair.car) : LVI_NIL());
var_922 = var_923;
lval var_924;
lval var_925;
lval var_926[8];
var_926[0] = var_922;
var_925 = fn_26(NULL, var_926);
var_924 = var_925;
lval var_928;
lval var_929;
if (var_924.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_929 = (var_924.v.pair.car ? *(var_924.v.pair.car) : LVI_NIL());
var_928 = var_929;
lval var_930;
lval var_931;
var_931 = LVI_STRING("cadr");
lval var_932;
{
char* cp = strchr(var_931.v.str, 'r');
var_932 = var_924;
while (*(--cp) != 'c') {
if (var_932.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_932 = (var_932.v.pair.car ? *(var_932.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_932 = (var_932.v.pair.cdr ? *(var_932.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_931.v.str);
}
}
}
var_930 = var_932;
lval var_934;
lval var_935[8];
var_935[0] = var_930;
var_934 = fn_10(NULL, var_935);
if (LV_IS_FALSE(var_934)) {
lval var_937;
var_937 = LVI_STRING("malformed \'lambda\' args list \'%v\'");
lval var_939[8];
var_939[0] = var_937;
lval var_941[8];
var_941[0] = var_922;
var_939[1] = wile_gen_list(1, var_941, NULL);
(void)
 fn_7(NULL, var_939);
} else {
(void)
 LVI_BOOL(false);
}
lval var_943;
if (var_920[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_943 = (var_920[1].v.pair.cdr ? *(var_920[1].v.pair.cdr) : LVI_NIL());
lval var_944;
var_944 = LVI_BOOL(false);
lval var_945;
if ((var_930.vt == LV_PAIR || var_930.vt == LV_NIL) && var_928.vt == LV_INT &&(var_943.vt == LV_PAIR || var_943.vt == LV_NIL) &&(var_920[0].vt == LV_PAIR || var_920[0].vt == LV_NIL) && var_944.vt == LV_BOOL) {
var_945.vt = LV_ILAMBDA;
var_945.v.ilambda = LISP_ALLOC(lisp_ifunc_t, 1);
if (var_945.v.ilambda == NULL) {
WILE_EX("make-interpreted-procedure", "memory allocation failed!");
}
var_945.v.ilambda->args = var_930;
var_945.v.ilambda->arity = var_928.v.iv;
var_945.v.ilambda->body = var_943;
var_945.v.ilambda->env = var_920[0];
var_945.v.ilambda->macro = var_944.v.bv;
} else {
WILE_EX("make-interpreted-procedure", "expects a list of arguments, an integer arity, a list of body expressions, an environment list, and a macro boolean");
}
return var_945;
}
// end of function fn_27

// @@@ (check-syntax-do expr) @@@ bld-rtl-dir/wile-rtl2-000078.scm:338 @@@ fn_28 @@@
static lval fn_28(lptr* var_946, lptr var_947)
{
lval var_949;
var_949 = LVI_BOOL(true);
do {
lval var_950;
{
var_950 = var_947[0];
while (var_950.vt == LV_PAIR) {
var_950 = (var_950.v.pair.cdr ? *(var_950.v.pair.cdr) : LVI_NIL());
}
var_950 = LVI_BOOL(var_950.vt == LV_NIL);
}
var_949 = var_950;
if (LV_IS_FALSE(var_949)) { break; }
lval var_951;
var_951 = LVI_INT(2);
lval var_952;
{
lval vs[8];
vs[0] = var_951;
vs[1] = var_947[0];
var_952 = wile_list_length_ge(NULL, vs);
}
var_949 = var_952;
if (LV_IS_FALSE(var_949)) { break; }
lval var_953;
if (var_947[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_953 = (var_947[0].v.pair.car ? *(var_947[0].v.pair.car) : LVI_NIL());
lval var_954;
{
var_954 = var_953;
while (var_954.vt == LV_PAIR) {
var_954 = (var_954.v.pair.cdr ? *(var_954.v.pair.cdr) : LVI_NIL());
}
var_954 = LVI_BOOL(var_954.vt == LV_NIL);
}
var_949 = var_954;
if (LV_IS_FALSE(var_949)) { break; }
lval var_955;
var_955 = LVI_STRING("cadr");
lval var_956;
{
char* cp = strchr(var_955.v.str, 'r');
var_956 = var_947[0];
while (*(--cp) != 'c') {
if (var_956.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_956 = (var_956.v.pair.car ? *(var_956.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_956 = (var_956.v.pair.cdr ? *(var_956.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_955.v.str);
}
}
}
lval var_957;
{
var_957 = var_956;
while (var_957.vt == LV_PAIR) {
var_957 = (var_957.v.pair.cdr ? *(var_957.v.pair.cdr) : LVI_NIL());
}
var_957 = LVI_BOOL(var_957.vt == LV_NIL);
}
var_949 = var_957;
if (LV_IS_FALSE(var_949)) { break; }
lval var_958;
var_958 = LVI_INT(0);
lval var_959;
var_959 = LVI_STRING("cadr");
lval var_960;
{
char* cp = strchr(var_959.v.str, 'r');
var_960 = var_947[0];
while (*(--cp) != 'c') {
if (var_960.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_960 = (var_960.v.pair.car ? *(var_960.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_960 = (var_960.v.pair.cdr ? *(var_960.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_959.v.str);
}
}
}
lval var_961;
{
lval vs[8];
vs[0] = var_958;
vs[1] = var_960;
var_961 = wile_list_length_gt(NULL, vs);
}
var_949 = var_961;
if (LV_IS_FALSE(var_949)) { break; }
} while (0);
return var_949;
}
// end of function fn_28

// @@@ lambda (vdef) @@@ bld-rtl-dir/wile-rtl2-000078.scm:350 @@@ fn_982 @@@
static lval fn_982(lptr* var_983, lptr var_984)
{
lval var_986;
lval var_987;
var_987 = LVI_BOOL(true);
do {
lval var_988;
{
var_988 = var_984[0];
while (var_988.vt == LV_PAIR) {
var_988 = (var_988.v.pair.cdr ? *(var_988.v.pair.cdr) : LVI_NIL());
}
var_988 = LVI_BOOL(var_988.vt == LV_NIL);
}
var_987 = var_988;
if (LV_IS_FALSE(var_987)) { break; }
lval var_989;
var_989 = LVI_INT(2);
lval var_990;
{
lval vs[8];
vs[0] = var_989;
vs[1] = var_984[0];
var_990 = wile_list_length_ge(NULL, vs);
}
var_987 = var_990;
if (LV_IS_FALSE(var_987)) { break; }
lval var_991;
if (var_984[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_991 = (var_984[0].v.pair.car ? *(var_984[0].v.pair.car) : LVI_NIL());
lval var_992;
var_992 = LVI_BOOL(var_991.vt == LV_SYMBOL);
var_987 = var_992;
if (LV_IS_FALSE(var_987)) { break; }
} while (0);
if (LV_IS_FALSE(var_987)) {
lval var_993;
var_993 = LVI_STRING("malformed \'do\' variable-expr \'%v\'");
lval var_996[8];
var_996[0] = var_993;
lval var_997[8];
var_997[0] = var_984[0];
var_984[1] = wile_gen_list(1, var_997, NULL);
var_984[0] = var_996[0];
TAIL_CALL fn_7(NULL, var_984);
} else {
lval var_998;
var_998 = LVI_BOOL(false);
var_986 = var_998;
}
return var_986;
}
// end of lambda fn_982

// @@@ lambda (e) @@@ bld-rtl-dir/wile-rtl2-000078.scm:368 @@@ fn_1022 @@@
static lval fn_1022(lptr* var_1023, lptr var_1024)
{
lval var_1028[8];
var_1028[0] = V_CLOS(var_1023,0);
var_1028[1] = var_1024[0];
var_1024[0] = var_1028[0];
var_1024[1] = var_1028[1];
TAIL_CALL wile_eval(NULL, var_1024);
}
// end of lambda fn_1022

// @@@ lambda (vdef) @@@ bld-rtl-dir/wile-rtl2-000078.scm:369 @@@ fn_1030 @@@
static lval fn_1030(lptr* var_1031, lptr var_1032)
{
lval var_1034;
lval var_1035;
lval var_1036;
var_1036 = LVI_STRING("cddr");
lval var_1037;
{
char* cp = strchr(var_1036.v.str, 'r');
var_1037 = var_1032[0];
while (*(--cp) != 'c') {
if (var_1037.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_1037 = (var_1037.v.pair.car ? *(var_1037.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_1037 = (var_1037.v.pair.cdr ? *(var_1037.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_1036.v.str);
}
}
}
lval var_1038;
var_1038 = LVI_BOOL(var_1037.vt == LV_NIL);
if (LV_IS_FALSE(var_1038)) {
lval var_1039;
var_1039 = LVI_STRING("caddr");
lval var_1040;
{
char* cp = strchr(var_1039.v.str, 'r');
var_1040 = var_1032[0];
while (*(--cp) != 'c') {
if (var_1040.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_1040 = (var_1040.v.pair.car ? *(var_1040.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_1040 = (var_1040.v.pair.cdr ? *(var_1040.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_1039.v.str);
}
}
}
var_1035 = var_1040;
} else {
lval var_1041;
if (var_1032[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1041 = (var_1032[0].v.pair.car ? *(var_1032[0].v.pair.car) : LVI_NIL());
var_1035 = var_1041;
}
var_1034 = var_1035;
lval var_1042;
if (var_1032[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1042 = (var_1032[0].v.pair.car ? *(var_1032[0].v.pair.car) : LVI_NIL());
lval var_1043;
lval var_1044[8];
var_1044[0] = V_CLOS(var_1031,0);
var_1044[1] = var_1034;
var_1043 = wile_eval(NULL, var_1044);
lval var_1048[8];
var_1048[0] = var_1042;
var_1048[1] = var_1043;
var_1032[0] = var_1048[0];
var_1032[1] = var_1048[1];
TAIL_CALL fn_1(NULL, var_1032);
}
// end of lambda fn_1030

// @@@ lambda (new-bindings) @@@ bld-rtl-dir/wile-rtl2-000078.scm:360 @@@ fn_1011 @@@
static lval fn_1011(lptr* var_1012, lptr var_1013)
{
lbl_1014:;
lval var_1015;
lval var_1016;
{
lval vs[2];
vs[0] = var_1013[0];
vs[1] = V_CLOS(var_1012,0);
var_1016 = wile_gen_list(2, vs, NULL);
}
{
lval vs[8];
vs[0] = var_1016;
var_1016 = wile_list_append(NULL, vs);
}
var_1015 = var_1016;
lval var_1017;
lval var_1018;
if (V_CLOS(var_1012,1).vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1018 = (V_CLOS(var_1012,1).v.pair.car ? *(V_CLOS(var_1012,1).v.pair.car) : LVI_NIL());
lval var_1019;
lval var_1020[8];
var_1020[0] = var_1015;
var_1020[1] = var_1018;
var_1019 = wile_eval(NULL, var_1020);
if (LV_IS_FALSE(var_1019)) {
MK_CLOS(var_1023,1);
P_CLOS(var_1023,0) = &(var_1015);
lval var_1029;
var_1029 = LVI_NIL();
{
lval vs[8];
vs[0] = LVI_PROC(fn_1022,var_1023,1);
vs[1] = V_CLOS(var_1012,2);
vs[2] = var_1029;
var_1029 = wile_for_each(NULL, vs);
}
MK_CLOS(var_1031,1);
P_CLOS(var_1031,0) = &(var_1015);
lval var_1049;
var_1049 = LVI_NIL();
{
lval vs[8];
vs[0] = LVI_PROC(fn_1030,var_1031,1);
vs[1] = V_CLOS(var_1012,3);
vs[2] = var_1049;
var_1049 = wile_map(NULL, vs);
}
lval var_1052[8];
var_1052[0] = var_1049;
var_1013[0] = var_1052[0];
goto lbl_1014;	// selfie
} else {
lval var_1053;
if (V_CLOS(var_1012,1).vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1053 = (V_CLOS(var_1012,1).v.pair.cdr ? *(V_CLOS(var_1012,1).v.pair.cdr) : LVI_NIL());
lval var_1056[8];
var_1056[0] = var_1015;
var_1056[1] = var_1053;
var_1013[0] = var_1056[0];
var_1013[1] = var_1056[1];
TAIL_CALL fn_13(NULL, var_1013);
}
return var_1017;
}
// end of lambda fn_1011

// @@@ lambda (vdef) @@@ bld-rtl-dir/wile-rtl2-000078.scm:361 @@@ fn_1057 @@@
static lval fn_1057(lptr* var_1058, lptr var_1059)
{
lval var_1061;
if (var_1059[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1061 = (var_1059[0].v.pair.car ? *(var_1059[0].v.pair.car) : LVI_NIL());
lval var_1062;
var_1062 = LVI_STRING("cadr");
lval var_1063;
{
char* cp = strchr(var_1062.v.str, 'r');
var_1063 = var_1059[0];
while (*(--cp) != 'c') {
if (var_1063.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_1063 = (var_1063.v.pair.car ? *(var_1063.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_1063 = (var_1063.v.pair.cdr ? *(var_1063.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_1062.v.str);
}
}
}
lval var_1064;
lval var_1065[8];
var_1065[0] = V_CLOS(var_1058,0);
var_1065[1] = var_1063;
var_1064 = wile_eval(NULL, var_1065);
lval var_1069[8];
var_1069[0] = var_1061;
var_1069[1] = var_1064;
var_1059[0] = var_1069[0];
var_1059[1] = var_1069[1];
TAIL_CALL fn_1(NULL, var_1059);
}
// end of lambda fn_1057

// @@@ (eval-do env expr) @@@ bld-rtl-dir/wile-rtl2-000078.scm:345 @@@ fn_29 @@@
static lval fn_29(lptr* var_962, lptr var_963)
{
lval var_965;
lval var_966;
lval var_967[8];
var_967[0] = var_963[1];
var_966 = fn_28(NULL, var_967);
if (LV_IS_FALSE(var_966)) {
lval var_969;
var_969 = LVI_STRING("malformed \'do\' expression \'%v\'");
lval var_972[8];
var_972[0] = var_969;
lval var_973[8];
var_973[0] = var_963[1];
var_963[1] = wile_gen_list(1, var_973, NULL);
var_963[0] = var_972[0];
TAIL_CALL fn_7(NULL, var_963);
} else {
lval var_974;
lval var_975;
if (var_963[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_975 = (var_963[1].v.pair.car ? *(var_963[1].v.pair.car) : LVI_NIL());
var_974 = var_975;
lval var_976;
lval var_977;
var_977 = LVI_STRING("cadr");
lval var_978;
{
char* cp = strchr(var_977.v.str, 'r');
var_978 = var_963[1];
while (*(--cp) != 'c') {
if (var_978.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_978 = (var_978.v.pair.car ? *(var_978.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_978 = (var_978.v.pair.cdr ? *(var_978.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_977.v.str);
}
}
}
var_976 = var_978;
lval var_979;
lval var_980;
var_980 = LVI_STRING("cddr");
lval var_981;
{
char* cp = strchr(var_980.v.str, 'r');
var_981 = var_963[1];
while (*(--cp) != 'c') {
if (var_981.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_981 = (var_981.v.pair.car ? *(var_981.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_981 = (var_981.v.pair.cdr ? *(var_981.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_980.v.str);
}
}
}
var_979 = var_981;
MK_CLOS(var_983,0);
lval var_999;
var_999 = LVI_NIL();
{
lval vs[8];
vs[0] = LVI_PROC(fn_982,var_983,1);
vs[1] = var_974;
vs[2] = var_999;
var_999 = wile_for_each(NULL, vs);
}
lval var_1001;
var_1001 = LVI_BOOL(true);
do {
lval var_1002;
{
var_1002 = var_976;
while (var_1002.vt == LV_PAIR) {
var_1002 = (var_1002.v.pair.cdr ? *(var_1002.v.pair.cdr) : LVI_NIL());
}
var_1002 = LVI_BOOL(var_1002.vt == LV_NIL);
}
var_1001 = var_1002;
if (LV_IS_FALSE(var_1001)) { break; }
lval var_1003;
var_1003 = LVI_INT(1);
lval var_1004;
{
lval vs[8];
vs[0] = var_1003;
vs[1] = var_976;
var_1004 = wile_list_length_ge(NULL, vs);
}
var_1001 = var_1004;
if (LV_IS_FALSE(var_1001)) { break; }
} while (0);
if (LV_IS_FALSE(var_1001)) {
lval var_1005;
var_1005 = LVI_STRING("malformed \'do\' test-expr \'%v\'");
lval var_1007[8];
var_1007[0] = var_1005;
lval var_1009[8];
var_1009[0] = var_976;
var_1007[1] = wile_gen_list(1, var_1009, NULL);
(void)
 fn_7(NULL, var_1007);
} else {
(void)
 LVI_BOOL(false);
}
MK_CLOS(var_1012,4);
P_CLOS(var_1012,3) = &(var_974);
P_CLOS(var_1012,2) = &(var_979);
P_CLOS(var_1012,1) = &(var_976);
P_CLOS(var_1012,0) = &(var_963[0]);
MK_CLOS(var_1058,1);
P_CLOS(var_1058,0) = &(var_963[0]);
lval var_1070;
var_1070 = LVI_NIL();
{
lval vs[8];
vs[0] = LVI_PROC(fn_1057,var_1058,1);
vs[1] = var_974;
vs[2] = var_1070;
var_1070 = wile_map(NULL, vs);
}
lval var_1071;
lval var_1072[8];
var_1072[0] = var_1070;
var_1071 = fn_1011(var_1012, var_1072);
var_965 = var_1071;
}
return var_965;
}
// end of function fn_29

// @@@ lambda (fs as env) @@@ bld-rtl-dir/wile-rtl2-000078.scm:395 @@@ fn_1109 @@@
static lval fn_1109(lptr* var_1110, lptr var_1111)
{
lbl_1112:;
lval var_1113;
lval var_1114;
var_1114 = LVI_BOOL(var_1111[0].vt == LV_NIL);
if (LV_IS_FALSE(var_1114)) {
lval var_1115;
if (var_1111[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1115 = (var_1111[0].v.pair.cdr ? *(var_1111[0].v.pair.cdr) : LVI_NIL());
lval var_1116;
if (var_1111[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1116 = (var_1111[1].v.pair.cdr ? *(var_1111[1].v.pair.cdr) : LVI_NIL());
lval var_1117;
if (var_1111[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1117 = (var_1111[0].v.pair.car ? *(var_1111[0].v.pair.car) : LVI_NIL());
lval var_1118;
if (var_1111[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1118 = (var_1111[1].v.pair.car ? *(var_1111[1].v.pair.car) : LVI_NIL());
lval var_1119;
lval var_1120[8];
var_1120[0] = var_1117;
var_1120[1] = var_1118;
var_1119 = fn_1(NULL, var_1120);
lval var_1122;
{
lptr p1 = NULL, p2 = NULL;
if (var_1119.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_1119;
}
if (var_1111[2].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_1111[2];
}
var_1122 = LVI_PAIR(p1, p2);
}
lval var_1125[8];
var_1125[0] = var_1115;
var_1125[1] = var_1116;
var_1125[2] = var_1122;
var_1111[0] = var_1125[0];
var_1111[1] = var_1125[1];
var_1111[2] = var_1125[2];
goto lbl_1112;	// selfie
} else {
var_1113 = var_1111[2];
}
return var_1113;
}
// end of lambda fn_1109

// @@@ (apply-lambda fn args) @@@ bld-rtl-dir/wile-rtl2-000078.scm:380 @@@ wile_eval_apply_lambda @@@
lval wile_eval_apply_lambda(lptr* var_1074, lptr var_1075)
{
lval var_1077;
lval var_1078;
if (var_1075[0].vt == LV_ILAMBDA) {
var_1078 = var_1075[0].v.ilambda->args;
} else {
WILE_EX("get-interpreted-procedure-arguments", "expects an interpreted procedure");
}
var_1077 = var_1078;
lval var_1079;
lval var_1080;
if (var_1075[0].vt == LV_ILAMBDA) {
var_1080 = LVI_INT(var_1075[0].v.ilambda->arity);
} else {
WILE_EX("get-interpreted-procedure-arity", "expects an interpreted procedure");
}
var_1079 = var_1080;
lval var_1081;
lval var_1082;
{
lval vs[8];
vs[0] = var_1075[1];
var_1082 = wile_list_length(NULL, vs);
}
var_1081 = var_1082;
lval var_1084;
switch (var_1079.vt) {
case LV_REAL:
var_1084 = LVI_BOOL(var_1079.v.rv < 0.0);
break;
case LV_RAT:
var_1084 = LVI_BOOL((var_1079.v.irv.num < 0 && var_1079.v.irv.den >= 0) || (var_1079.v.irv.num > 0 && var_1079.v.irv.den < 0));
break;
case LV_INT:
var_1084 = LVI_BOOL(var_1079.v.iv < 0);
break;
default:
WILE_EX("negative?", "expects a real-valued number");
}
if (LV_IS_FALSE(var_1084)) {
lval var_1086;
switch (TYPE_COMBO(var_1081.vt,var_1079.vt)) {
case TYPE_COMBO(LV_INT,LV_INT):
var_1086 = LVI_BOOL(var_1081.v.iv == var_1079.v.iv);
break;
case TYPE_COMBO(LV_INT,LV_RAT):
var_1086 = LVI_BOOL(var_1081.v.iv * var_1079.v.irv.den == var_1079.v.irv.num);
break;
case TYPE_COMBO(LV_INT,LV_REAL):
var_1086 = LVI_BOOL(var_1081.v.iv == var_1079.v.rv);
break;
case TYPE_COMBO(LV_RAT,LV_INT):
var_1086 = LVI_BOOL(var_1081.v.irv.num == var_1079.v.iv * var_1081.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_RAT):
var_1086 = LVI_BOOL(var_1081.v.irv.num * var_1079.v.irv.den == var_1079.v.irv.num * var_1081.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_REAL):
var_1086 = LVI_BOOL(var_1081.v.irv.num == var_1079.v.rv * var_1081.v.irv.den);
break;
case TYPE_COMBO(LV_REAL,LV_INT):
var_1086 = LVI_BOOL(var_1081.v.rv == var_1079.v.iv);
break;
case TYPE_COMBO(LV_REAL,LV_RAT):
var_1086 = LVI_BOOL(var_1081.v.rv * var_1079.v.irv.den == var_1079.v.irv.num);
break;
case TYPE_COMBO(LV_REAL,LV_REAL):
var_1086 = LVI_BOOL(var_1081.v.rv == var_1079.v.rv);
break;
default:
WILE_EX("==", "inputs are not real-valued numbers");
break;
}
if (LV_IS_FALSE(var_1086)) {
lval var_1087;
var_1087 = LVI_STRING("malformed \'lambda\' evaluation: %d formal vs %d actual args");
lval var_1089[8];
var_1089[0] = var_1087;
lval var_1091[8];
var_1091[0] = var_1079;
var_1091[1] = var_1081;
var_1089[1] = wile_gen_list(2, var_1091, NULL);
(void)
 fn_7(NULL, var_1089);
} else {
(void)
 LVI_BOOL(false);
}
} else {
lval var_1093;
lval var_1094;
{
lval vs[1];
vs[0] = var_1079;
var_1094 = wile_gen_list(1, vs, NULL);
}
{
lval vs[8];
vs[0] = var_1094;
var_1094 = wile_subtract(NULL, vs);
}
lval var_1095;
var_1095 = LVI_INT(1);
lval var_1096;
{
lval vs[2];
vs[0] = var_1094;
vs[1] = var_1095;
var_1096 = wile_gen_list(2, vs, NULL);
}
{
lval vs[8];
vs[0] = var_1096;
var_1096 = wile_subtract(NULL, vs);
}
var_1093 = var_1096;
lval var_1098;
switch (TYPE_COMBO(var_1081.vt,var_1093.vt)) {
case TYPE_COMBO(LV_INT,LV_INT):
var_1098 = LVI_BOOL(var_1081.v.iv >= var_1093.v.iv);
break;
case TYPE_COMBO(LV_INT,LV_RAT):
var_1098 = LVI_BOOL(var_1081.v.iv * var_1093.v.irv.den >= var_1093.v.irv.num);
break;
case TYPE_COMBO(LV_INT,LV_REAL):
var_1098 = LVI_BOOL(var_1081.v.iv >= var_1093.v.rv);
break;
case TYPE_COMBO(LV_RAT,LV_INT):
var_1098 = LVI_BOOL(var_1081.v.irv.num >= var_1093.v.iv * var_1081.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_RAT):
var_1098 = LVI_BOOL(var_1081.v.irv.num * var_1093.v.irv.den >= var_1093.v.irv.num * var_1081.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_REAL):
var_1098 = LVI_BOOL(var_1081.v.irv.num >= var_1093.v.rv * var_1081.v.irv.den);
break;
case TYPE_COMBO(LV_REAL,LV_INT):
var_1098 = LVI_BOOL(var_1081.v.rv >= var_1093.v.iv);
break;
case TYPE_COMBO(LV_REAL,LV_RAT):
var_1098 = LVI_BOOL(var_1081.v.rv * var_1093.v.irv.den >= var_1093.v.irv.num);
break;
case TYPE_COMBO(LV_REAL,LV_REAL):
var_1098 = LVI_BOOL(var_1081.v.rv >= var_1093.v.rv);
break;
default:
WILE_EX(">=", "inputs are not real-valued numbers");
break;
}
if (LV_IS_FALSE(var_1098)) {
lval var_1099;
var_1099 = LVI_STRING("malformed \'lambda\' evaluation: %d required vs %d given args");
lval var_1101[8];
var_1101[0] = var_1099;
lval var_1103[8];
var_1103[0] = var_1093;
var_1103[1] = var_1081;
var_1101[1] = wile_gen_list(2, var_1103, NULL);
(void)
 fn_7(NULL, var_1101);
} else {
(void)
 LVI_BOOL(false);
}
lval var_1105;
{
lval vs[8];
vs[0] = var_1075[1];
vs[1] = var_1093;
var_1105 = wile_list_head(NULL, vs);
}
lval var_1106;
{
lval vs[8];
vs[0] = var_1075[1];
vs[1] = var_1093;
var_1106 = wile_list_tail(NULL, vs);
}
lval var_1107;
{
lval vs[1];
vs[0] = var_1106;
var_1107 = wile_gen_list(1, vs, NULL);
}
lval var_1108;
{
lval vs[2];
vs[0] = var_1105;
vs[1] = var_1107;
var_1108 = wile_gen_list(2, vs, NULL);
}
{
lval vs[8];
vs[0] = var_1108;
var_1108 = wile_list_append(NULL, vs);
}
var_1075[1] = var_1108;
(void)
 var_1075[1];
}
MK_CLOS(var_1110,0);
lval var_1126;
if (var_1075[0].vt == LV_ILAMBDA) {
var_1126 = var_1075[0].v.ilambda->env;
} else {
WILE_EX("get-interpreted-procedure-environment", "expects an interpreted procedure");
}
lval var_1127;
lval var_1128[8];
var_1128[0] = var_1077;
var_1128[1] = var_1075[1];
var_1128[2] = var_1126;
var_1127 = fn_1109(var_1110, var_1128);
lval var_1130;
if (var_1075[0].vt == LV_ILAMBDA) {
var_1130 = var_1075[0].v.ilambda->body;
} else {
WILE_EX("get-interpreted-procedure-body", "expects an interpreted procedure");
}
lval var_1133[8];
var_1133[0] = var_1127;
var_1133[1] = var_1130;
var_1075[0] = var_1133[0];
var_1075[1] = var_1133[1];
TAIL_CALL fn_13(NULL, var_1075);
}
// end of function wile_eval_apply_lambda

// @@@ lambda (acc lst) @@@ bld-rtl-dir/wile-rtl2-000078.scm:408 @@@ fn_1140 @@@
static lval fn_1140(lptr* var_1141, lptr var_1142)
{
lbl_1143:;
lval var_1144;
lval var_1145;
var_1145 = LVI_BOOL(var_1142[1].vt == LV_NIL);
if (LV_IS_FALSE(var_1145)) {
lval var_1146;
if (var_1142[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1146 = (var_1142[1].v.pair.car ? *(var_1142[1].v.pair.car) : LVI_NIL());
lval var_1147;
{
lptr p1 = NULL, p2 = NULL;
if (var_1146.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_1146;
}
if (var_1142[0].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_1142[0];
}
var_1147 = LVI_PAIR(p1, p2);
}
lval var_1148;
if (var_1142[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1148 = (var_1142[1].v.pair.cdr ? *(var_1142[1].v.pair.cdr) : LVI_NIL());
lval var_1151[8];
var_1151[0] = var_1147;
var_1151[1] = var_1148;
var_1142[0] = var_1151[0];
var_1142[1] = var_1151[1];
goto lbl_1143;	// selfie
} else {
var_1144 = var_1142[0];
}
return var_1144;
}
// end of lambda fn_1140

// @@@ (apply-interp fn . args) @@@ bld-rtl-dir/wile-rtl2-000078.scm:406 @@@ wile_eval_apply_interp @@@
lval wile_eval_apply_interp(lptr* var_1134, lptr var_1135)
{
lval var_1137;
lval var_1138;
{
lval vs[8];
vs[0] = var_1135[1];
var_1138 = wile_list_reverse(NULL, vs);
}
var_1137 = var_1138;
lval var_1139;
MK_CLOS(var_1141,0);
lval var_1152;
if (var_1137.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1152 = (var_1137.v.pair.car ? *(var_1137.v.pair.car) : LVI_NIL());
lval var_1153;
if (var_1137.vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1153 = (var_1137.v.pair.cdr ? *(var_1137.v.pair.cdr) : LVI_NIL());
lval var_1154;
lval var_1155[8];
var_1155[0] = var_1152;
var_1155[1] = var_1153;
var_1154 = fn_1140(var_1141, var_1155);
var_1139 = var_1154;
lval var_1157;
lval var_1158;
var_1158 = LVI_BOOL(var_1135[0].vt == LV_ILAMBDA);
if (LV_IS_FALSE(var_1158)) {
lval var_1159;
{
lval vs[2];
vs[0] = var_1135[0];
vs[1] = var_1139;
var_1159 = wile_gen_list(2, vs, NULL);
}
var_1159 = wile_apply_function(&(var_1159), __FILE__, __LINE__);
var_1157 = var_1159;
} else {
lval var_1162[8];
var_1162[0] = var_1135[0];
var_1162[1] = var_1139;
var_1135[0] = var_1162[0];
var_1135[1] = var_1162[1];
TAIL_CALL wile_eval_apply_lambda(NULL, var_1135);
}
return var_1157;
}
// end of function wile_eval_apply_interp

// @@@ lambda (e) @@@ bld-rtl-dir/wile-rtl2-000078.scm:462 @@@ fn_1293 @@@
static lval fn_1293(lptr* var_1294, lptr var_1295)
{
lval var_1299[8];
var_1299[0] = V_CLOS(var_1294,0);
var_1299[1] = var_1295[0];
var_1295[0] = var_1299[0];
var_1295[1] = var_1299[1];
TAIL_CALL wile_eval(NULL, var_1295);
}
// end of lambda fn_1293

// @@@ lambda (e) @@@ bld-rtl-dir/wile-rtl2-000078.scm:459 @@@ fn_1305 @@@
static lval fn_1305(lptr* var_1306, lptr var_1307)
{
lval var_1311[8];
var_1311[0] = V_CLOS(var_1306,0);
var_1311[1] = var_1307[0];
var_1307[0] = var_1311[0];
var_1307[1] = var_1311[1];
TAIL_CALL wile_eval(NULL, var_1307);
}
// end of lambda fn_1305

// @@@ (eval env expr) @@@ bld-rtl-dir/wile-rtl2-000078.scm:419 @@@ wile_eval @@@
lval wile_eval(lptr* var_1163, lptr var_1164)
{
lbl_1165:;
lval var_1166;
do {
lval var_1167;
var_1167 = LVI_BOOL(false);
do {
lval var_1168;
lval var_1169[8];
var_1169[0] = var_1164[1];
var_1168 = fn_8(NULL, var_1169);
var_1167 = var_1168;
if (!LV_IS_FALSE(var_1167)) { break; }
lval var_1171;
var_1171 = LVI_BOOL(var_1164[1].vt == LV_VECTOR);
var_1167 = var_1171;
if (!LV_IS_FALSE(var_1167)) { break; }
lval var_1172;
var_1172 = LVI_BOOL(var_1164[1].vt == LV_BVECTOR);
var_1167 = var_1172;
if (!LV_IS_FALSE(var_1167)) { break; }
} while (0);
if (!LV_IS_FALSE(var_1167)) {
var_1166 = var_1164[1];
break;
}
lval var_1173;
var_1173 = LVI_BOOL(var_1164[1].vt == LV_SYMBOL);
if (!LV_IS_FALSE(var_1173)) {
lval var_1174;
var_1174 = LVI_BOOL(false);
lval var_1177[8];
var_1177[0] = var_1174;
var_1177[1] = var_1164[0];
var_1177[2] = var_1164[1];
var_1164[0] = var_1177[0];
var_1164[1] = var_1177[1];
var_1164[2] = var_1177[2];
TAIL_CALL fn_11(NULL, var_1164);
}
lval var_1178;
var_1178 = LVI_BOOL(var_1164[1].vt == LV_PAIR);
if (!LV_IS_FALSE(var_1178)) {
lval var_1179;
do {
lval var_1180;
if (var_1164[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1180 = (var_1164[1].v.pair.car ? *(var_1164[1].v.pair.car) : LVI_NIL());
lval var_1181;
lval var_1182[8];
var_1182[0] = var_1180;
var_1181 = fn_9(NULL, var_1182);
if (!LV_IS_FALSE(var_1181)) {
lval var_1184;
if (var_1164[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1184 = (var_1164[1].v.pair.car ? *(var_1164[1].v.pair.car) : LVI_NIL());
lval var_1185;
if (var_1184.vt != LV_SYMBOL) {
wile_exception2("case", __FILE__, __LINE__, "case-value type does not match case type");
}
do {
if ((strcmp(var_1184.v.str, "quote") == 0)) {
lval var_1186;
var_1186 = LVI_STRING("cadr");
lval var_1187;
{
char* cp = strchr(var_1186.v.str, 'r');
var_1187 = var_1164[1];
while (*(--cp) != 'c') {
if (var_1187.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_1187 = (var_1187.v.pair.car ? *(var_1187.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_1187 = (var_1187.v.pair.cdr ? *(var_1187.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_1186.v.str);
}
}
}
var_1185 = var_1187;
break;
}
if ((strcmp(var_1184.v.str, "begin") == 0)) {
lval var_1188;
if (var_1164[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1188 = (var_1164[1].v.pair.cdr ? *(var_1164[1].v.pair.cdr) : LVI_NIL());
lval var_1191[8];
var_1191[0] = var_1164[0];
var_1191[1] = var_1188;
var_1164[0] = var_1191[0];
var_1164[1] = var_1191[1];
TAIL_CALL fn_13(NULL, var_1164);
}
if ((strcmp(var_1184.v.str, "if") == 0)) {
lval var_1192;
if (var_1164[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1192 = (var_1164[1].v.pair.cdr ? *(var_1164[1].v.pair.cdr) : LVI_NIL());
lval var_1195[8];
var_1195[0] = var_1164[0];
var_1195[1] = var_1192;
var_1164[0] = var_1195[0];
var_1164[1] = var_1195[1];
TAIL_CALL fn_14(NULL, var_1164);
}
if ((strcmp(var_1184.v.str, "and") == 0)) {
lval var_1196;
var_1196 = LVI_BOOL(true);
lval var_1197;
if (var_1164[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1197 = (var_1164[1].v.pair.cdr ? *(var_1164[1].v.pair.cdr) : LVI_NIL());
lval var_1200[8];
var_1200[0] = var_1196;
var_1200[1] = var_1164[0];
var_1200[2] = var_1197;
var_1164[0] = var_1200[0];
var_1164[1] = var_1200[1];
var_1164[2] = var_1200[2];
TAIL_CALL fn_15(NULL, var_1164);
}
if ((strcmp(var_1184.v.str, "or") == 0)) {
lval var_1201;
var_1201 = LVI_BOOL(false);
lval var_1202;
if (var_1164[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1202 = (var_1164[1].v.pair.cdr ? *(var_1164[1].v.pair.cdr) : LVI_NIL());
lval var_1205[8];
var_1205[0] = var_1201;
var_1205[1] = var_1164[0];
var_1205[2] = var_1202;
var_1164[0] = var_1205[0];
var_1164[1] = var_1205[1];
var_1164[2] = var_1205[2];
TAIL_CALL fn_16(NULL, var_1164);
}
if ((strcmp(var_1184.v.str, "let") == 0)) {
lval var_1206;
var_1206 = LVI_BOOL(false);
lval var_1207;
if (var_1164[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1207 = (var_1164[1].v.pair.cdr ? *(var_1164[1].v.pair.cdr) : LVI_NIL());
lval var_1210[8];
var_1210[0] = var_1206;
var_1210[1] = var_1164[0];
var_1210[2] = var_1207;
var_1164[0] = var_1210[0];
var_1164[1] = var_1210[1];
var_1164[2] = var_1210[2];
TAIL_CALL fn_18(NULL, var_1164);
}
if ((strcmp(var_1184.v.str, "let*") == 0)) {
lval var_1211;
var_1211 = LVI_BOOL(true);
lval var_1212;
if (var_1164[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1212 = (var_1164[1].v.pair.cdr ? *(var_1164[1].v.pair.cdr) : LVI_NIL());
lval var_1215[8];
var_1215[0] = var_1211;
var_1215[1] = var_1164[0];
var_1215[2] = var_1212;
var_1164[0] = var_1215[0];
var_1164[1] = var_1215[1];
var_1164[2] = var_1215[2];
TAIL_CALL fn_18(NULL, var_1164);
}
if ((strcmp(var_1184.v.str, "letrec") == 0) ||
    (strcmp(var_1184.v.str, "letrec*") == 0)) {
lval var_1216;
if (var_1164[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1216 = (var_1164[1].v.pair.cdr ? *(var_1164[1].v.pair.cdr) : LVI_NIL());
lval var_1219[8];
var_1219[0] = var_1164[0];
var_1219[1] = var_1216;
var_1164[0] = var_1219[0];
var_1164[1] = var_1219[1];
TAIL_CALL fn_19(NULL, var_1164);
}
if ((strcmp(var_1184.v.str, "cond") == 0)) {
lval var_1220;
var_1220 = LVI_SYMBOL("else");
lval var_1221;
var_1221 = LVI_BOOL(true);
lval var_1222;
lval var_1223[8];
var_1223[0] = var_1220;
var_1223[1] = var_1221;
var_1222 = fn_1(NULL, var_1223);
lval var_1225;
{
lptr p1 = NULL, p2 = NULL;
if (var_1222.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_1222;
}
if (var_1164[0].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_1164[0];
}
var_1225 = LVI_PAIR(p1, p2);
}
lval var_1226;
if (var_1164[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1226 = (var_1164[1].v.pair.cdr ? *(var_1164[1].v.pair.cdr) : LVI_NIL());
lval var_1229[8];
var_1229[0] = var_1225;
var_1229[1] = var_1226;
var_1164[0] = var_1229[0];
var_1164[1] = var_1229[1];
TAIL_CALL fn_22(NULL, var_1164);
}
if ((strcmp(var_1184.v.str, "set!") == 0)) {
lval var_1230;
if (var_1164[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1230 = (var_1164[1].v.pair.cdr ? *(var_1164[1].v.pair.cdr) : LVI_NIL());
lval var_1233[8];
var_1233[0] = var_1164[0];
var_1233[1] = var_1230;
var_1164[0] = var_1233[0];
var_1164[1] = var_1233[1];
TAIL_CALL fn_23(NULL, var_1164);
}
if ((strcmp(var_1184.v.str, "guard") == 0)) {
lval var_1234;
if (var_1164[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1234 = (var_1164[1].v.pair.cdr ? *(var_1164[1].v.pair.cdr) : LVI_NIL());
lval var_1237[8];
var_1237[0] = var_1164[0];
var_1237[1] = var_1234;
var_1164[0] = var_1237[0];
var_1164[1] = var_1237[1];
TAIL_CALL fn_24(NULL, var_1164);
}
if ((strcmp(var_1184.v.str, "case") == 0)) {
lval var_1238;
if (var_1164[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1238 = (var_1164[1].v.pair.cdr ? *(var_1164[1].v.pair.cdr) : LVI_NIL());
lval var_1241[8];
var_1241[0] = var_1164[0];
var_1241[1] = var_1238;
var_1164[0] = var_1241[0];
var_1164[1] = var_1241[1];
TAIL_CALL fn_25(NULL, var_1164);
}
if ((strcmp(var_1184.v.str, "lambda") == 0)) {
lval var_1242;
if (var_1164[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1242 = (var_1164[1].v.pair.cdr ? *(var_1164[1].v.pair.cdr) : LVI_NIL());
lval var_1245[8];
var_1245[0] = var_1164[0];
var_1245[1] = var_1242;
var_1164[0] = var_1245[0];
var_1164[1] = var_1245[1];
TAIL_CALL fn_27(NULL, var_1164);
}
if ((strcmp(var_1184.v.str, "do") == 0)) {
lval var_1246;
if (var_1164[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1246 = (var_1164[1].v.pair.cdr ? *(var_1164[1].v.pair.cdr) : LVI_NIL());
lval var_1249[8];
var_1249[0] = var_1164[0];
var_1249[1] = var_1246;
var_1164[0] = var_1249[0];
var_1164[1] = var_1249[1];
TAIL_CALL fn_29(NULL, var_1164);
}
if ((strcmp(var_1184.v.str, "pragma") == 0)) {
lval var_1250;
var_1250 = LVI_STRING(";;; ignoring %v\n");
lval var_1251;
{
lval vs[1];
vs[0] = var_1164[1];
var_1251 = wile_gen_list(1, vs, NULL);
}
{
lval vs[8];
vs[0] = var_stderr;
vs[1] = var_1250;
vs[2] = var_1251;
var_1251 = wile_fprintf(NULL, vs);
}
var_1185 = var_1251;
break;
}
if ((strcmp(var_1184.v.str, "quasiquote") == 0)) {
lval var_1252;
lval var_1253;
var_1253 = LVI_INT(2);
lval var_1254;
{
lval vs[8];
vs[0] = var_1253;
vs[1] = var_1164[1];
var_1254 = wile_list_length_eq(NULL, vs);
}
if (LV_IS_FALSE(var_1254)) {
lval var_1255;
var_1255 = LVI_STRING("malformed \'quasiquote\' expression \'%v\'");
lval var_1256;
if (var_1164[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1256 = (var_1164[1].v.pair.cdr ? *(var_1164[1].v.pair.cdr) : LVI_NIL());
lval var_1259[8];
var_1259[0] = var_1255;
lval var_1260[8];
var_1260[0] = var_1256;
var_1164[1] = wile_gen_list(1, var_1260, NULL);
var_1164[0] = var_1259[0];
TAIL_CALL fn_7(NULL, var_1164);
} else {
lval var_1261;
var_1261 = LVI_INT(1);
lval var_1262;
var_1262 = LVI_STRING("cadr");
lval var_1263;
{
char* cp = strchr(var_1262.v.str, 'r');
var_1263 = var_1164[1];
while (*(--cp) != 'c') {
if (var_1263.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_1263 = (var_1263.v.pair.car ? *(var_1263.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_1263 = (var_1263.v.pair.cdr ? *(var_1263.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_1262.v.str);
}
}
}
lval var_1266[8];
var_1266[0] = var_1261;
var_1266[1] = var_1164[0];
var_1266[2] = var_1263;
var_1164[0] = var_1266[0];
var_1164[1] = var_1266[1];
var_1164[2] = var_1266[2];
TAIL_CALL fn_21(NULL, var_1164);
}
var_1185 = var_1252;
break;
}
if ((strcmp(var_1184.v.str, "unquote") == 0)) {
lval var_1267;
var_1267 = LVI_STRING("naked \'unquote\' expression \'%v\'");
lval var_1270[8];
var_1270[0] = var_1267;
lval var_1271[8];
var_1271[0] = var_1164[1];
var_1164[1] = wile_gen_list(1, var_1271, NULL);
var_1164[0] = var_1270[0];
TAIL_CALL fn_7(NULL, var_1164);
}
if ((strcmp(var_1184.v.str, "unquote-splicing") == 0)) {
lval var_1272;
var_1272 = LVI_STRING("naked \'unquote-splicing\' expression \'%v\'");
lval var_1275[8];
var_1275[0] = var_1272;
lval var_1276[8];
var_1276[0] = var_1164[1];
var_1164[1] = wile_gen_list(1, var_1276, NULL);
var_1164[0] = var_1275[0];
TAIL_CALL fn_7(NULL, var_1164);
}
{
lval var_1277;
var_1277 = LVI_SYMBOL("unimplemented-special-form");
var_1185 = var_1277;
break;
}
} while (0);
var_1179 = var_1185;
break;
}
lval var_1278;
lval var_1279[8];
var_1279[0] = var_1164[1];
var_1278 = wile_eval_define_form(NULL, var_1279);
if (!LV_IS_FALSE(var_1278)) {
lval var_1281;
var_1281 = LVI_STRING("misplaced \'define\' expression \'%v\'");
lval var_1284[8];
var_1284[0] = var_1281;
lval var_1285[8];
var_1285[0] = var_1164[1];
var_1164[1] = wile_gen_list(1, var_1285, NULL);
var_1164[0] = var_1284[0];
TAIL_CALL fn_7(NULL, var_1164);
}
lval var_1286;
lval var_1287;
if (var_1164[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1287 = (var_1164[1].v.pair.car ? *(var_1164[1].v.pair.car) : LVI_NIL());
lval var_1288;
lval var_1289[8];
var_1289[0] = var_1164[0];
var_1289[1] = var_1287;
var_1288 = wile_eval(NULL, var_1289);
var_1286 = var_1288;
lval var_1291;
lval var_1292;
var_1292 = LVI_BOOL(var_1286.vt == LV_ILAMBDA);
if (LV_IS_FALSE(var_1292)) {
MK_CLOS(var_1294,1);
P_CLOS(var_1294,0) = &(var_1164[0]);
lval var_1300;
if (var_1164[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1300 = (var_1164[1].v.pair.cdr ? *(var_1164[1].v.pair.cdr) : LVI_NIL());
lval var_1301;
var_1301 = LVI_NIL();
{
lval vs[8];
vs[0] = LVI_PROC(fn_1293,var_1294,1);
vs[1] = var_1300;
vs[2] = var_1301;
var_1301 = wile_map(NULL, vs);
}
lval var_1302;
{
lval vs[2];
vs[0] = var_1286;
vs[1] = var_1301;
var_1302 = wile_gen_list(2, vs, NULL);
}
var_1302 = wile_apply_function(&(var_1302), __FILE__, __LINE__);
var_1291 = var_1302;
} else {
lval var_1303;
lval var_1304;
if (var_1286.vt == LV_ILAMBDA) {
var_1304 = LVI_BOOL(var_1286.v.ilambda->macro);
} else {
WILE_EX("get-interpreted-procedure-macro", "expects an interpreted procedure");
}
if (LV_IS_FALSE(var_1304)) {
MK_CLOS(var_1306,1);
P_CLOS(var_1306,0) = &(var_1164[0]);
lval var_1312;
if (var_1164[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1312 = (var_1164[1].v.pair.cdr ? *(var_1164[1].v.pair.cdr) : LVI_NIL());
lval var_1313;
var_1313 = LVI_NIL();
{
lval vs[8];
vs[0] = LVI_PROC(fn_1305,var_1306,1);
vs[1] = var_1312;
vs[2] = var_1313;
var_1313 = wile_map(NULL, vs);
}
lval var_1316[8];
var_1316[0] = var_1286;
var_1316[1] = var_1313;
var_1164[0] = var_1316[0];
var_1164[1] = var_1316[1];
TAIL_CALL wile_eval_apply_lambda(NULL, var_1164);
} else {
lval var_1317;
if (var_1164[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1317 = (var_1164[1].v.pair.cdr ? *(var_1164[1].v.pair.cdr) : LVI_NIL());
lval var_1318;
lval var_1319[8];
var_1319[0] = var_1286;
var_1319[1] = var_1317;
var_1318 = wile_eval_apply_lambda(NULL, var_1319);
lval var_1323[8];
var_1323[0] = var_1164[0];
var_1323[1] = var_1318;
var_1164[0] = var_1323[0];
var_1164[1] = var_1323[1];
goto lbl_1165;	// selfie
}
var_1291 = var_1303;
}
var_1179 = var_1291;
} while (0);
var_1166 = var_1179;
break;
}
var_1166 = LVI_BOOL(false);
} while (0);
return var_1166;
}
// end of function wile_eval
