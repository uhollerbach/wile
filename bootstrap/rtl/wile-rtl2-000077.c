// Generated by wile, the extremely stable scheming genius compiler

#include "wile-rtl1.h"
#include "wile-rtl2.h"

// declarations

extern lval var_argv;
extern lval var_cmd_name;
extern lval var_stdin;
extern lval var_stdout;
extern lval var_stderr;
extern lval var_pi;
extern lval var_euler_gamma;
extern lval var_show_sign;
extern lval var_int_base;
extern lval var_flt_base;
extern lval var_flt_precision;
#include "wile-rtl2.h"
static lval fn_1(lptr*, lptr);	// (make-bbox name value)
static lval fn_2(lptr*, lptr);	// (isa-bbox? it)
static lval fn_3(lptr*, lptr);	// (get-bbox-name it)
static lval fn_4(lptr*, lptr);	// (get-bbox-value it)
static lval fn_5(lptr*, lptr);	// (set-bbox-name! it val)
static lval fn_6(lptr*, lptr);	// (set-bbox-value! it val)
static lval fn_7(lptr*, lptr);	// (ERR fmt . args)
static lval fn_8(lptr*, lptr);	// (atom? val)
static lval fn_9(lptr*, lptr);	// (special-form? val)
static lval fn_10(lptr*, lptr);	// (unique-symbols? lst)
static lval fn_11(lptr*, lptr);	// (symbol-lookup box? env sym)
static lval fn_12(lptr*, lptr);	// (eval-binding env expr)
static lval fn_13(lptr*, lptr);	// (eval-if env exprs)
static lval fn_14(lptr*, lptr);	// (eval-and init env exprs)
static lval fn_15(lptr*, lptr);	// (eval-or init env exprs)
static lval fn_16(lptr*, lptr);	// (check-let-bindings type llist)
static lval fn_17(lptr*, lptr);	// (eval-let rec? star? env exprs)
static lval fn_18(lptr*, lptr);	// (eval-qq-olist level env expr)
static lval fn_19(lptr*, lptr);	// (eval-qq level env expr)
static lval fn_20(lptr*, lptr);	// (eval-cond env expr)
static lval fn_21(lptr*, lptr);	// (eval-set! env expr)
static lval fn_22(lptr*, lptr);	// (eval-guard env expr)
static lval fn_23(lptr*, lptr);	// (eval-case env expr)
static lval fn_24(lptr*, lptr);	// (args-list dotted-list)
static lval fn_25(lptr*, lptr);	// (eval-lambda env expr)
static lval fn_26(lptr*, lptr);	// (check-syntax-do expr)
static lval fn_27(lptr*, lptr);	// (eval-do env expr)
static lval fn_171(lptr*, lptr);
static lval fn_182(lptr*, lptr);
static lval fn_246(lptr*, lptr);
static lval fn_265(lptr*, lptr);
static lval fn_284(lptr*, lptr);
static lval fn_398(lptr*, lptr);
static lval fn_459(lptr*, lptr);
static lval fn_465(lptr*, lptr);
static lval fn_529(lptr*, lptr);
static lval fn_591(lptr*, lptr);
static lval fn_637(lptr*, lptr);
static lval fn_660(lptr*, lptr);
static lval fn_865(lptr*, lptr);
static lval fn_914(lptr*, lptr);
static lval fn_975(lptr*, lptr);
static lval fn_1078(lptr*, lptr);
static lval fn_1110(lptr*, lptr);
static lval fn_1123(lptr*, lptr);
static lval fn_1132(lptr*, lptr);
static lval fn_1161(lptr*, lptr);
static lval fn_1225(lptr*, lptr);
static lval fn_1257(lptr*, lptr);
static lval fn_1425(lptr*, lptr);
static lval fn_1439(lptr*, lptr);

// definitions

// @@@ (make-bbox name value) @@@ bld-rtl-dir/wile-rtl2-000077.scm:20 @@@ fn_1 @@@
static lval fn_1(lptr* var_28, lptr var_29)
{
lval var_31;
lval var_32;
var_32 = LVI_INT(3);
lval var_33;
{
size_t i, capa;
var_33.vt = LV_VECTOR;
capa = var_32.v.iv;
var_33.v.vec.capa = capa;
var_33.v.vec.arr = LISP_ALLOC(lptr, (capa > 0 ? capa : 1));
if (var_33.v.vec.arr == NULL) {
WILE_EX("vector-create", "memory allocation failed!");
}
for (i = 0; i < capa; ++i) {
var_33.v.vec.arr[i] = NULL;
}
}
var_31 = var_33;
lval var_34;
var_34 = LVI_INT(0);
lval var_35;
var_35 = LVI_SYMBOL("bbox");
{
if (var_31.vt != LV_VECTOR) {
WILE_EX("vector-set!", "input is not a vector");
}
if (var_34.vt != LV_INT || var_34.v.iv < 0 || (size_t) var_34.v.iv >= var_31.v.vec.capa) {
WILE_EX("vector-set!", "got bad index value");
}
var_31.v.vec.arr[var_34.v.iv] = new_lv(LV_NIL);
*(var_31.v.vec.arr[var_34.v.iv]) = var_35;
}
lval var_37;
var_37 = LVI_INT(1);
{
if (var_31.vt != LV_VECTOR) {
WILE_EX("vector-set!", "input is not a vector");
}
if (var_37.vt != LV_INT || var_37.v.iv < 0 || (size_t) var_37.v.iv >= var_31.v.vec.capa) {
WILE_EX("vector-set!", "got bad index value");
}
var_31.v.vec.arr[var_37.v.iv] = new_lv(LV_NIL);
*(var_31.v.vec.arr[var_37.v.iv]) = var_29[0];
}
lval var_39;
var_39 = LVI_INT(2);
{
if (var_31.vt != LV_VECTOR) {
WILE_EX("vector-set!", "input is not a vector");
}
if (var_39.vt != LV_INT || var_39.v.iv < 0 || (size_t) var_39.v.iv >= var_31.v.vec.capa) {
WILE_EX("vector-set!", "got bad index value");
}
var_31.v.vec.arr[var_39.v.iv] = new_lv(LV_NIL);
*(var_31.v.vec.arr[var_39.v.iv]) = var_29[1];
}
return var_31;
}
// end of function fn_1

// @@@ (isa-bbox? it) @@@ bld-rtl-dir/wile-rtl2-000077.scm:20 @@@ fn_2 @@@
static lval fn_2(lptr* var_41, lptr var_42)
{
lval var_44;
var_44 = LVI_BOOL(true);
do {
lval var_45;
var_45 = LVI_BOOL(var_42[0].vt == LV_VECTOR);
var_44 = var_45;
if (LV_IS_FALSE(var_44)) { break; }
lval var_46;
var_46 = LVI_INT(0);
lval var_47;
{
if (var_42[0].vt != LV_VECTOR) {
WILE_EX("vector-ref", "input is not a vector");
}
if (var_46.vt != LV_INT || var_46.v.iv < 0 || (size_t) var_46.v.iv >= var_42[0].v.vec.capa) {
WILE_EX("vector-ref", "got bad index value");
}
var_47 = var_42[0].v.vec.arr[var_46.v.iv] ? *(var_42[0].v.vec.arr[var_46.v.iv]) : LVI_NIL();
}
lval var_48;
var_48 = LVI_SYMBOL("bbox");
lval var_49;
var_49 = LVI_BOOL(wile_do_eqv(&(var_47), &(var_48)));
var_44 = var_49;
if (LV_IS_FALSE(var_44)) { break; }
} while (0);
return var_44;
}
// end of function fn_2

// @@@ (get-bbox-name it) @@@ ./wrtl.sch:0 @@@ fn_3 @@@
static lval fn_3(lptr* var_50, lptr var_51)
{
lval var_53;
var_53 = LVI_INT(1);
lval var_54;
{
if (var_51[0].vt != LV_VECTOR) {
WILE_EX("vector-ref", "input is not a vector");
}
if (var_53.vt != LV_INT || var_53.v.iv < 0 || (size_t) var_53.v.iv >= var_51[0].v.vec.capa) {
WILE_EX("vector-ref", "got bad index value");
}
var_54 = var_51[0].v.vec.arr[var_53.v.iv] ? *(var_51[0].v.vec.arr[var_53.v.iv]) : LVI_NIL();
}
return var_54;
}
// end of function fn_3

// @@@ (get-bbox-value it) @@@ ./wrtl.sch:0 @@@ fn_4 @@@
static lval fn_4(lptr* var_55, lptr var_56)
{
lval var_58;
var_58 = LVI_INT(2);
lval var_59;
{
if (var_56[0].vt != LV_VECTOR) {
WILE_EX("vector-ref", "input is not a vector");
}
if (var_58.vt != LV_INT || var_58.v.iv < 0 || (size_t) var_58.v.iv >= var_56[0].v.vec.capa) {
WILE_EX("vector-ref", "got bad index value");
}
var_59 = var_56[0].v.vec.arr[var_58.v.iv] ? *(var_56[0].v.vec.arr[var_58.v.iv]) : LVI_NIL();
}
return var_59;
}
// end of function fn_4

// @@@ (set-bbox-name! it val) @@@ ./wrtl.sch:0 @@@ fn_5 @@@
static lval fn_5(lptr* var_60, lptr var_61)
{
lval var_63;
var_63 = LVI_INT(1);
lval var_64;
{
if (var_61[0].vt != LV_VECTOR) {
WILE_EX("vector-set!", "input is not a vector");
}
if (var_63.vt != LV_INT || var_63.v.iv < 0 || (size_t) var_63.v.iv >= var_61[0].v.vec.capa) {
WILE_EX("vector-set!", "got bad index value");
}
var_61[0].v.vec.arr[var_63.v.iv] = new_lv(LV_NIL);
*(var_61[0].v.vec.arr[var_63.v.iv]) = var_61[1];
var_64 = var_61[0];
}
return var_64;
}
// end of function fn_5

// @@@ (set-bbox-value! it val) @@@ ./wrtl.sch:0 @@@ fn_6 @@@
static lval fn_6(lptr* var_65, lptr var_66)
{
lval var_68;
var_68 = LVI_INT(2);
lval var_69;
{
if (var_66[0].vt != LV_VECTOR) {
WILE_EX("vector-set!", "input is not a vector");
}
if (var_68.vt != LV_INT || var_68.v.iv < 0 || (size_t) var_68.v.iv >= var_66[0].v.vec.capa) {
WILE_EX("vector-set!", "got bad index value");
}
var_66[0].v.vec.arr[var_68.v.iv] = new_lv(LV_NIL);
*(var_66[0].v.vec.arr[var_68.v.iv]) = var_66[1];
var_69 = var_66[0];
}
return var_69;
}
// end of function fn_6

// @@@ sprintf @@@ bld-rtl-dir/wile-rtl2-000077.scm:24 @@@ fn_75 @@@
static lval fn_75(lptr* var_76, lptr var_77)
{
lval var_79;
var_79 = var_77[1];
{
lval var_80[8];
var_80[0] = var_77[0];
var_80[1] = var_79;
var_79 = wile_sprintf(NULL, var_80);
}
return var_79;
}
// end of prim fn_75

// @@@ (ERR fmt . args) @@@ bld-rtl-dir/wile-rtl2-000077.scm:22 @@@ fn_7 @@@
static lval fn_7(lptr* var_70, lptr var_71)
{
{
lval var_74[8];
var_74[0] = var_stderr;
(void)
 wile_flushport(NULL, var_74);
}
lval var_81;
var_81 = LVI_STRING(" at ");
lval var_82;
var_82 = LVI_STRING(wile_decode_line_loc(wile_get_lisp_loc(&var_71[1])));
lval var_83;
{
lval var_85[3];
var_85[0] = var_71[0];
var_85[1] = var_81;
var_85[2] = var_82;
var_83 = wile_gen_list(3, var_85, NULL);
}
{
lval var_84[8];
var_84[0] = var_83;
var_83 = wile_string_append(NULL, var_84);
}
lval var_86;
{
lval var_87[3];
var_87[0] = LVI_PROC(fn_75,NULL,-2);
var_87[1] = var_83;
var_87[2] = var_71[1];
var_86 = wile_gen_list(3, var_87, NULL);
}
var_86 = wile_apply_function(&(var_86), __FILE__, __LINE__);
lval var_88;
{
lval var_89[1];
var_89[0] = var_86;
var_88 = wile_gen_list(1, var_89, NULL);
}
if (var_88.vt == LV_PAIR && (var_88.v.pair.cdr == NULL || var_88.v.pair.cdr->vt == LV_NIL)) {
var_88 = (var_88.v.pair.car ? *(var_88.v.pair.car) : LVI_NIL());
}
cachalot->errval = new_lv(LV_NIL);
*(cachalot->errval) = var_88;
cachalot->l_whence = 0;
cachalot->c_whence = LISP_WHENCE;
longjmp(cachalot->cenv, 1);
return var_88;
}
// end of function fn_7

// @@@ (atom? val) @@@ bld-rtl-dir/wile-rtl2-000077.scm:28 @@@ fn_8 @@@
static lval fn_8(lptr* var_90, lptr var_91)
{
lval var_93;
var_93 = LVI_BOOL(false);
do {
lval var_94;
var_94 = LVI_BOOL(var_91[0].vt == LV_NIL);
var_93 = var_94;
if (!LV_IS_FALSE(var_93)) { break; }
lval var_95;
var_95 = LVI_BOOL(var_91[0].vt == LV_BOOL);
var_93 = var_95;
if (!LV_IS_FALSE(var_93)) { break; }
lval var_96;
var_96 = LVI_BOOL(var_91[0].vt == LV_CHAR);
var_93 = var_96;
if (!LV_IS_FALSE(var_93)) { break; }
lval var_97;
var_97 = LVI_BOOL(var_91[0].vt == LV_STRING);
var_93 = var_97;
if (!LV_IS_FALSE(var_93)) { break; }
lval var_98;
var_98 = LVI_BOOL(var_91[0].vt == LV_INT);
var_93 = var_98;
if (!LV_IS_FALSE(var_93)) { break; }
lval var_99;
var_99 = LVI_BOOL(var_91[0].vt == LV_RAT || var_91[0].vt == LV_INT);
var_93 = var_99;
if (!LV_IS_FALSE(var_93)) { break; }
lval var_100;
var_100 = LVI_BOOL(var_91[0].vt == LV_REAL || var_91[0].vt == LV_RAT || var_91[0].vt == LV_INT);
var_93 = var_100;
if (!LV_IS_FALSE(var_93)) { break; }
lval var_101;
var_101 = LVI_BOOL(var_91[0].vt == LV_CMPLX || var_91[0].vt == LV_REAL || var_91[0].vt == LV_RAT || var_91[0].vt == LV_INT);
var_93 = var_101;
if (!LV_IS_FALSE(var_93)) { break; }
lval var_102;
var_102 = LVI_BOOL(var_91[0].vt == LV_FILE_PORT);
var_93 = var_102;
if (!LV_IS_FALSE(var_93)) { break; }
lval var_103;
var_103 = LVI_BOOL(var_91[0].vt == LV_PIPE_PORT);
var_93 = var_103;
if (!LV_IS_FALSE(var_93)) { break; }
lval var_104;
var_104 = LVI_BOOL(var_91[0].vt == LV_SOCK_PORT);
var_93 = var_104;
if (!LV_IS_FALSE(var_93)) { break; }
lval var_105;
var_105 = LVI_BOOL(var_91[0].vt == LV_STR_PORT);
var_93 = var_105;
if (!LV_IS_FALSE(var_93)) { break; }
lval var_106;
var_106 = LVI_BOOL(var_91[0].vt == LV_SQLITE_PORT);
var_93 = var_106;
if (!LV_IS_FALSE(var_93)) { break; }
lval var_107;
var_107 = LVI_BOOL(var_91[0].vt == LV_SQLITE_STMT);
var_93 = var_107;
if (!LV_IS_FALSE(var_93)) { break; }
} while (0);
return var_93;
}
// end of function fn_8

// @@@ (special-form? val) @@@ bld-rtl-dir/wile-rtl2-000077.scm:44 @@@ fn_9 @@@
static lval fn_9(lptr* var_108, lptr var_109)
{
lval var_111;
var_111 = LVI_BOOL(true);
do {
lval var_112;
var_112 = LVI_BOOL(var_109[0].vt == LV_SYMBOL);
var_111 = var_112;
if (LV_IS_FALSE(var_111)) { break; }
lval var_113;
var_113 = LVI_BOOL(false);
do {
lval var_114;
var_114 = LVI_SYMBOL("quote");
lval var_115;
var_115 = LVI_BOOL(strcmp(var_109[0].v.str, var_114.v.str) == 0);
var_113 = var_115;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_116;
var_116 = LVI_SYMBOL("and");
lval var_117;
var_117 = LVI_BOOL(strcmp(var_109[0].v.str, var_116.v.str) == 0);
var_113 = var_117;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_118;
var_118 = LVI_SYMBOL("begin");
lval var_119;
var_119 = LVI_BOOL(strcmp(var_109[0].v.str, var_118.v.str) == 0);
var_113 = var_119;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_120;
var_120 = LVI_SYMBOL("case");
lval var_121;
var_121 = LVI_BOOL(strcmp(var_109[0].v.str, var_120.v.str) == 0);
var_113 = var_121;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_122;
var_122 = LVI_SYMBOL("cond");
lval var_123;
var_123 = LVI_BOOL(strcmp(var_109[0].v.str, var_122.v.str) == 0);
var_113 = var_123;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_124;
var_124 = LVI_SYMBOL("do");
lval var_125;
var_125 = LVI_BOOL(strcmp(var_109[0].v.str, var_124.v.str) == 0);
var_113 = var_125;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_126;
var_126 = LVI_SYMBOL("guard");
lval var_127;
var_127 = LVI_BOOL(strcmp(var_109[0].v.str, var_126.v.str) == 0);
var_113 = var_127;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_128;
var_128 = LVI_SYMBOL("if");
lval var_129;
var_129 = LVI_BOOL(strcmp(var_109[0].v.str, var_128.v.str) == 0);
var_113 = var_129;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_130;
var_130 = LVI_SYMBOL("lambda");
lval var_131;
var_131 = LVI_BOOL(strcmp(var_109[0].v.str, var_130.v.str) == 0);
var_113 = var_131;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_132;
var_132 = LVI_SYMBOL("let");
lval var_133;
var_133 = LVI_BOOL(strcmp(var_109[0].v.str, var_132.v.str) == 0);
var_113 = var_133;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_134;
var_134 = LVI_SYMBOL("let*");
lval var_135;
var_135 = LVI_BOOL(strcmp(var_109[0].v.str, var_134.v.str) == 0);
var_113 = var_135;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_136;
var_136 = LVI_SYMBOL("letrec");
lval var_137;
var_137 = LVI_BOOL(strcmp(var_109[0].v.str, var_136.v.str) == 0);
var_113 = var_137;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_138;
var_138 = LVI_SYMBOL("letrec*");
lval var_139;
var_139 = LVI_BOOL(strcmp(var_109[0].v.str, var_138.v.str) == 0);
var_113 = var_139;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_140;
var_140 = LVI_SYMBOL("or");
lval var_141;
var_141 = LVI_BOOL(strcmp(var_109[0].v.str, var_140.v.str) == 0);
var_113 = var_141;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_142;
var_142 = LVI_SYMBOL("set!");
lval var_143;
var_143 = LVI_BOOL(strcmp(var_109[0].v.str, var_142.v.str) == 0);
var_113 = var_143;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_144;
var_144 = LVI_SYMBOL("quasiquote");
lval var_145;
var_145 = LVI_BOOL(strcmp(var_109[0].v.str, var_144.v.str) == 0);
var_113 = var_145;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_146;
var_146 = LVI_SYMBOL("unquote");
lval var_147;
var_147 = LVI_BOOL(strcmp(var_109[0].v.str, var_146.v.str) == 0);
var_113 = var_147;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_148;
var_148 = LVI_SYMBOL("unquote-splicing");
lval var_149;
var_149 = LVI_BOOL(strcmp(var_109[0].v.str, var_148.v.str) == 0);
var_113 = var_149;
if (!LV_IS_FALSE(var_113)) { break; }
lval var_150;
var_150 = LVI_SYMBOL("pragma");
lval var_151;
var_151 = LVI_BOOL(strcmp(var_109[0].v.str, var_150.v.str) == 0);
var_113 = var_151;
if (!LV_IS_FALSE(var_113)) { break; }
} while (0);
var_111 = var_113;
if (LV_IS_FALSE(var_111)) { break; }
} while (0);
return var_111;
}
// end of function fn_9

// @@@ (define-form? expr) @@@ bld-rtl-dir/wile-rtl2-000077.scm:72 @@@ wile_eval_define_form @@@
lval wile_eval_define_form(lptr* var_152, lptr var_153)
{
lval var_155;
var_155 = LVI_BOOL(true);
do {
lval var_156;
var_156 = LVI_BOOL(var_153[0].vt == LV_PAIR);
var_155 = var_156;
if (LV_IS_FALSE(var_155)) { break; }
lval var_157;
if (var_153[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_157 = (var_153[0].v.pair.car ? *(var_153[0].v.pair.car) : LVI_NIL());
lval var_158;
var_158 = LVI_BOOL(var_157.vt == LV_SYMBOL);
var_155 = var_158;
if (LV_IS_FALSE(var_155)) { break; }
lval var_159;
var_159 = LVI_BOOL(false);
do {
lval var_160;
if (var_153[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_160 = (var_153[0].v.pair.car ? *(var_153[0].v.pair.car) : LVI_NIL());
lval var_161;
var_161 = LVI_SYMBOL("define");
lval var_162;
var_162 = LVI_BOOL(strcmp(var_160.v.str, var_161.v.str) == 0);
var_159 = var_162;
if (!LV_IS_FALSE(var_159)) { break; }
lval var_163;
if (var_153[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_163 = (var_153[0].v.pair.car ? *(var_153[0].v.pair.car) : LVI_NIL());
lval var_164;
var_164 = LVI_SYMBOL("defmacro");
lval var_165;
var_165 = LVI_BOOL(strcmp(var_163.v.str, var_164.v.str) == 0);
var_159 = var_165;
if (!LV_IS_FALSE(var_159)) { break; }
} while (0);
var_155 = var_159;
if (LV_IS_FALSE(var_155)) { break; }
} while (0);
return var_155;
}
// end of function wile_eval_define_form

// @@@ lambda (c) @@@ bld-rtl-dir/wile-rtl2-000077.scm:83 @@@ fn_171 @@@
static lval fn_171(lptr* var_172, lptr var_173)
{
lval var_175;
var_175 = LVI_CHAR(58);
lval var_176;
var_176 = LVI_BOOL(wile_do_eqv(&(var_173[0]), &(var_175)));
return var_176;
}
// end of lambda fn_171

// @@@ lambda (ps) @@@ bld-rtl-dir/wile-rtl2-000077.scm:85 @@@ fn_182 @@@
static lval fn_182(lptr* var_183, lptr var_184)
{
lbl_185:;
lval var_186;
lval var_187;
var_187 = LVI_BOOL(var_184[0].vt == LV_NIL);
if (LV_IS_FALSE(var_187)) {
lval var_188;
lval var_189;
var_189 = LVI_STRING("/");
lval var_190;
if (var_184[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_190 = (var_184[0].v.pair.car ? *(var_184[0].v.pair.car) : LVI_NIL());
lval var_191;
{
lval var_193[2];
var_193[0] = var_190;
var_193[1] = V_CLOS(var_183,0);
var_191 = wile_gen_list(2, var_193, NULL);
}
{
lval var_192[8];
var_192[0] = var_189;
var_192[1] = var_191;
var_191 = wile_string_join_by(NULL, var_192);
}
var_188 = var_191;
lval var_194;
lval var_195;
var_195 = LVI_BOOL(access(var_188.v.str, F_OK) == 0);
if (LV_IS_FALSE(var_195)) {
lval var_196;
if (var_184[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_196 = (var_184[0].v.pair.cdr ? *(var_184[0].v.pair.cdr) : LVI_NIL());
lval var_199[8];
var_199[0] = var_196;
var_184[0] = var_199[0];
goto lbl_185;	// selfie
} else {
var_194 = var_188;
}
var_186 = var_194;
} else {
lval var_200;
var_200 = LVI_BOOL(false);
var_186 = var_200;
}
return var_186;
}
// end of lambda fn_182

// @@@ (load-file-path pathy? fname) @@@ bld-rtl-dir/wile-rtl2-000077.scm:80 @@@ wile_eval_load_path @@@
lval wile_eval_load_path(lptr* var_166, lptr var_167)
{
lval var_169;
if (LV_IS_FALSE(var_167[0])) {
var_169 = var_167[1];
} else {
lval var_170;
MK_CLOS(var_172,0);
lval var_177;
var_177 = LVI_STRING("WILE_LIBRARY_PATH");
lval var_178;
{
char* ev = getenv(var_177.v.str);
var_178 = (ev ? LVI_STRING(ev) : LVI_BOOL(false));
}
lval var_179;
{
lval var_180[8];
var_180[0] = LVI_PROC(fn_171,var_172,1);
var_180[1] = var_178;
var_179 = wile_string_split_by(NULL, var_180);
}
var_170 = var_179;
lval var_181;
MK_CLOS(var_183,1);
P_CLOS(var_183,0) = &(var_167[1]);
lval var_201;
lval var_202[8];
var_202[0] = var_170;
var_201 = fn_182(var_183, var_202);
var_181 = var_201;
lval var_204;
if (LV_IS_FALSE(var_181)) {
lval var_205;
var_205 = LVI_STRING("unable to find file \'");
lval var_206;
var_206 = LVI_STRING("\'");
lval var_207;
{
lval var_209[3];
var_209[0] = var_205;
var_209[1] = var_167[1];
var_209[2] = var_206;
var_207 = wile_gen_list(3, var_209, NULL);
}
{
lval var_208[8];
var_208[0] = var_207;
var_207 = wile_string_append(NULL, var_208);
}
lval var_210;
{
lval var_211[1];
var_211[0] = var_207;
var_210 = wile_gen_list(1, var_211, NULL);
}
if (var_210.vt == LV_PAIR && (var_210.v.pair.cdr == NULL || var_210.v.pair.cdr->vt == LV_NIL)) {
var_210 = (var_210.v.pair.car ? *(var_210.v.pair.car) : LVI_NIL());
}
cachalot->errval = new_lv(LV_NIL);
*(cachalot->errval) = var_210;
cachalot->l_whence = 0;
cachalot->c_whence = LISP_WHENCE;
longjmp(cachalot->cenv, 1);
var_204 = var_210;
} else {
var_204 = var_181;
}
var_169 = var_204;
}
return var_169;
}
// end of function wile_eval_load_path

// @@@ (load-form? expr) @@@ bld-rtl-dir/wile-rtl2-000077.scm:97 @@@ wile_eval_load_form @@@
lval wile_eval_load_form(lptr* var_212, lptr var_213)
{
lval var_215;
var_215 = LVI_BOOL(true);
do {
lval var_216;
var_216 = LVI_BOOL(var_213[0].vt == LV_PAIR);
var_215 = var_216;
if (LV_IS_FALSE(var_215)) { break; }
lval var_217;
if (var_213[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_217 = (var_213[0].v.pair.car ? *(var_213[0].v.pair.car) : LVI_NIL());
lval var_218;
var_218 = LVI_BOOL(var_217.vt == LV_SYMBOL);
var_215 = var_218;
if (LV_IS_FALSE(var_215)) { break; }
lval var_219;
var_219 = LVI_BOOL(false);
do {
lval var_220;
if (var_213[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_220 = (var_213[0].v.pair.car ? *(var_213[0].v.pair.car) : LVI_NIL());
lval var_221;
var_221 = LVI_SYMBOL("load");
lval var_222;
var_222 = LVI_BOOL(strcmp(var_220.v.str, var_221.v.str) == 0);
var_219 = var_222;
if (!LV_IS_FALSE(var_219)) { break; }
lval var_223;
if (var_213[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_223 = (var_213[0].v.pair.car ? *(var_213[0].v.pair.car) : LVI_NIL());
lval var_224;
var_224 = LVI_SYMBOL("load-library");
lval var_225;
var_225 = LVI_BOOL(strcmp(var_223.v.str, var_224.v.str) == 0);
var_219 = var_225;
if (!LV_IS_FALSE(var_219)) { break; }
} while (0);
var_215 = var_219;
if (LV_IS_FALSE(var_215)) { break; }
lval var_226;
var_226 = LVI_INT(2);
lval var_227;
{
lval var_228[8];
var_228[0] = var_226;
var_228[1] = var_213[0];
var_227 = wile_list_length_eq(NULL, var_228);
}
var_215 = var_227;
if (LV_IS_FALSE(var_215)) { break; }
} while (0);
return var_215;
}
// end of function wile_eval_load_form

// @@@ (begin-form? expr) @@@ bld-rtl-dir/wile-rtl2-000077.scm:106 @@@ wile_eval_begin_form @@@
lval wile_eval_begin_form(lptr* var_229, lptr var_230)
{
lval var_232;
var_232 = LVI_BOOL(true);
do {
lval var_233;
var_233 = LVI_BOOL(var_230[0].vt == LV_PAIR);
var_232 = var_233;
if (LV_IS_FALSE(var_232)) { break; }
lval var_234;
if (var_230[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_234 = (var_230[0].v.pair.car ? *(var_230[0].v.pair.car) : LVI_NIL());
lval var_235;
var_235 = LVI_BOOL(var_234.vt == LV_SYMBOL);
var_232 = var_235;
if (LV_IS_FALSE(var_232)) { break; }
lval var_236;
if (var_230[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_236 = (var_230[0].v.pair.car ? *(var_230[0].v.pair.car) : LVI_NIL());
lval var_237;
var_237 = LVI_SYMBOL("begin");
lval var_238;
var_238 = LVI_BOOL(strcmp(var_236.v.str, var_237.v.str) == 0);
var_232 = var_238;
if (LV_IS_FALSE(var_232)) { break; }
lval var_239;
var_239 = LVI_INT(2);
lval var_240;
{
lval var_241[8];
var_241[0] = var_239;
var_241[1] = var_230[0];
var_240 = wile_list_length_ge(NULL, var_241);
}
var_232 = var_240;
if (LV_IS_FALSE(var_232)) { break; }
} while (0);
return var_232;
}
// end of function wile_eval_begin_form

// @@@ lambda (ls) @@@ bld-rtl-dir/wile-rtl2-000077.scm:113 @@@ fn_246 @@@
static lval fn_246(lptr* var_247, lptr var_248)
{
lbl_249:;
lval var_250;
do {
lval var_251;
var_251 = LVI_BOOL(var_248[0].vt == LV_NIL);
if (!LV_IS_FALSE(var_251)) {
lval var_252;
var_252 = LVI_BOOL(true);
var_250 = var_252;
break;
}
lval var_253;
if (var_248[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_253 = (var_248[0].v.pair.car ? *(var_248[0].v.pair.car) : LVI_NIL());
lval var_254;
var_254 = LVI_BOOL(var_253.vt == LV_SYMBOL);
if (!LV_IS_FALSE(var_254)) {
lval var_255;
if (var_248[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_255 = (var_248[0].v.pair.cdr ? *(var_248[0].v.pair.cdr) : LVI_NIL());
lval var_258[8];
var_258[0] = var_255;
var_248[0] = var_258[0];
goto lbl_249;	// selfie
}
lval var_259;
var_259 = LVI_BOOL(false);
var_250 = var_259;
} while (0);
return var_250;
}
// end of lambda fn_246

// @@@ lambda (ss) @@@ bld-rtl-dir/wile-rtl2-000077.scm:118 @@@ fn_265 @@@
static lval fn_265(lptr* var_266, lptr var_267)
{
lbl_268:;
lval var_269;
do {
lval var_270;
var_270 = LVI_BOOL(var_267[0].vt == LV_NIL);
if (!LV_IS_FALSE(var_270)) {
lval var_271;
var_271 = LVI_BOOL(true);
var_269 = var_271;
break;
}
lval var_272;
if (var_267[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_272 = (var_267[0].v.pair.cdr ? *(var_267[0].v.pair.cdr) : LVI_NIL());
lval var_273;
var_273 = LVI_BOOL(var_272.vt == LV_NIL);
if (!LV_IS_FALSE(var_273)) {
lval var_274;
var_274 = LVI_BOOL(true);
var_269 = var_274;
break;
}
lval var_275;
if (var_267[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_275 = (var_267[0].v.pair.car ? *(var_267[0].v.pair.car) : LVI_NIL());
lval var_276;
var_276 = LVI_STRING("cadr");
lval var_277;
{
char* cp = strchr(var_276.v.str, 'r');
var_277 = var_267[0];
while (*(--cp) != 'c') {
if (var_277.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_277 = (var_277.v.pair.car ? *(var_277.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_277 = (var_277.v.pair.cdr ? *(var_277.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_276.v.str);
}
}
}
lval var_278;
var_278 = LVI_BOOL(strcmp(var_275.v.str, var_277.v.str) == 0);
if (!LV_IS_FALSE(var_278)) {
lval var_279;
var_279 = LVI_BOOL(false);
var_269 = var_279;
break;
}
lval var_280;
if (var_267[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_280 = (var_267[0].v.pair.cdr ? *(var_267[0].v.pair.cdr) : LVI_NIL());
lval var_283[8];
var_283[0] = var_280;
var_267[0] = var_283[0];
goto lbl_268;	// selfie
} while (0);
return var_269;
}
// end of lambda fn_265

// @@@ lambda (a b) @@@ bld-rtl-dir/wile-rtl2-000077.scm:118 @@@ fn_284 @@@
static lval fn_284(lptr* var_285, lptr var_286)
{
lval var_288;
var_288 = LVI_BOOL(strcmp(var_286[0].v.str, var_286[1].v.str) < 0);
return var_288;
}
// end of lambda fn_284

// @@@ symbol->string @@@ bld-rtl-dir/wile-rtl2-000077.scm:119 @@@ fn_289 @@@
static lval fn_289(lptr* var_290, lptr var_291)
{
lval var_293;
var_293 = LVI_STRING(var_291[0].v.str);
return var_293;
}
// end of prim fn_289

// @@@ (unique-symbols? lst) @@@ bld-rtl-dir/wile-rtl2-000077.scm:112 @@@ fn_10 @@@
static lval fn_10(lptr* var_242, lptr var_243)
{
lval var_245;
MK_CLOS(var_247,0);
lval var_260;
lval var_261[8];
var_261[0] = var_243[0];
var_260 = fn_246(var_247, var_261);
var_245 = var_260;
lval var_263;
if (LV_IS_FALSE(var_245)) {
lval var_264;
var_264 = LVI_BOOL(false);
var_263 = var_264;
} else {
MK_CLOS(var_266,0);
MK_CLOS(var_285,0);
lval var_294;
var_294 = LVI_NIL();
{
lval var_295[8];
var_295[0] = LVI_PROC(fn_289,NULL,1);
var_295[1] = var_243[0];
var_295[2] = var_294;
var_294 = wile_map(NULL, var_295);
}
lval var_296;
{
lval var_297[8];
var_297[0] = LVI_PROC(fn_284,var_285,2);
var_297[1] = var_294;
var_296 = wile_list_sort(NULL, var_297);
}
lval var_298;
lval var_299[8];
var_299[0] = var_296;
var_298 = fn_265(var_266, var_299);
var_263 = var_298;
}
return var_263;
}
// end of function fn_10

// @@@ (symbol-lookup box? env sym) @@@ bld-rtl-dir/wile-rtl2-000077.scm:126 @@@ fn_11 @@@
static lval fn_11(lptr* var_301, lptr var_302)
{
lbl_303:;
lval var_304;
do {
lval var_305;
var_305 = LVI_BOOL(var_302[1].vt == LV_NIL);
if (!LV_IS_FALSE(var_305)) {
lval var_306;
var_306 = LVI_STRING("symbol \'%s\' lookup failed!");
lval var_309[8];
var_309[0] = var_306;
lval var_310[8];
var_310[0] = var_302[2];
var_302[1] = wile_gen_list(1, var_310, NULL);
var_302[0] = var_309[0];
TAIL_CALL fn_7(NULL, var_302);
}
lval var_311;
if (var_302[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_311 = (var_302[1].v.pair.car ? *(var_302[1].v.pair.car) : LVI_NIL());
lval var_312;
lval var_313[8];
var_313[0] = var_311;
var_312 = fn_3(NULL, var_313);
lval var_315;
var_315 = LVI_BOOL(strcmp(var_302[2].v.str, var_312.v.str) == 0);
if (!LV_IS_FALSE(var_315)) {
lval var_316;
if (LV_IS_FALSE(var_302[0])) {
lval var_317;
if (var_302[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_317 = (var_302[1].v.pair.car ? *(var_302[1].v.pair.car) : LVI_NIL());
lval var_320[8];
var_320[0] = var_317;
var_302[0] = var_320[0];
TAIL_CALL fn_4(NULL, var_302);
} else {
lval var_321;
if (var_302[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_321 = (var_302[1].v.pair.car ? *(var_302[1].v.pair.car) : LVI_NIL());
var_316 = var_321;
}
var_304 = var_316;
break;
}
lval var_322;
if (var_302[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_322 = (var_302[1].v.pair.cdr ? *(var_302[1].v.pair.cdr) : LVI_NIL());
lval var_325[8];
var_325[0] = var_302[0];
var_325[1] = var_322;
var_325[2] = var_302[2];
var_302[0] = var_325[0];
var_302[1] = var_325[1];
var_302[2] = var_325[2];
goto lbl_303;	// selfie
} while (0);
return var_304;
}
// end of function fn_11

// @@@ (eval-binding env expr) @@@ bld-rtl-dir/wile-rtl2-000077.scm:133 @@@ fn_12 @@@
static lval fn_12(lptr* var_326, lptr var_327)
{
lval var_329;
lval var_330;
var_330 = LVI_BOOL(true);
do {
lval var_331;
var_331 = LVI_BOOL(var_327[1].vt == LV_PAIR);
var_330 = var_331;
if (LV_IS_FALSE(var_330)) { break; }
lval var_332;
if (var_327[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_332 = (var_327[1].v.pair.car ? *(var_327[1].v.pair.car) : LVI_NIL());
lval var_333;
var_333 = LVI_BOOL(var_332.vt == LV_SYMBOL);
var_330 = var_333;
if (LV_IS_FALSE(var_330)) { break; }
} while (0);
if (LV_IS_FALSE(var_330)) {
lval var_334;
var_334 = LVI_STRING("malformed binding expression \'%v\'");
lval var_337[8];
var_337[0] = var_334;
lval var_338[8];
var_338[0] = var_327[1];
var_327[1] = wile_gen_list(1, var_338, NULL);
var_327[0] = var_337[0];
TAIL_CALL fn_7(NULL, var_327);
} else {
lval var_339;
if (var_327[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_339 = (var_327[1].v.pair.car ? *(var_327[1].v.pair.car) : LVI_NIL());
lval var_340;
var_340 = LVI_STRING("cadr");
lval var_341;
{
char* cp = strchr(var_340.v.str, 'r');
var_341 = var_327[1];
while (*(--cp) != 'c') {
if (var_341.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_341 = (var_341.v.pair.car ? *(var_341.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_341 = (var_341.v.pair.cdr ? *(var_341.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_340.v.str);
}
}
}
lval var_342;
lval var_343[8];
var_343[0] = var_327[0];
var_343[1] = var_341;
var_342 = wile_eval(NULL, var_343);
lval var_347[8];
var_347[0] = var_339;
var_347[1] = var_342;
var_327[0] = var_347[0];
var_327[1] = var_347[1];
TAIL_CALL fn_1(NULL, var_327);
}
return var_329;
}
// end of function fn_12

// @@@ (eval-define macro env expr) @@@ bld-rtl-dir/wile-rtl2-000077.scm:140 @@@ wile_eval_define @@@
lval wile_eval_define(lptr* var_348, lptr var_349)
{
lval var_351;
lval var_352;
do {
lval var_353;
if (var_349[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_353 = (var_349[2].v.pair.car ? *(var_349[2].v.pair.car) : LVI_NIL());
lval var_354;
var_354 = LVI_BOOL(var_353.vt == LV_SYMBOL);
if (!LV_IS_FALSE(var_354)) {
lval var_355;
lval var_356[8];
var_356[0] = var_349[1];
var_356[1] = var_349[2];
var_355 = fn_12(NULL, var_356);
var_352 = var_355;
break;
}
lval var_358;
var_358 = LVI_BOOL(true);
do {
lval var_359;
if (var_349[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_359 = (var_349[2].v.pair.car ? *(var_349[2].v.pair.car) : LVI_NIL());
lval var_360;
var_360 = LVI_BOOL(var_359.vt == LV_PAIR);
var_358 = var_360;
if (LV_IS_FALSE(var_358)) { break; }
lval var_361;
var_361 = LVI_STRING("caar");
lval var_362;
{
char* cp = strchr(var_361.v.str, 'r');
var_362 = var_349[2];
while (*(--cp) != 'c') {
if (var_362.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_362 = (var_362.v.pair.car ? *(var_362.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_362 = (var_362.v.pair.cdr ? *(var_362.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_361.v.str);
}
}
}
lval var_363;
var_363 = LVI_BOOL(var_362.vt == LV_SYMBOL);
var_358 = var_363;
if (LV_IS_FALSE(var_358)) { break; }
} while (0);
if (!LV_IS_FALSE(var_358)) {
lval var_364;
var_364 = LVI_STRING("caar");
lval var_365;
{
char* cp = strchr(var_364.v.str, 'r');
var_365 = var_349[2];
while (*(--cp) != 'c') {
if (var_365.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_365 = (var_365.v.pair.car ? *(var_365.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_365 = (var_365.v.pair.cdr ? *(var_365.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_364.v.str);
}
}
}
lval var_366;
var_366 = LVI_SYMBOL("lambda");
lval var_367;
var_367 = LVI_STRING("cdar");
lval var_368;
{
char* cp = strchr(var_367.v.str, 'r');
var_368 = var_349[2];
while (*(--cp) != 'c') {
if (var_368.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_368 = (var_368.v.pair.car ? *(var_368.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_368 = (var_368.v.pair.cdr ? *(var_368.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_367.v.str);
}
}
}
lval var_369;
if (var_349[2].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_369 = (var_349[2].v.pair.cdr ? *(var_349[2].v.pair.cdr) : LVI_NIL());
lval var_370;
{
lptr p1 = NULL, p2 = NULL;
if (var_368.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_368;
}
if (var_369.vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_369;
}
var_370 = LVI_PAIR(p1, p2);
}
lval var_371;
{
lptr p1 = NULL, p2 = NULL;
if (var_366.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_366;
}
if (var_370.vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_370;
}
var_371 = LVI_PAIR(p1, p2);
}
lval var_372;
{
lval var_373[2];
var_373[0] = var_365;
var_373[1] = var_371;
var_372 = wile_gen_list(2, var_373, NULL);
}
lval var_374;
lval var_375[8];
var_375[0] = var_349[1];
var_375[1] = var_372;
var_374 = fn_12(NULL, var_375);
var_352 = var_374;
break;
}
lval var_377;
var_377 = LVI_STRING("malformed \'define\' expression \'%v\'");
lval var_378;
lval var_379[8];
var_379[0] = var_377;
lval var_381[8];
var_381[0] = var_349[2];
var_379[1] = wile_gen_list(1, var_381, NULL);
var_378 = fn_7(NULL, var_379);
var_352 = var_378;
} while (0);
var_351 = var_352;
lval var_382;
lval var_383;
lval var_384[8];
var_384[0] = var_351;
var_383 = fn_4(NULL, var_384);
var_382 = var_383;
lval var_386;
lval var_387;
{
lptr p1 = NULL, p2 = NULL;
if (var_351.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_351;
}
if (var_349[1].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_349[1];
}
var_387 = LVI_PAIR(p1, p2);
}
var_386 = var_387;
lval var_389;
var_389 = LVI_BOOL(var_382.vt == LV_ILAMBDA);
if (LV_IS_FALSE(var_389)) {
(void)
 LVI_BOOL(false);
} else {
if (var_382.vt == LV_ILAMBDA && var_349[0].vt == LV_BOOL) {
var_382.v.ilambda->macro = var_349[0].v.bv;
} else {
WILE_EX("set-interpreted-procedure-macro!", "expects an interpreted procedure and a boolean");
}
if (var_382.vt == LV_ILAMBDA && var_386.vt == LV_PAIR) {
var_382.v.ilambda->env = var_386;
} else {
WILE_EX("set-interpreted-procedure-environment!", "expects an interpreted procedure and an environment list");
}
}
return var_386;
}
// end of function wile_eval_define

// @@@ lambda (es) @@@ bld-rtl-dir/wile-rtl2-000077.scm:162 @@@ fn_398 @@@
static lval fn_398(lptr* var_399, lptr var_400)
{
lbl_401:;
lval var_402;
lval var_403;
do {
lval var_404;
if (var_400[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_404 = (var_400[0].v.pair.car ? *(var_400[0].v.pair.car) : LVI_NIL());
lval var_405;
lval var_406[8];
var_406[0] = var_404;
var_405 = wile_eval_define_form(NULL, var_406);
if (!LV_IS_FALSE(var_405)) {
lval var_408;
var_408 = LVI_STRING("caar");
lval var_409;
{
char* cp = strchr(var_408.v.str, 'r');
var_409 = var_400[0];
while (*(--cp) != 'c') {
if (var_409.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_409 = (var_409.v.pair.car ? *(var_409.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_409 = (var_409.v.pair.cdr ? *(var_409.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_408.v.str);
}
}
}
lval var_410;
var_410 = LVI_SYMBOL("defmacro");
lval var_411;
var_411 = LVI_BOOL(strcmp(var_409.v.str, var_410.v.str) == 0);
lval var_412;
var_412 = LVI_STRING("cdar");
lval var_413;
{
char* cp = strchr(var_412.v.str, 'r');
var_413 = var_400[0];
while (*(--cp) != 'c') {
if (var_413.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_413 = (var_413.v.pair.car ? *(var_413.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_413 = (var_413.v.pair.cdr ? *(var_413.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_412.v.str);
}
}
}
lval var_414;
lval var_415[8];
var_415[0] = var_411;
var_415[1] = V_CLOS(var_399,0);
var_415[2] = var_413;
var_414 = wile_eval_define(NULL, var_415);
V_CLOS(var_399,0) = var_414;
if (LV_IS_FALSE(V_CLOS(var_399,1))) {
(void)
 LVI_BOOL(false);
} else {
lval var_420[8];
var_420[0] = V_CLOS(var_399,1);
var_420[1] = V_CLOS(var_399,0);
(void)
 fn_6(NULL, var_420);
}
lval var_422;
if (V_CLOS(var_399,0).vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_422 = (V_CLOS(var_399,0).v.pair.car ? *(V_CLOS(var_399,0).v.pair.car) : LVI_NIL());
lval var_423;
lval var_424[8];
var_424[0] = var_422;
var_423 = fn_4(NULL, var_424);
var_403 = var_423;
break;
}
lval var_426;
if (var_400[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_426 = (var_400[0].v.pair.car ? *(var_400[0].v.pair.car) : LVI_NIL());
lval var_427;
lval var_428[8];
var_428[0] = V_CLOS(var_399,0);
var_428[1] = var_426;
var_427 = wile_eval(NULL, var_428);
var_403 = var_427;
} while (0);
var_402 = var_403;
lval var_430;
lval var_431;
if (var_400[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_431 = (var_400[0].v.pair.cdr ? *(var_400[0].v.pair.cdr) : LVI_NIL());
lval var_432;
var_432 = LVI_BOOL(var_431.vt == LV_NIL);
if (LV_IS_FALSE(var_432)) {
lval var_433;
if (var_400[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_433 = (var_400[0].v.pair.cdr ? *(var_400[0].v.pair.cdr) : LVI_NIL());
lval var_436[8];
var_436[0] = var_433;
var_400[0] = var_436[0];
goto lbl_401;	// selfie
} else {
var_430 = var_402;
}
return var_430;
}
// end of lambda fn_398

// @@@ (eval-begin ebox env expr) @@@ bld-rtl-dir/wile-rtl2-000077.scm:159 @@@ wile_eval_begin @@@
lval wile_eval_begin(lptr* var_393, lptr var_394)
{
lval var_396;
lval var_397;
var_397 = LVI_BOOL(var_394[2].vt == LV_NIL);
if (LV_IS_FALSE(var_397)) {
MK_CLOS(var_399,2);
P_CLOS(var_399,1) = &(var_394[0]);
P_CLOS(var_399,0) = &(var_394[1]);
lval var_437;
lval var_438[8];
var_438[0] = var_394[2];
var_437 = fn_398(var_399, var_438);
var_396 = var_437;
} else {
lval var_440;
var_440 = LVI_NIL();
var_396 = var_440;
}
return var_396;
}
// end of function wile_eval_begin

// @@@ lambda (a1) @@@ bld-rtl-dir/wile-rtl2-000077.scm:178 @@@ fn_459 @@@
static lval fn_459(lptr* var_460, lptr var_461)
{
lval var_463;
var_463 = LVI_STRING("caddr");
lval var_464;
{
char* cp = strchr(var_463.v.str, 'r');
var_464 = var_461[0];
while (*(--cp) != 'c') {
if (var_464.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_464 = (var_464.v.pair.car ? *(var_464.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_464 = (var_464.v.pair.cdr ? *(var_464.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_463.v.str);
}
}
}
return var_464;
}
// end of lambda fn_459

// @@@ lambda (a1) @@@ bld-rtl-dir/wile-rtl2-000077.scm:178 @@@ fn_465 @@@
static lval fn_465(lptr* var_466, lptr var_467)
{
lval var_469;
var_469 = LVI_STRING("cadr");
lval var_470;
{
char* cp = strchr(var_469.v.str, 'r');
var_470 = var_467[0];
while (*(--cp) != 'c') {
if (var_470.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_470 = (var_470.v.pair.car ? *(var_470.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_470 = (var_470.v.pair.cdr ? *(var_470.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_469.v.str);
}
}
}
return var_470;
}
// end of lambda fn_465

// @@@ (eval-if env exprs) @@@ bld-rtl-dir/wile-rtl2-000077.scm:175 @@@ fn_13 @@@
static lval fn_13(lptr* var_441, lptr var_442)
{
lval var_444;
lval var_445;
var_445 = LVI_INT(3);
lval var_446;
{
lval var_447[8];
var_447[0] = var_445;
var_447[1] = var_442[1];
var_446 = wile_list_length_eq(NULL, var_447);
}
if (LV_IS_FALSE(var_446)) {
lval var_448;
var_448 = LVI_STRING("malformed \'if\' expression \'%v\'");
lval var_451[8];
var_451[0] = var_448;
lval var_452[8];
var_452[0] = var_442[1];
var_442[1] = wile_gen_list(1, var_452, NULL);
var_442[0] = var_451[0];
TAIL_CALL fn_7(NULL, var_442);
} else {
lval var_453;
lval var_454;
if (var_442[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_454 = (var_442[1].v.pair.car ? *(var_442[1].v.pair.car) : LVI_NIL());
lval var_455;
lval var_456[8];
var_456[0] = var_442[0];
var_456[1] = var_454;
var_455 = wile_eval(NULL, var_456);
var_453 = var_455;
lval var_458;
if (LV_IS_FALSE(var_453)) {
MK_CLOS(var_460,0);
var_458 = LVI_PROC(fn_459,var_460,1);
} else {
MK_CLOS(var_466,0);
var_458 = LVI_PROC(fn_465,var_466,1);
}
lval var_471;
{
lval var_472[1];
var_472[0] = var_442[1];
var_471 = wile_gen_list(1, var_472, NULL);
}
lval var_473;
{
lval var_474[2];
var_474[0] = var_458;
var_474[1] = var_471;
var_473 = wile_gen_list(2, var_474, NULL);
}
var_473 = wile_apply_function(&(var_473), __FILE__, __LINE__);
lval var_477[8];
var_477[0] = var_442[0];
var_477[1] = var_473;
var_442[0] = var_477[0];
var_442[1] = var_477[1];
TAIL_CALL wile_eval(NULL, var_442);
}
return var_444;
}
// end of function fn_13

// @@@ (eval-and init env exprs) @@@ bld-rtl-dir/wile-rtl2-000077.scm:181 @@@ fn_14 @@@
static lval fn_14(lptr* var_478, lptr var_479)
{
lbl_480:;
lval var_481;
do {
lval var_482;
var_482 = LVI_BOOL(LV_IS_FALSE(var_479[0]));
if (!LV_IS_FALSE(var_482)) {
var_481 = var_479[0];
break;
}
lval var_483;
var_483 = LVI_BOOL(var_479[2].vt == LV_NIL);
if (!LV_IS_FALSE(var_483)) {
var_481 = var_479[0];
break;
}
lval var_484;
if (var_479[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_484 = (var_479[2].v.pair.car ? *(var_479[2].v.pair.car) : LVI_NIL());
lval var_485;
lval var_486[8];
var_486[0] = var_479[1];
var_486[1] = var_484;
var_485 = wile_eval(NULL, var_486);
lval var_488;
if (var_479[2].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_488 = (var_479[2].v.pair.cdr ? *(var_479[2].v.pair.cdr) : LVI_NIL());
lval var_491[8];
var_491[0] = var_485;
var_491[1] = var_479[1];
var_491[2] = var_488;
var_479[0] = var_491[0];
var_479[1] = var_491[1];
var_479[2] = var_491[2];
goto lbl_480;	// selfie
} while (0);
return var_481;
}
// end of function fn_14

// @@@ (eval-or init env exprs) @@@ bld-rtl-dir/wile-rtl2-000077.scm:187 @@@ fn_15 @@@
static lval fn_15(lptr* var_492, lptr var_493)
{
lbl_494:;
lval var_495;
do {
if (!LV_IS_FALSE(var_493[0])) {
var_495 = var_493[0];
break;
}
lval var_496;
var_496 = LVI_BOOL(var_493[2].vt == LV_NIL);
if (!LV_IS_FALSE(var_496)) {
var_495 = var_493[0];
break;
}
lval var_497;
if (var_493[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_497 = (var_493[2].v.pair.car ? *(var_493[2].v.pair.car) : LVI_NIL());
lval var_498;
lval var_499[8];
var_499[0] = var_493[1];
var_499[1] = var_497;
var_498 = wile_eval(NULL, var_499);
lval var_501;
if (var_493[2].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_501 = (var_493[2].v.pair.cdr ? *(var_493[2].v.pair.cdr) : LVI_NIL());
lval var_504[8];
var_504[0] = var_498;
var_504[1] = var_493[1];
var_504[2] = var_501;
var_493[0] = var_504[0];
var_493[1] = var_504[1];
var_493[2] = var_504[2];
goto lbl_494;	// selfie
} while (0);
return var_495;
}
// end of function fn_15

// @@@ lambda (bv) @@@ bld-rtl-dir/wile-rtl2-000077.scm:198 @@@ fn_529 @@@
static lval fn_529(lptr* var_530, lptr var_531)
{
lval var_533;
lval var_534;
{
var_534 = var_531[0];
while (var_534.vt == LV_PAIR) {
var_534 = (var_534.v.pair.cdr ? *(var_534.v.pair.cdr) : LVI_NIL());
}
var_534 = LVI_BOOL(var_534.vt == LV_NIL);
}
if (LV_IS_FALSE(var_534)) {
lval var_535;
var_535 = LVI_STRING("malformed \'%s\' binding \'%v\' is not a list");
lval var_538[8];
var_538[0] = var_535;
lval var_539[8];
var_539[0] = V_CLOS(var_530,0);
var_539[1] = var_531[0];
var_531[1] = wile_gen_list(2, var_539, NULL);
var_531[0] = var_538[0];
TAIL_CALL fn_7(NULL, var_531);
} else {
lval var_540;
var_540 = LVI_BOOL(false);
var_533 = var_540;
}
return var_533;
}
// end of lambda fn_529

// @@@ car @@@ bld-rtl-dir/wile-rtl2-000077.scm:203 @@@ fn_544 @@@
static lval fn_544(lptr* var_545, lptr var_546)
{
lval var_548;
if (var_546[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_548 = (var_546[0].v.pair.car ? *(var_546[0].v.pair.car) : LVI_NIL());
return var_548;
}
// end of prim fn_544

// @@@ (check-let-bindings type llist) @@@ bld-rtl-dir/wile-rtl2-000077.scm:193 @@@ fn_16 @@@
static lval fn_16(lptr* var_505, lptr var_506)
{
lval var_508;
lval var_509;
var_509 = LVI_BOOL(true);
do {
lval var_510;
{
var_510 = var_506[1];
while (var_510.vt == LV_PAIR) {
var_510 = (var_510.v.pair.cdr ? *(var_510.v.pair.cdr) : LVI_NIL());
}
var_510 = LVI_BOOL(var_510.vt == LV_NIL);
}
var_509 = var_510;
if (LV_IS_FALSE(var_509)) { break; }
lval var_511;
var_511 = LVI_INT(2);
lval var_512;
{
lval var_513[8];
var_513[0] = var_511;
var_513[1] = var_506[1];
var_512 = wile_list_length_ge(NULL, var_513);
}
var_509 = var_512;
if (LV_IS_FALSE(var_509)) { break; }
} while (0);
if (LV_IS_FALSE(var_509)) {
lval var_514;
var_514 = LVI_STRING("malformed \'%s\' expression \'%v\'");
lval var_517[8];
var_517[0] = var_514;
lval var_518[8];
var_518[0] = var_506[0];
var_518[1] = var_506[1];
var_506[1] = wile_gen_list(2, var_518, NULL);
var_506[0] = var_517[0];
TAIL_CALL fn_7(NULL, var_506);
} else {
lval var_519;
lval var_520;
if (var_506[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_520 = (var_506[1].v.pair.car ? *(var_506[1].v.pair.car) : LVI_NIL());
var_519 = var_520;
lval var_522;
{
var_522 = var_519;
while (var_522.vt == LV_PAIR) {
var_522 = (var_522.v.pair.cdr ? *(var_522.v.pair.cdr) : LVI_NIL());
}
var_522 = LVI_BOOL(var_522.vt == LV_NIL);
}
if (LV_IS_FALSE(var_522)) {
lval var_523;
var_523 = LVI_STRING("malformed \'%s\' bindings \'%v\' are not a list");
lval var_525[8];
var_525[0] = var_523;
lval var_527[8];
var_527[0] = var_506[0];
var_527[1] = var_519;
var_525[1] = wile_gen_list(2, var_527, NULL);
(void)
 fn_7(NULL, var_525);
} else {
(void)
 LVI_BOOL(false);
}
MK_CLOS(var_530,1);
P_CLOS(var_530,0) = &(var_506[0]);
lval var_541;
var_541 = LVI_NIL();
{
lval var_542[8];
var_542[0] = LVI_PROC(fn_529,var_530,1);
var_542[1] = var_519;
var_542[2] = var_541;
var_541 = wile_for_each(NULL, var_542);
}
lval var_543;
lval var_549;
var_549 = LVI_NIL();
{
lval var_550[8];
var_550[0] = LVI_PROC(fn_544,NULL,1);
var_550[1] = var_519;
var_550[2] = var_549;
var_549 = wile_map(NULL, var_550);
}
var_543 = var_549;
lval var_551;
lval var_552;
lval var_553[8];
var_553[0] = var_543;
var_552 = fn_10(NULL, var_553);
if (LV_IS_FALSE(var_552)) {
lval var_555;
var_555 = LVI_STRING("malformed \'%s\' bindings list \'%v\'");
lval var_558[8];
var_558[0] = var_555;
lval var_559[8];
var_559[0] = var_506[0];
var_559[1] = var_543;
var_506[1] = wile_gen_list(2, var_559, NULL);
var_506[0] = var_558[0];
TAIL_CALL fn_7(NULL, var_506);
} else {
lval var_560;
var_560 = LVI_BOOL(false);
var_551 = var_560;
}
var_508 = var_551;
}
return var_508;
}
// end of function fn_16

// @@@ car @@@ bld-rtl-dir/wile-rtl2-000077.scm:213 @@@ fn_581 @@@
static lval fn_581(lptr* var_582, lptr var_583)
{
lval var_585;
if (var_583[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_585 = (var_583[0].v.pair.car ? *(var_583[0].v.pair.car) : LVI_NIL());
return var_585;
}
// end of prim fn_581

// @@@ lambda (v) @@@ bld-rtl-dir/wile-rtl2-000077.scm:214 @@@ fn_591 @@@
static lval fn_591(lptr* var_592, lptr var_593)
{
lval var_595;
var_595 = LVI_STRING("cadr");
lval var_596;
{
char* cp = strchr(var_595.v.str, 'r');
var_596 = var_593[0];
while (*(--cp) != 'c') {
if (var_596.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_596 = (var_596.v.pair.car ? *(var_596.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_596 = (var_596.v.pair.cdr ? *(var_596.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_595.v.str);
}
}
}
lval var_599[8];
var_599[0] = V_CLOS(var_592,0);
var_599[1] = var_596;
var_593[0] = var_599[0];
var_593[1] = var_599[1];
TAIL_CALL wile_eval(NULL, var_593);
}
// end of lambda fn_591

// @@@ lambda (iex) @@@ bld-rtl-dir/wile-rtl2-000077.scm:223 @@@ fn_637 @@@
static lval fn_637(lptr* var_638, lptr var_639)
{
lval var_641;
lval var_642;
lval var_643[8];
var_643[0] = V_CLOS(var_638,0);
var_643[1] = var_639[0];
var_642 = fn_12(NULL, var_643);
var_641 = var_642;
if (LV_IS_FALSE(V_CLOS(var_638,1))) {
(void)
 LVI_BOOL(false);
} else {
lval var_647;
{
lptr p1 = NULL, p2 = NULL;
if (var_641.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_641;
}
if (V_CLOS(var_638,0).vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = V_CLOS(var_638,0);
}
var_647 = LVI_PAIR(p1, p2);
}
V_CLOS(var_638,0) = var_647;
(void)
 V_CLOS(var_638,0);
}
return var_641;
}
// end of lambda fn_637

// @@@ lambda (box) @@@ bld-rtl-dir/wile-rtl2-000077.scm:231 @@@ fn_660 @@@
static lval fn_660(lptr* var_661, lptr var_662)
{
lval var_664;
lval var_665;
lval var_666[8];
var_666[0] = var_662[0];
var_665 = fn_4(NULL, var_666);
var_664 = var_665;
lval var_668;
lval var_669;
var_669 = LVI_BOOL(var_664.vt == LV_ILAMBDA);
if (LV_IS_FALSE(var_669)) {
lval var_670;
var_670 = LVI_BOOL(false);
var_668 = var_670;
} else {
lval var_671;
if (var_664.vt == LV_ILAMBDA && V_CLOS(var_661,0).vt == LV_PAIR) {
var_664.v.ilambda->env = V_CLOS(var_661,0);
var_671 = var_664;
} else {
WILE_EX("set-interpreted-procedure-environment!", "expects an interpreted procedure and an environment list");
}
var_668 = var_671;
}
return var_668;
}
// end of lambda fn_660

// @@@ (eval-let rec? star? env exprs) @@@ bld-rtl-dir/wile-rtl2-000077.scm:208 @@@ fn_17 @@@
static lval fn_17(lptr* var_561, lptr var_562)
{
lval var_564;
do {
lval var_565;
var_565 = LVI_BOOL(var_562[3].vt == LV_NIL);
if (!LV_IS_FALSE(var_565)) {
lval var_566;
var_566 = LVI_STRING("malformed \'let\' expression \'%v\'");
lval var_569[8];
var_569[0] = var_566;
lval var_570[8];
var_570[0] = var_562[3];
var_562[1] = wile_gen_list(1, var_570, NULL);
var_562[0] = var_569[0];
TAIL_CALL fn_7(NULL, var_562);
}
lval var_571;
var_571 = LVI_BOOL(true);
do {
lval var_572;
{
var_572 = var_562[3];
while (var_572.vt == LV_PAIR) {
var_572 = (var_572.v.pair.cdr ? *(var_572.v.pair.cdr) : LVI_NIL());
}
var_572 = LVI_BOOL(var_572.vt == LV_NIL);
}
var_571 = var_572;
if (LV_IS_FALSE(var_571)) { break; }
lval var_573;
if (var_562[3].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_573 = (var_562[3].v.pair.car ? *(var_562[3].v.pair.car) : LVI_NIL());
lval var_574;
var_574 = LVI_BOOL(var_573.vt == LV_SYMBOL);
var_571 = var_574;
if (LV_IS_FALSE(var_571)) { break; }
} while (0);
if (!LV_IS_FALSE(var_571)) {
lval var_575;
var_575 = LVI_STRING("named-let");
lval var_576;
if (var_562[3].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_576 = (var_562[3].v.pair.cdr ? *(var_562[3].v.pair.cdr) : LVI_NIL());
lval var_578[8];
var_578[0] = var_575;
var_578[1] = var_576;
(void)
 fn_16(NULL, var_578);
lval var_580;
lval var_586;
var_586 = LVI_STRING("cadr");
lval var_587;
{
char* cp = strchr(var_586.v.str, 'r');
var_587 = var_562[3];
while (*(--cp) != 'c') {
if (var_587.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_587 = (var_587.v.pair.car ? *(var_587.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_587 = (var_587.v.pair.cdr ? *(var_587.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_586.v.str);
}
}
}
lval var_588;
var_588 = LVI_NIL();
{
lval var_589[8];
var_589[0] = LVI_PROC(fn_581,NULL,1);
var_589[1] = var_587;
var_589[2] = var_588;
var_588 = wile_map(NULL, var_589);
}
var_580 = var_588;
lval var_590;
MK_CLOS(var_592,1);
P_CLOS(var_592,0) = &(var_562[2]);
lval var_600;
var_600 = LVI_STRING("cadr");
lval var_601;
{
char* cp = strchr(var_600.v.str, 'r');
var_601 = var_562[3];
while (*(--cp) != 'c') {
if (var_601.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_601 = (var_601.v.pair.car ? *(var_601.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_601 = (var_601.v.pair.cdr ? *(var_601.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_600.v.str);
}
}
}
lval var_602;
var_602 = LVI_NIL();
{
lval var_603[8];
var_603[0] = LVI_PROC(fn_591,var_592,1);
var_603[1] = var_601;
var_603[2] = var_602;
var_602 = wile_map(NULL, var_603);
}
var_590 = var_602;
lval var_604;
lval var_605;
{
lval var_606[8];
var_606[0] = var_580;
var_605 = wile_list_length(NULL, var_606);
}
lval var_607;
var_607 = LVI_STRING("cddr");
lval var_608;
{
char* cp = strchr(var_607.v.str, 'r');
var_608 = var_562[3];
while (*(--cp) != 'c') {
if (var_608.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_608 = (var_608.v.pair.car ? *(var_608.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_608 = (var_608.v.pair.cdr ? *(var_608.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_607.v.str);
}
}
}
lval var_609;
var_609 = LVI_NIL();
lval var_610;
var_610 = LVI_BOOL(false);
lval var_611;
if ((var_580.vt == LV_PAIR || var_580.vt == LV_NIL) && var_605.vt == LV_INT &&(var_608.vt == LV_PAIR || var_608.vt == LV_NIL) &&(var_609.vt == LV_PAIR || var_609.vt == LV_NIL) && var_610.vt == LV_BOOL) {
var_611.vt = LV_ILAMBDA;
var_611.v.ilambda = LISP_ALLOC(lisp_ifunc_t, 1);
if (var_611.v.ilambda == NULL) {
WILE_EX("make-interpreted-procedure", "memory allocation failed!");
}
var_611.v.ilambda->args = var_580;
var_611.v.ilambda->arity = var_605.v.iv;
var_611.v.ilambda->body = var_608;
var_611.v.ilambda->env = var_609;
var_611.v.ilambda->macro = var_610.v.bv;
} else {
WILE_EX("make-interpreted-procedure", "expects a list of arguments, an integer arity, a list of body expressions, an environment list, and a macro boolean");
}
var_604 = var_611;
lval var_612;
lval var_613;
if (var_562[3].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_613 = (var_562[3].v.pair.car ? *(var_562[3].v.pair.car) : LVI_NIL());
lval var_614;
lval var_615[8];
var_615[0] = var_613;
var_615[1] = var_604;
var_614 = fn_1(NULL, var_615);
lval var_617;
{
lptr p1 = NULL, p2 = NULL;
if (var_614.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_614;
}
if (var_562[2].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_562[2];
}
var_617 = LVI_PAIR(p1, p2);
}
var_612 = var_617;
if (var_604.vt == LV_ILAMBDA && var_612.vt == LV_PAIR) {
var_604.v.ilambda->env = var_612;
} else {
WILE_EX("set-interpreted-procedure-environment!", "expects an interpreted procedure and an environment list");
}
lval var_621[8];
var_621[0] = var_604;
var_621[1] = var_590;
var_562[0] = var_621[0];
var_562[1] = var_621[1];
TAIL_CALL wile_eval_apply_lambda(NULL, var_562);
}
lval var_622;
var_622 = LVI_STRING("let");
lval var_623;
if (LV_IS_FALSE(var_562[0])) {
lval var_624;
var_624 = LVI_STRING("");
var_623 = var_624;
} else {
lval var_625;
var_625 = LVI_STRING("rec");
var_623 = var_625;
}
lval var_626;
if (LV_IS_FALSE(var_562[1])) {
lval var_627;
var_627 = LVI_STRING("");
var_626 = var_627;
} else {
lval var_628;
var_628 = LVI_STRING("*");
var_626 = var_628;
}
lval var_629;
{
lval var_631[3];
var_631[0] = var_622;
var_631[1] = var_623;
var_631[2] = var_626;
var_629 = wile_gen_list(3, var_631, NULL);
}
{
lval var_630[8];
var_630[0] = var_629;
var_629 = wile_string_append(NULL, var_630);
}
lval var_633[8];
var_633[0] = var_629;
var_633[1] = var_562[3];
(void)
 fn_16(NULL, var_633);
lval var_635;
var_635 = var_562[2];
lval var_636;
MK_CLOS(var_638,2);
P_CLOS(var_638,1) = &(var_562[1]);
P_CLOS(var_638,0) = &(var_635);
lval var_648;
if (var_562[3].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_648 = (var_562[3].v.pair.car ? *(var_562[3].v.pair.car) : LVI_NIL());
lval var_649;
var_649 = LVI_NIL();
{
lval var_650[8];
var_650[0] = LVI_PROC(fn_637,var_638,1);
var_650[1] = var_648;
var_650[2] = var_649;
var_649 = wile_map(NULL, var_650);
}
var_636 = var_649;
if (LV_IS_FALSE(var_562[1])) {
lval var_652;
{
lval var_653[8];
var_653[0] = var_636;
var_652 = wile_list_reverse(NULL, var_653);
}
lval var_654;
{
lval var_656[2];
var_656[0] = var_652;
var_656[1] = var_562[2];
var_654 = wile_gen_list(2, var_656, NULL);
}
{
lval var_655[8];
var_655[0] = var_654;
var_654 = wile_list_append(NULL, var_655);
}
var_635 = var_654;
} else {
(void)
 LVI_BOOL(false);
}
if (LV_IS_FALSE(var_562[0])) {
(void)
 LVI_BOOL(false);
} else {
MK_CLOS(var_661,1);
P_CLOS(var_661,0) = &(var_635);
lval var_672;
var_672 = LVI_NIL();
{
lval var_673[8];
var_673[0] = LVI_PROC(fn_660,var_661,1);
var_673[1] = var_636;
var_673[2] = var_672;
var_672 = wile_for_each(NULL, var_673);
}
}
lval var_674;
var_674 = LVI_BOOL(false);
lval var_675;
if (var_562[3].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_675 = (var_562[3].v.pair.cdr ? *(var_562[3].v.pair.cdr) : LVI_NIL());
lval var_678[8];
var_678[0] = var_674;
var_678[1] = var_635;
var_678[2] = var_675;
var_562[0] = var_678[0];
var_562[1] = var_678[1];
var_562[2] = var_678[2];
TAIL_CALL wile_eval_begin(NULL, var_562);
} while (0);
return var_564;
}
// end of function fn_17

// @@@ (eval-qq-olist level env expr) @@@ bld-rtl-dir/wile-rtl2-000077.scm:238 @@@ fn_18 @@@
static lval fn_18(lptr* var_679, lptr var_680)
{
lval var_682;
lval var_683;
if (var_680[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_683 = (var_680[2].v.pair.car ? *(var_680[2].v.pair.car) : LVI_NIL());
lval var_684;
lval var_685[8];
var_685[0] = var_680[0];
var_685[1] = var_680[1];
var_685[2] = var_683;
var_684 = fn_19(NULL, var_685);
var_682 = var_684;
lval var_687;
lval var_688;
if (var_680[2].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_688 = (var_680[2].v.pair.cdr ? *(var_680[2].v.pair.cdr) : LVI_NIL());
lval var_689;
lval var_690[8];
var_690[0] = var_680[0];
var_690[1] = var_680[1];
var_690[2] = var_688;
var_689 = fn_19(NULL, var_690);
var_687 = var_689;
lval var_692;
lval var_693;
var_693 = LVI_BOOL(true);
do {
lval var_694;
if (var_680[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_694 = (var_680[2].v.pair.car ? *(var_680[2].v.pair.car) : LVI_NIL());
lval var_695;
var_695 = LVI_BOOL(var_694.vt == LV_PAIR);
var_693 = var_695;
if (LV_IS_FALSE(var_693)) { break; }
lval var_696;
var_696 = LVI_STRING("caar");
lval var_697;
{
char* cp = strchr(var_696.v.str, 'r');
var_697 = var_680[2];
while (*(--cp) != 'c') {
if (var_697.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_697 = (var_697.v.pair.car ? *(var_697.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_697 = (var_697.v.pair.cdr ? *(var_697.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_696.v.str);
}
}
}
lval var_698;
var_698 = LVI_BOOL(var_697.vt == LV_SYMBOL);
var_693 = var_698;
if (LV_IS_FALSE(var_693)) { break; }
lval var_699;
var_699 = LVI_STRING("caar");
lval var_700;
{
char* cp = strchr(var_699.v.str, 'r');
var_700 = var_680[2];
while (*(--cp) != 'c') {
if (var_700.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_700 = (var_700.v.pair.car ? *(var_700.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_700 = (var_700.v.pair.cdr ? *(var_700.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_699.v.str);
}
}
}
lval var_701;
var_701 = LVI_SYMBOL("unquote-splicing");
lval var_702;
var_702 = LVI_BOOL(strcmp(var_700.v.str, var_701.v.str) == 0);
var_693 = var_702;
if (LV_IS_FALSE(var_693)) { break; }
} while (0);
var_692 = var_693;
lval var_703;
if (LV_IS_FALSE(var_692)) {
lval var_704;
{
lptr p1 = NULL, p2 = NULL;
if (var_682.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_682;
}
if (var_687.vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_687;
}
var_704 = LVI_PAIR(p1, p2);
}
var_703 = var_704;
} else {
lval var_705;
{
lval var_707[2];
var_707[0] = var_682;
var_707[1] = var_687;
var_705 = wile_gen_list(2, var_707, NULL);
}
{
lval var_706[8];
var_706[0] = var_705;
var_705 = wile_list_append(NULL, var_706);
}
var_703 = var_705;
}
return var_703;
}
// end of function fn_18

// @@@ (eval-qq level env expr) @@@ bld-rtl-dir/wile-rtl2-000077.scm:246 @@@ fn_19 @@@
static lval fn_19(lptr* var_708, lptr var_709)
{
lval var_711;
do {
lval var_712;
lval var_713[8];
var_713[0] = var_709[2];
var_712 = fn_8(NULL, var_713);
if (!LV_IS_FALSE(var_712)) {
var_711 = var_709[2];
break;
}
lval var_715;
var_715 = LVI_BOOL(var_709[2].vt == LV_SYMBOL);
if (!LV_IS_FALSE(var_715)) {
lval var_716;
lval var_717;
switch (var_709[0].vt) {
case LV_REAL:
var_717 = LVI_BOOL(var_709[0].v.rv > 0.0);
break;
case LV_RAT:
var_717 = LVI_BOOL((var_709[0].v.irv.num > 0 && var_709[0].v.irv.den >= 0) || (var_709[0].v.irv.num < 0 && var_709[0].v.irv.den < 0));
break;
case LV_INT:
var_717 = LVI_BOOL(var_709[0].v.iv > 0);
break;
default:
WILE_EX("positive?", "expects a real-valued number");
}
if (LV_IS_FALSE(var_717)) {
lval var_718;
var_718 = LVI_BOOL(false);
lval var_721[8];
var_721[0] = var_718;
var_721[1] = var_709[1];
var_721[2] = var_709[2];
var_709[0] = var_721[0];
var_709[1] = var_721[1];
var_709[2] = var_721[2];
TAIL_CALL fn_11(NULL, var_709);
} else {
var_716 = var_709[2];
}
var_711 = var_716;
break;
}
lval var_722;
var_722 = LVI_BOOL(var_709[2].vt == LV_PAIR);
if (!LV_IS_FALSE(var_722)) {
lval var_723;
lval var_724;
if (var_709[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_724 = (var_709[2].v.pair.car ? *(var_709[2].v.pair.car) : LVI_NIL());
lval var_725;
var_725 = LVI_BOOL(var_724.vt == LV_SYMBOL);
if (LV_IS_FALSE(var_725)) {
lval var_728[8];
var_728[0] = var_709[0];
var_728[1] = var_709[1];
var_728[2] = var_709[2];
var_709[0] = var_728[0];
var_709[1] = var_728[1];
var_709[2] = var_728[2];
TAIL_CALL fn_18(NULL, var_709);
} else {
lval var_729;
do {
lval var_730;
var_730 = LVI_BOOL(false);
do {
lval var_731;
if (var_709[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_731 = (var_709[2].v.pair.car ? *(var_709[2].v.pair.car) : LVI_NIL());
lval var_732;
var_732 = LVI_SYMBOL("unquote");
lval var_733;
var_733 = LVI_BOOL(strcmp(var_731.v.str, var_732.v.str) == 0);
var_730 = var_733;
if (!LV_IS_FALSE(var_730)) { break; }
lval var_734;
if (var_709[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_734 = (var_709[2].v.pair.car ? *(var_709[2].v.pair.car) : LVI_NIL());
lval var_735;
var_735 = LVI_SYMBOL("unquote-splicing");
lval var_736;
var_736 = LVI_BOOL(strcmp(var_734.v.str, var_735.v.str) == 0);
var_730 = var_736;
if (!LV_IS_FALSE(var_730)) { break; }
} while (0);
if (!LV_IS_FALSE(var_730)) {
lval var_737;
lval var_738;
var_738 = LVI_INT(1);
lval var_739;
switch (TYPE_COMBO(var_709[0].vt,var_738.vt)) {
case TYPE_COMBO(LV_INT,LV_INT):
var_739 = LVI_BOOL(var_709[0].v.iv == var_738.v.iv);
break;
case TYPE_COMBO(LV_INT,LV_RAT):
var_739 = LVI_BOOL(var_709[0].v.iv * var_738.v.irv.den == var_738.v.irv.num);
break;
case TYPE_COMBO(LV_INT,LV_REAL):
var_739 = LVI_BOOL(var_709[0].v.iv == var_738.v.rv);
break;
case TYPE_COMBO(LV_RAT,LV_INT):
var_739 = LVI_BOOL(var_709[0].v.irv.num == var_738.v.iv * var_709[0].v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_RAT):
var_739 = LVI_BOOL(var_709[0].v.irv.num * var_738.v.irv.den == var_738.v.irv.num * var_709[0].v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_REAL):
var_739 = LVI_BOOL(var_709[0].v.irv.num == var_738.v.rv * var_709[0].v.irv.den);
break;
case TYPE_COMBO(LV_REAL,LV_INT):
var_739 = LVI_BOOL(var_709[0].v.rv == var_738.v.iv);
break;
case TYPE_COMBO(LV_REAL,LV_RAT):
var_739 = LVI_BOOL(var_709[0].v.rv * var_738.v.irv.den == var_738.v.irv.num);
break;
case TYPE_COMBO(LV_REAL,LV_REAL):
var_739 = LVI_BOOL(var_709[0].v.rv == var_738.v.rv);
break;
default:
WILE_EX("==", "inputs are not real-valued numbers");
break;
}
if (LV_IS_FALSE(var_739)) {
lval var_740;
var_740 = LVI_INT(1);
lval var_741;
{
lval var_743[2];
var_743[0] = var_709[0];
var_743[1] = var_740;
var_741 = wile_gen_list(2, var_743, NULL);
}
{
lval var_742[8];
var_742[0] = var_741;
var_741 = wile_subtract(NULL, var_742);
}
lval var_746[8];
var_746[0] = var_741;
var_746[1] = var_709[1];
var_746[2] = var_709[2];
var_709[0] = var_746[0];
var_709[1] = var_746[1];
var_709[2] = var_746[2];
TAIL_CALL fn_18(NULL, var_709);
} else {
lval var_747;
var_747 = LVI_STRING("cadr");
lval var_748;
{
char* cp = strchr(var_747.v.str, 'r');
var_748 = var_709[2];
while (*(--cp) != 'c') {
if (var_748.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_748 = (var_748.v.pair.car ? *(var_748.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_748 = (var_748.v.pair.cdr ? *(var_748.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_747.v.str);
}
}
}
lval var_751[8];
var_751[0] = var_709[1];
var_751[1] = var_748;
var_709[0] = var_751[0];
var_709[1] = var_751[1];
TAIL_CALL wile_eval(NULL, var_709);
}
var_729 = var_737;
break;
}
lval var_752;
if (var_709[2].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_752 = (var_709[2].v.pair.car ? *(var_709[2].v.pair.car) : LVI_NIL());
lval var_753;
var_753 = LVI_SYMBOL("quasiquote");
lval var_754;
var_754 = LVI_BOOL(strcmp(var_752.v.str, var_753.v.str) == 0);
if (!LV_IS_FALSE(var_754)) {
lval var_755;
var_755 = LVI_INT(1);
lval var_756;
{
lval var_758[2];
var_758[0] = var_709[0];
var_758[1] = var_755;
var_756 = wile_gen_list(2, var_758, NULL);
}
{
lval var_757[8];
var_757[0] = var_756;
var_756 = wile_add(NULL, var_757);
}
lval var_761[8];
var_761[0] = var_756;
var_761[1] = var_709[1];
var_761[2] = var_709[2];
var_709[0] = var_761[0];
var_709[1] = var_761[1];
var_709[2] = var_761[2];
TAIL_CALL fn_18(NULL, var_709);
}
lval var_764[8];
var_764[0] = var_709[0];
var_764[1] = var_709[1];
var_764[2] = var_709[2];
var_709[0] = var_764[0];
var_709[1] = var_764[1];
var_709[2] = var_764[2];
TAIL_CALL fn_18(NULL, var_709);
} while (0);
var_723 = var_729;
}
var_711 = var_723;
break;
}
lval var_765;
var_765 = LVI_BOOL(var_709[2].vt == LV_VECTOR);
if (!LV_IS_FALSE(var_765)) {
lval var_766;
{
lval var_767[8];
var_767[0] = var_709[2];
var_766 = wile_vector2list(NULL, var_767);
}
lval var_768;
lval var_769[8];
var_769[0] = var_709[0];
var_769[1] = var_709[1];
var_769[2] = var_766;
var_768 = fn_18(NULL, var_769);
lval var_771;
{
lval var_772[8];
var_772[0] = var_768;
var_771 = wile_list2vector(NULL, var_772);
}
var_711 = var_771;
break;
}
lval var_773;
var_773 = LVI_STRING("malformed \'quasiquote\' expression \'%v\'");
lval var_776[8];
var_776[0] = var_773;
lval var_777[8];
var_777[0] = var_709[2];
var_709[1] = wile_gen_list(1, var_777, NULL);
var_709[0] = var_776[0];
TAIL_CALL fn_7(NULL, var_709);
} while (0);
return var_711;
}
// end of function fn_19

// @@@ (eval-cond env expr) @@@ bld-rtl-dir/wile-rtl2-000077.scm:282 @@@ fn_20 @@@
static lval fn_20(lptr* var_778, lptr var_779)
{
lbl_780:;
lval var_781;
do {
lval var_782;
var_782 = LVI_BOOL(var_779[1].vt == LV_NIL);
if (!LV_IS_FALSE(var_782)) {
lval var_783;
var_783 = LVI_BOOL(false);
var_781 = var_783;
break;
}
lval var_784;
if (var_779[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_784 = (var_779[1].v.pair.car ? *(var_779[1].v.pair.car) : LVI_NIL());
lval var_785;
var_785 = LVI_BOOL(var_784.vt == LV_PAIR);
if (!LV_IS_FALSE(var_785)) {
lval var_786;
lval var_787;
var_787 = LVI_STRING("caar");
lval var_788;
{
char* cp = strchr(var_787.v.str, 'r');
var_788 = var_779[1];
while (*(--cp) != 'c') {
if (var_788.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_788 = (var_788.v.pair.car ? *(var_788.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_788 = (var_788.v.pair.cdr ? *(var_788.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_787.v.str);
}
}
}
lval var_789;
lval var_790[8];
var_790[0] = var_779[0];
var_790[1] = var_788;
var_789 = wile_eval(NULL, var_790);
if (LV_IS_FALSE(var_789)) {
lval var_792;
if (var_779[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_792 = (var_779[1].v.pair.cdr ? *(var_779[1].v.pair.cdr) : LVI_NIL());
lval var_795[8];
var_795[0] = var_779[0];
var_795[1] = var_792;
var_779[0] = var_795[0];
var_779[1] = var_795[1];
goto lbl_780;	// selfie
} else {
lval var_796;
var_796 = LVI_BOOL(false);
lval var_797;
var_797 = LVI_STRING("cdar");
lval var_798;
{
char* cp = strchr(var_797.v.str, 'r');
var_798 = var_779[1];
while (*(--cp) != 'c') {
if (var_798.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_798 = (var_798.v.pair.car ? *(var_798.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_798 = (var_798.v.pair.cdr ? *(var_798.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_797.v.str);
}
}
}
lval var_801[8];
var_801[0] = var_796;
var_801[1] = var_779[0];
var_801[2] = var_798;
var_779[0] = var_801[0];
var_779[1] = var_801[1];
var_779[2] = var_801[2];
TAIL_CALL wile_eval_begin(NULL, var_779);
}
var_781 = var_786;
break;
}
lval var_802;
var_802 = LVI_STRING("malformed \'cond\' expression \'%v\'");
lval var_805[8];
var_805[0] = var_802;
lval var_806[8];
var_806[0] = var_779[1];
var_779[1] = wile_gen_list(1, var_806, NULL);
var_779[0] = var_805[0];
TAIL_CALL fn_7(NULL, var_779);
} while (0);
return var_781;
}
// end of function fn_20

// @@@ (eval-set! env expr) @@@ bld-rtl-dir/wile-rtl2-000077.scm:290 @@@ fn_21 @@@
static lval fn_21(lptr* var_807, lptr var_808)
{
lval var_810;
lval var_811;
var_811 = LVI_BOOL(true);
do {
lval var_812;
var_812 = LVI_BOOL(var_808[1].vt == LV_PAIR);
var_811 = var_812;
if (LV_IS_FALSE(var_811)) { break; }
lval var_813;
if (var_808[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_813 = (var_808[1].v.pair.car ? *(var_808[1].v.pair.car) : LVI_NIL());
lval var_814;
var_814 = LVI_BOOL(var_813.vt == LV_SYMBOL);
var_811 = var_814;
if (LV_IS_FALSE(var_811)) { break; }
lval var_815;
var_815 = LVI_INT(2);
lval var_816;
{
lval var_817[8];
var_817[0] = var_815;
var_817[1] = var_808[1];
var_816 = wile_list_length_eq(NULL, var_817);
}
var_811 = var_816;
if (LV_IS_FALSE(var_811)) { break; }
} while (0);
if (LV_IS_FALSE(var_811)) {
lval var_818;
var_818 = LVI_STRING("malformed \'set!\' expression \'%v\'");
lval var_821[8];
var_821[0] = var_818;
lval var_822[8];
var_822[0] = var_808[1];
var_808[1] = wile_gen_list(1, var_822, NULL);
var_808[0] = var_821[0];
TAIL_CALL fn_7(NULL, var_808);
} else {
lval var_823;
lval var_824;
var_824 = LVI_BOOL(true);
lval var_825;
if (var_808[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_825 = (var_808[1].v.pair.car ? *(var_808[1].v.pair.car) : LVI_NIL());
lval var_826;
lval var_827[8];
var_827[0] = var_824;
var_827[1] = var_808[0];
var_827[2] = var_825;
var_826 = fn_11(NULL, var_827);
var_823 = var_826;
lval var_829;
var_829 = LVI_STRING("cadr");
lval var_830;
{
char* cp = strchr(var_829.v.str, 'r');
var_830 = var_808[1];
while (*(--cp) != 'c') {
if (var_830.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_830 = (var_830.v.pair.car ? *(var_830.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_830 = (var_830.v.pair.cdr ? *(var_830.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_829.v.str);
}
}
}
lval var_831;
lval var_832[8];
var_832[0] = var_808[0];
var_832[1] = var_830;
var_831 = wile_eval(NULL, var_832);
lval var_835[8];
var_835[0] = var_823;
var_835[1] = var_831;
(void)
 fn_6(NULL, var_835);
lval var_839[8];
var_839[0] = var_823;
var_808[0] = var_839[0];
TAIL_CALL fn_4(NULL, var_808);
}
return var_810;
}
// end of function fn_21

// @@@ lambda (cs) @@@ bld-rtl-dir/wile-rtl2-000077.scm:305 @@@ fn_865 @@@
static lval fn_865(lptr* var_866, lptr var_867)
{
lbl_868:;
lval var_869;
do {
lval var_870;
var_870 = LVI_BOOL(var_867[0].vt == LV_NIL);
if (!LV_IS_FALSE(var_870)) {
lval var_871;
var_871 = LVI_BOOL(true);
V_CLOS(var_866,0) = var_871;
V_CLOS(var_866,1) = V_CLOS(var_866,2);
var_869 = V_CLOS(var_866,1);
break;
}
lval var_872;
var_872 = LVI_STRING("caar");
lval var_873;
{
char* cp = strchr(var_872.v.str, 'r');
var_873 = var_867[0];
while (*(--cp) != 'c') {
if (var_873.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_873 = (var_873.v.pair.car ? *(var_873.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_873 = (var_873.v.pair.cdr ? *(var_873.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_872.v.str);
}
}
}
lval var_874;
lval var_875[8];
var_875[0] = V_CLOS(var_866,3);
var_875[1] = var_873;
var_874 = wile_eval(NULL, var_875);
if (!LV_IS_FALSE(var_874)) {
lval var_877;
var_877 = LVI_BOOL(false);
lval var_878;
var_878 = LVI_STRING("cdar");
lval var_879;
{
char* cp = strchr(var_878.v.str, 'r');
var_879 = var_867[0];
while (*(--cp) != 'c') {
if (var_879.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_879 = (var_879.v.pair.car ? *(var_879.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_879 = (var_879.v.pair.cdr ? *(var_879.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_878.v.str);
}
}
}
lval var_882[8];
var_882[0] = var_877;
var_882[1] = V_CLOS(var_866,3);
var_882[2] = var_879;
var_867[0] = var_882[0];
var_867[1] = var_882[1];
var_867[2] = var_882[2];
TAIL_CALL wile_eval_begin(NULL, var_867);
}
lval var_883;
if (var_867[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_883 = (var_867[0].v.pair.cdr ? *(var_867[0].v.pair.cdr) : LVI_NIL());
lval var_886[8];
var_886[0] = var_883;
var_867[0] = var_886[0];
goto lbl_868;	// selfie
} while (0);
return var_869;
}
// end of lambda fn_865

// @@@ (eval-guard env expr) @@@ bld-rtl-dir/wile-rtl2-000077.scm:299 @@@ fn_22 @@@
static lval fn_22(lptr* var_840, lptr var_841)
{
lval var_843;
lval var_844;
var_844 = LVI_BOOL(false);
var_843 = var_844;
lval var_845;
lval var_846;
var_846 = LVI_BOOL(false);
var_845 = var_846;
lval var_847;
lval var_848;
{
struct lisp_escape_info var_850;
var_850.errval = NULL;
var_850.next = cachalot;
cachalot = &var_850;
if (setjmp(var_850.cenv) == 0) {
lval var_851;
var_851 = LVI_BOOL(false);
lval var_852;
if (var_841[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_852 = (var_841[1].v.pair.cdr ? *(var_841[1].v.pair.cdr) : LVI_NIL());
lval var_853;
lval var_854[8];
var_854[0] = var_851;
var_854[1] = var_841[0];
var_854[2] = var_852;
var_853 = wile_eval_begin(NULL, var_854);
var_848 = var_853;
cachalot = var_850.next;
} else {
lval var_849;
var_849 = (var_850.errval ? *(var_850.errval) : LVI_NIL());
lval var_856;
do {
lval var_857;
var_857 = LVI_BOOL(true);
if (!LV_IS_FALSE(var_857)) {
lval var_858;
lval var_859;
var_859 = LVI_STRING("caar");
lval var_860;
{
char* cp = strchr(var_859.v.str, 'r');
var_860 = var_841[1];
while (*(--cp) != 'c') {
if (var_860.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_860 = (var_860.v.pair.car ? *(var_860.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_860 = (var_860.v.pair.cdr ? *(var_860.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_859.v.str);
}
}
}
lval var_861;
lval var_862[8];
var_862[0] = var_860;
var_862[1] = var_849;
var_861 = fn_1(NULL, var_862);
lval var_864;
{
lptr p1 = NULL, p2 = NULL;
if (var_861.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_861;
}
if (var_841[0].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_841[0];
}
var_864 = LVI_PAIR(p1, p2);
}
var_858 = var_864;
MK_CLOS(var_866,4);
P_CLOS(var_866,3) = &(var_858);
P_CLOS(var_866,2) = &(var_849);
P_CLOS(var_866,1) = &(var_845);
P_CLOS(var_866,0) = &(var_843);
lval var_887;
var_887 = LVI_STRING("cdar");
lval var_888;
{
char* cp = strchr(var_887.v.str, 'r');
var_888 = var_841[1];
while (*(--cp) != 'c') {
if (var_888.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_888 = (var_888.v.pair.car ? *(var_888.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_888 = (var_888.v.pair.cdr ? *(var_888.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_887.v.str);
}
}
}
lval var_889;
lval var_890[8];
var_890[0] = var_888;
var_889 = fn_865(var_866, var_890);
var_856 = var_889;
break;
}
cachalot = var_850.next;
cachalot->errval = var_850.errval;
cachalot->l_whence = 0;
cachalot->c_whence = LISP_WHENCE;
fflush(NULL);
longjmp(cachalot->cenv, 1);
} while (0);
cachalot = var_850.next;
var_848 = var_856;
}
}
var_847 = var_848;
lval var_892;
if (LV_IS_FALSE(var_843)) {
var_892 = var_847;
} else {
lval var_893;
{
lval var_894[1];
var_894[0] = var_845;
var_893 = wile_gen_list(1, var_894, NULL);
}
if (var_893.vt == LV_PAIR && (var_893.v.pair.cdr == NULL || var_893.v.pair.cdr->vt == LV_NIL)) {
var_893 = (var_893.v.pair.car ? *(var_893.v.pair.car) : LVI_NIL());
}
cachalot->errval = new_lv(LV_NIL);
*(cachalot->errval) = var_893;
cachalot->l_whence = 0;
cachalot->c_whence = LISP_WHENCE;
longjmp(cachalot->cenv, 1);
var_892 = var_893;
}
return var_892;
}
// end of function fn_22

// @@@ lambda (cs) @@@ bld-rtl-dir/wile-rtl2-000077.scm:322 @@@ fn_914 @@@
static lval fn_914(lptr* var_915, lptr var_916)
{
lbl_917:;
lval var_918;
lval var_919;
var_919 = LVI_BOOL(var_916[0].vt == LV_NIL);
if (LV_IS_FALSE(var_919)) {
lval var_920;
lval var_921;
var_921 = LVI_BOOL(true);
do {
lval var_922;
if (var_916[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_922 = (var_916[0].v.pair.car ? *(var_916[0].v.pair.car) : LVI_NIL());
lval var_923;
{
var_923 = var_922;
while (var_923.vt == LV_PAIR) {
var_923 = (var_923.v.pair.cdr ? *(var_923.v.pair.cdr) : LVI_NIL());
}
var_923 = LVI_BOOL(var_923.vt == LV_NIL);
}
var_921 = var_923;
if (LV_IS_FALSE(var_921)) { break; }
lval var_924;
var_924 = LVI_BOOL(false);
do {
lval var_925;
var_925 = LVI_BOOL(true);
do {
lval var_926;
var_926 = LVI_STRING("caar");
lval var_927;
{
char* cp = strchr(var_926.v.str, 'r');
var_927 = var_916[0];
while (*(--cp) != 'c') {
if (var_927.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_927 = (var_927.v.pair.car ? *(var_927.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_927 = (var_927.v.pair.cdr ? *(var_927.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_926.v.str);
}
}
}
lval var_928;
{
var_928 = var_927;
while (var_928.vt == LV_PAIR) {
var_928 = (var_928.v.pair.cdr ? *(var_928.v.pair.cdr) : LVI_NIL());
}
var_928 = LVI_BOOL(var_928.vt == LV_NIL);
}
var_925 = var_928;
if (LV_IS_FALSE(var_925)) { break; }
lval var_929;
var_929 = LVI_STRING("caar");
lval var_930;
{
char* cp = strchr(var_929.v.str, 'r');
var_930 = var_916[0];
while (*(--cp) != 'c') {
if (var_930.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_930 = (var_930.v.pair.car ? *(var_930.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_930 = (var_930.v.pair.cdr ? *(var_930.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_929.v.str);
}
}
}
lval var_931;
var_931 = LVI_BOOL(var_930.vt == LV_NIL);
lval var_932;
var_932 = LVI_BOOL(LV_IS_FALSE(var_931));
var_925 = var_932;
if (LV_IS_FALSE(var_925)) { break; }
} while (0);
var_924 = var_925;
if (!LV_IS_FALSE(var_924)) { break; }
lval var_933;
var_933 = LVI_STRING("caar");
lval var_934;
{
char* cp = strchr(var_933.v.str, 'r');
var_934 = var_916[0];
while (*(--cp) != 'c') {
if (var_934.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_934 = (var_934.v.pair.car ? *(var_934.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_934 = (var_934.v.pair.cdr ? *(var_934.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_933.v.str);
}
}
}
lval var_935;
var_935 = LVI_SYMBOL("else");
lval var_936;
var_936 = LVI_BOOL(wile_do_eqv(&(var_934), &(var_935)));
var_924 = var_936;
if (!LV_IS_FALSE(var_924)) { break; }
} while (0);
var_921 = var_924;
if (LV_IS_FALSE(var_921)) { break; }
lval var_937;
var_937 = LVI_STRING("cdar");
lval var_938;
{
char* cp = strchr(var_937.v.str, 'r');
var_938 = var_916[0];
while (*(--cp) != 'c') {
if (var_938.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_938 = (var_938.v.pair.car ? *(var_938.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_938 = (var_938.v.pair.cdr ? *(var_938.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_937.v.str);
}
}
}
lval var_939;
var_939 = LVI_BOOL(var_938.vt == LV_NIL);
lval var_940;
var_940 = LVI_BOOL(LV_IS_FALSE(var_939));
var_921 = var_940;
if (LV_IS_FALSE(var_921)) { break; }
} while (0);
if (LV_IS_FALSE(var_921)) {
lval var_941;
var_941 = LVI_STRING("malformed \'case\' clause \'%v\'");
lval var_942;
if (var_916[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_942 = (var_916[0].v.pair.car ? *(var_916[0].v.pair.car) : LVI_NIL());
lval var_945[8];
var_945[0] = var_941;
lval var_946[8];
var_946[0] = var_942;
var_916[1] = wile_gen_list(1, var_946, NULL);
var_916[0] = var_945[0];
TAIL_CALL fn_7(NULL, var_916);
} else {
lval var_947;
lval var_948;
var_948 = LVI_BOOL(false);
do {
lval var_949;
var_949 = LVI_STRING("caar");
lval var_950;
{
char* cp = strchr(var_949.v.str, 'r');
var_950 = var_916[0];
while (*(--cp) != 'c') {
if (var_950.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_950 = (var_950.v.pair.car ? *(var_950.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_950 = (var_950.v.pair.cdr ? *(var_950.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_949.v.str);
}
}
}
lval var_951;
var_951 = LVI_SYMBOL("else");
lval var_952;
var_952 = LVI_BOOL(wile_do_eqv(&(var_950), &(var_951)));
var_948 = var_952;
if (!LV_IS_FALSE(var_948)) { break; }
lval var_953;
var_953 = LVI_STRING("caar");
lval var_954;
{
char* cp = strchr(var_953.v.str, 'r');
var_954 = var_916[0];
while (*(--cp) != 'c') {
if (var_954.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_954 = (var_954.v.pair.car ? *(var_954.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_954 = (var_954.v.pair.cdr ? *(var_954.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_953.v.str);
}
}
}
lval var_955;
{
lval var_956[8];
var_956[0] = V_CLOS(var_915,0);
var_956[1] = var_954;
var_955 = wile_memv(NULL, var_956);
}
var_948 = var_955;
if (!LV_IS_FALSE(var_948)) { break; }
} while (0);
if (LV_IS_FALSE(var_948)) {
lval var_957;
if (var_916[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_957 = (var_916[0].v.pair.cdr ? *(var_916[0].v.pair.cdr) : LVI_NIL());
lval var_960[8];
var_960[0] = var_957;
var_916[0] = var_960[0];
goto lbl_917;	// selfie
} else {
lval var_961;
var_961 = LVI_BOOL(false);
lval var_962;
var_962 = LVI_STRING("cdar");
lval var_963;
{
char* cp = strchr(var_962.v.str, 'r');
var_963 = var_916[0];
while (*(--cp) != 'c') {
if (var_963.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_963 = (var_963.v.pair.car ? *(var_963.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_963 = (var_963.v.pair.cdr ? *(var_963.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_962.v.str);
}
}
}
lval var_966[8];
var_966[0] = var_961;
var_966[1] = V_CLOS(var_915,1);
var_966[2] = var_963;
var_916[0] = var_966[0];
var_916[1] = var_966[1];
var_916[2] = var_966[2];
TAIL_CALL wile_eval_begin(NULL, var_916);
}
var_920 = var_947;
}
var_918 = var_920;
} else {
lval var_967;
var_967 = LVI_BOOL(false);
var_918 = var_967;
}
return var_918;
}
// end of lambda fn_914

// @@@ (eval-case env expr) @@@ bld-rtl-dir/wile-rtl2-000077.scm:319 @@@ fn_23 @@@
static lval fn_23(lptr* var_895, lptr var_896)
{
lval var_898;
lval var_899;
var_899 = LVI_BOOL(true);
do {
lval var_900;
{
var_900 = var_896[1];
while (var_900.vt == LV_PAIR) {
var_900 = (var_900.v.pair.cdr ? *(var_900.v.pair.cdr) : LVI_NIL());
}
var_900 = LVI_BOOL(var_900.vt == LV_NIL);
}
var_899 = var_900;
if (LV_IS_FALSE(var_899)) { break; }
lval var_901;
var_901 = LVI_INT(2);
lval var_902;
{
lval var_903[8];
var_903[0] = var_901;
var_903[1] = var_896[1];
var_902 = wile_list_length_ge(NULL, var_903);
}
var_899 = var_902;
if (LV_IS_FALSE(var_899)) { break; }
} while (0);
if (LV_IS_FALSE(var_899)) {
lval var_904;
var_904 = LVI_STRING("malformed \'case\' expression \'%v\'");
lval var_907[8];
var_907[0] = var_904;
lval var_908[8];
var_908[0] = var_896[1];
var_896[1] = wile_gen_list(1, var_908, NULL);
var_896[0] = var_907[0];
TAIL_CALL fn_7(NULL, var_896);
} else {
lval var_909;
lval var_910;
if (var_896[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_910 = (var_896[1].v.pair.car ? *(var_896[1].v.pair.car) : LVI_NIL());
lval var_911;
lval var_912[8];
var_912[0] = var_896[0];
var_912[1] = var_910;
var_911 = wile_eval(NULL, var_912);
var_909 = var_911;
MK_CLOS(var_915,2);
P_CLOS(var_915,1) = &(var_896[0]);
P_CLOS(var_915,0) = &(var_909);
lval var_968;
if (var_896[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_968 = (var_896[1].v.pair.cdr ? *(var_896[1].v.pair.cdr) : LVI_NIL());
lval var_969;
lval var_970[8];
var_970[0] = var_968;
var_969 = fn_914(var_915, var_970);
var_898 = var_969;
}
return var_898;
}
// end of function fn_23

// @@@ lambda (as pl na) @@@ bld-rtl-dir/wile-rtl2-000077.scm:348 @@@ fn_975 @@@
static lval fn_975(lptr* var_976, lptr var_977)
{
lbl_978:;
lval var_979;
do {
lval var_980;
var_980 = LVI_BOOL(var_977[0].vt == LV_NIL);
if (!LV_IS_FALSE(var_980)) {
lval var_981;
{
lval var_982[8];
var_982[0] = var_977[1];
var_981 = wile_list_reverse(NULL, var_982);
}
lval var_983;
{
lval var_984[2];
var_984[0] = var_977[2];
var_984[1] = var_981;
var_983 = wile_gen_list(2, var_984, NULL);
}
var_979 = var_983;
break;
}
lval var_985;
var_985 = LVI_BOOL(var_977[0].vt == LV_PAIR);
if (!LV_IS_FALSE(var_985)) {
lval var_986;
if (var_977[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_986 = (var_977[0].v.pair.cdr ? *(var_977[0].v.pair.cdr) : LVI_NIL());
lval var_987;
if (var_977[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_987 = (var_977[0].v.pair.car ? *(var_977[0].v.pair.car) : LVI_NIL());
lval var_988;
{
lptr p1 = NULL, p2 = NULL;
if (var_987.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_987;
}
if (var_977[1].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_977[1];
}
var_988 = LVI_PAIR(p1, p2);
}
lval var_989;
var_989 = LVI_INT(1);
lval var_990;
{
lval var_992[2];
var_992[0] = var_977[2];
var_992[1] = var_989;
var_990 = wile_gen_list(2, var_992, NULL);
}
{
lval var_991[8];
var_991[0] = var_990;
var_990 = wile_add(NULL, var_991);
}
lval var_995[8];
var_995[0] = var_986;
var_995[1] = var_988;
var_995[2] = var_990;
var_977[0] = var_995[0];
var_977[1] = var_995[1];
var_977[2] = var_995[2];
goto lbl_978;	// selfie
}
lval var_996;
{
lval var_998[1];
var_998[0] = var_977[2];
var_996 = wile_gen_list(1, var_998, NULL);
}
{
lval var_997[8];
var_997[0] = var_996;
var_996 = wile_subtract(NULL, var_997);
}
lval var_999;
var_999 = LVI_INT(1);
lval var_1000;
{
lval var_1002[2];
var_1002[0] = var_996;
var_1002[1] = var_999;
var_1000 = wile_gen_list(2, var_1002, NULL);
}
{
lval var_1001[8];
var_1001[0] = var_1000;
var_1000 = wile_subtract(NULL, var_1001);
}
lval var_1003;
{
lptr p1 = NULL, p2 = NULL;
if (var_977[0].vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_977[0];
}
if (var_977[1].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_977[1];
}
var_1003 = LVI_PAIR(p1, p2);
}
lval var_1004;
{
lval var_1005[8];
var_1005[0] = var_1003;
var_1004 = wile_list_reverse(NULL, var_1005);
}
lval var_1006;
{
lval var_1007[2];
var_1007[0] = var_1000;
var_1007[1] = var_1004;
var_1006 = wile_gen_list(2, var_1007, NULL);
}
var_979 = var_1006;
} while (0);
return var_979;
}
// end of lambda fn_975

// @@@ (args-list dotted-list) @@@ bld-rtl-dir/wile-rtl2-000077.scm:347 @@@ fn_24 @@@
static lval fn_24(lptr* var_972, lptr var_973)
{
MK_CLOS(var_976,0);
lval var_1008;
var_1008 = LVI_NIL();
lval var_1009;
var_1009 = LVI_INT(0);
lval var_1010;
lval var_1011[8];
var_1011[0] = var_973[0];
var_1011[1] = var_1008;
var_1011[2] = var_1009;
var_1010 = fn_975(var_976, var_1011);
return var_1010;
}
// end of function fn_24

// @@@ (eval-lambda env expr) @@@ bld-rtl-dir/wile-rtl2-000077.scm:355 @@@ fn_25 @@@
static lval fn_25(lptr* var_1013, lptr var_1014)
{
lval var_1016;
lval var_1017;
if (var_1014[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1017 = (var_1014[1].v.pair.car ? *(var_1014[1].v.pair.car) : LVI_NIL());
var_1016 = var_1017;
lval var_1018;
lval var_1019;
lval var_1020[8];
var_1020[0] = var_1016;
var_1019 = fn_24(NULL, var_1020);
var_1018 = var_1019;
lval var_1022;
lval var_1023;
if (var_1018.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1023 = (var_1018.v.pair.car ? *(var_1018.v.pair.car) : LVI_NIL());
var_1022 = var_1023;
lval var_1024;
lval var_1025;
var_1025 = LVI_STRING("cadr");
lval var_1026;
{
char* cp = strchr(var_1025.v.str, 'r');
var_1026 = var_1018;
while (*(--cp) != 'c') {
if (var_1026.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_1026 = (var_1026.v.pair.car ? *(var_1026.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_1026 = (var_1026.v.pair.cdr ? *(var_1026.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_1025.v.str);
}
}
}
var_1024 = var_1026;
lval var_1028;
lval var_1029[8];
var_1029[0] = var_1024;
var_1028 = fn_10(NULL, var_1029);
if (LV_IS_FALSE(var_1028)) {
lval var_1031;
var_1031 = LVI_STRING("malformed \'lambda\' args list \'%v\'");
lval var_1033[8];
var_1033[0] = var_1031;
lval var_1035[8];
var_1035[0] = var_1016;
var_1033[1] = wile_gen_list(1, var_1035, NULL);
(void)
 fn_7(NULL, var_1033);
} else {
(void)
 LVI_BOOL(false);
}
lval var_1037;
if (var_1014[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1037 = (var_1014[1].v.pair.cdr ? *(var_1014[1].v.pair.cdr) : LVI_NIL());
lval var_1038;
var_1038 = LVI_BOOL(false);
lval var_1039;
if ((var_1024.vt == LV_PAIR || var_1024.vt == LV_NIL) && var_1022.vt == LV_INT &&(var_1037.vt == LV_PAIR || var_1037.vt == LV_NIL) &&(var_1014[0].vt == LV_PAIR || var_1014[0].vt == LV_NIL) && var_1038.vt == LV_BOOL) {
var_1039.vt = LV_ILAMBDA;
var_1039.v.ilambda = LISP_ALLOC(lisp_ifunc_t, 1);
if (var_1039.v.ilambda == NULL) {
WILE_EX("make-interpreted-procedure", "memory allocation failed!");
}
var_1039.v.ilambda->args = var_1024;
var_1039.v.ilambda->arity = var_1022.v.iv;
var_1039.v.ilambda->body = var_1037;
var_1039.v.ilambda->env = var_1014[0];
var_1039.v.ilambda->macro = var_1038.v.bv;
} else {
WILE_EX("make-interpreted-procedure", "expects a list of arguments, an integer arity, a list of body expressions, an environment list, and a macro boolean");
}
return var_1039;
}
// end of function fn_25

// @@@ (check-syntax-do expr) @@@ bld-rtl-dir/wile-rtl2-000077.scm:364 @@@ fn_26 @@@
static lval fn_26(lptr* var_1040, lptr var_1041)
{
lval var_1043;
var_1043 = LVI_BOOL(true);
do {
lval var_1044;
{
var_1044 = var_1041[0];
while (var_1044.vt == LV_PAIR) {
var_1044 = (var_1044.v.pair.cdr ? *(var_1044.v.pair.cdr) : LVI_NIL());
}
var_1044 = LVI_BOOL(var_1044.vt == LV_NIL);
}
var_1043 = var_1044;
if (LV_IS_FALSE(var_1043)) { break; }
lval var_1045;
var_1045 = LVI_INT(2);
lval var_1046;
{
lval var_1047[8];
var_1047[0] = var_1045;
var_1047[1] = var_1041[0];
var_1046 = wile_list_length_ge(NULL, var_1047);
}
var_1043 = var_1046;
if (LV_IS_FALSE(var_1043)) { break; }
lval var_1048;
if (var_1041[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1048 = (var_1041[0].v.pair.car ? *(var_1041[0].v.pair.car) : LVI_NIL());
lval var_1049;
{
var_1049 = var_1048;
while (var_1049.vt == LV_PAIR) {
var_1049 = (var_1049.v.pair.cdr ? *(var_1049.v.pair.cdr) : LVI_NIL());
}
var_1049 = LVI_BOOL(var_1049.vt == LV_NIL);
}
var_1043 = var_1049;
if (LV_IS_FALSE(var_1043)) { break; }
lval var_1050;
var_1050 = LVI_STRING("cadr");
lval var_1051;
{
char* cp = strchr(var_1050.v.str, 'r');
var_1051 = var_1041[0];
while (*(--cp) != 'c') {
if (var_1051.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_1051 = (var_1051.v.pair.car ? *(var_1051.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_1051 = (var_1051.v.pair.cdr ? *(var_1051.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_1050.v.str);
}
}
}
lval var_1052;
{
var_1052 = var_1051;
while (var_1052.vt == LV_PAIR) {
var_1052 = (var_1052.v.pair.cdr ? *(var_1052.v.pair.cdr) : LVI_NIL());
}
var_1052 = LVI_BOOL(var_1052.vt == LV_NIL);
}
var_1043 = var_1052;
if (LV_IS_FALSE(var_1043)) { break; }
lval var_1053;
var_1053 = LVI_INT(0);
lval var_1054;
var_1054 = LVI_STRING("cadr");
lval var_1055;
{
char* cp = strchr(var_1054.v.str, 'r');
var_1055 = var_1041[0];
while (*(--cp) != 'c') {
if (var_1055.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_1055 = (var_1055.v.pair.car ? *(var_1055.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_1055 = (var_1055.v.pair.cdr ? *(var_1055.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_1054.v.str);
}
}
}
lval var_1056;
{
lval var_1057[8];
var_1057[0] = var_1053;
var_1057[1] = var_1055;
var_1056 = wile_list_length_gt(NULL, var_1057);
}
var_1043 = var_1056;
if (LV_IS_FALSE(var_1043)) { break; }
} while (0);
return var_1043;
}
// end of function fn_26

// @@@ lambda (vdef) @@@ bld-rtl-dir/wile-rtl2-000077.scm:376 @@@ fn_1078 @@@
static lval fn_1078(lptr* var_1079, lptr var_1080)
{
lval var_1082;
lval var_1083;
var_1083 = LVI_BOOL(true);
do {
lval var_1084;
{
var_1084 = var_1080[0];
while (var_1084.vt == LV_PAIR) {
var_1084 = (var_1084.v.pair.cdr ? *(var_1084.v.pair.cdr) : LVI_NIL());
}
var_1084 = LVI_BOOL(var_1084.vt == LV_NIL);
}
var_1083 = var_1084;
if (LV_IS_FALSE(var_1083)) { break; }
lval var_1085;
var_1085 = LVI_INT(2);
lval var_1086;
{
lval var_1087[8];
var_1087[0] = var_1085;
var_1087[1] = var_1080[0];
var_1086 = wile_list_length_ge(NULL, var_1087);
}
var_1083 = var_1086;
if (LV_IS_FALSE(var_1083)) { break; }
lval var_1088;
if (var_1080[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1088 = (var_1080[0].v.pair.car ? *(var_1080[0].v.pair.car) : LVI_NIL());
lval var_1089;
var_1089 = LVI_BOOL(var_1088.vt == LV_SYMBOL);
var_1083 = var_1089;
if (LV_IS_FALSE(var_1083)) { break; }
} while (0);
if (LV_IS_FALSE(var_1083)) {
lval var_1090;
var_1090 = LVI_STRING("malformed \'do\' variable-expr \'%v\'");
lval var_1093[8];
var_1093[0] = var_1090;
lval var_1094[8];
var_1094[0] = var_1080[0];
var_1080[1] = wile_gen_list(1, var_1094, NULL);
var_1080[0] = var_1093[0];
TAIL_CALL fn_7(NULL, var_1080);
} else {
lval var_1095;
var_1095 = LVI_BOOL(false);
var_1082 = var_1095;
}
return var_1082;
}
// end of lambda fn_1078

// @@@ lambda (e) @@@ bld-rtl-dir/wile-rtl2-000077.scm:394 @@@ fn_1123 @@@
static lval fn_1123(lptr* var_1124, lptr var_1125)
{
lval var_1129[8];
var_1129[0] = V_CLOS(var_1124,0);
var_1129[1] = var_1125[0];
var_1125[0] = var_1129[0];
var_1125[1] = var_1129[1];
TAIL_CALL wile_eval(NULL, var_1125);
}
// end of lambda fn_1123

// @@@ lambda (vdef) @@@ bld-rtl-dir/wile-rtl2-000077.scm:395 @@@ fn_1132 @@@
static lval fn_1132(lptr* var_1133, lptr var_1134)
{
lval var_1136;
lval var_1137;
lval var_1138;
var_1138 = LVI_STRING("cddr");
lval var_1139;
{
char* cp = strchr(var_1138.v.str, 'r');
var_1139 = var_1134[0];
while (*(--cp) != 'c') {
if (var_1139.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_1139 = (var_1139.v.pair.car ? *(var_1139.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_1139 = (var_1139.v.pair.cdr ? *(var_1139.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_1138.v.str);
}
}
}
lval var_1140;
var_1140 = LVI_BOOL(var_1139.vt == LV_NIL);
if (LV_IS_FALSE(var_1140)) {
lval var_1141;
var_1141 = LVI_STRING("caddr");
lval var_1142;
{
char* cp = strchr(var_1141.v.str, 'r');
var_1142 = var_1134[0];
while (*(--cp) != 'c') {
if (var_1142.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_1142 = (var_1142.v.pair.car ? *(var_1142.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_1142 = (var_1142.v.pair.cdr ? *(var_1142.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_1141.v.str);
}
}
}
var_1137 = var_1142;
} else {
lval var_1143;
if (var_1134[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1143 = (var_1134[0].v.pair.car ? *(var_1134[0].v.pair.car) : LVI_NIL());
var_1137 = var_1143;
}
var_1136 = var_1137;
lval var_1144;
if (var_1134[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1144 = (var_1134[0].v.pair.car ? *(var_1134[0].v.pair.car) : LVI_NIL());
lval var_1145;
lval var_1146[8];
var_1146[0] = V_CLOS(var_1133,0);
var_1146[1] = var_1136;
var_1145 = wile_eval(NULL, var_1146);
lval var_1150[8];
var_1150[0] = var_1144;
var_1150[1] = var_1145;
var_1134[0] = var_1150[0];
var_1134[1] = var_1150[1];
TAIL_CALL fn_1(NULL, var_1134);
}
// end of lambda fn_1132

// @@@ lambda (new-bindings) @@@ bld-rtl-dir/wile-rtl2-000077.scm:386 @@@ fn_1110 @@@
static lval fn_1110(lptr* var_1111, lptr var_1112)
{
lbl_1113:;
lval var_1114;
lval var_1115;
{
lval var_1117[2];
var_1117[0] = var_1112[0];
var_1117[1] = V_CLOS(var_1111,0);
var_1115 = wile_gen_list(2, var_1117, NULL);
}
{
lval var_1116[8];
var_1116[0] = var_1115;
var_1115 = wile_list_append(NULL, var_1116);
}
var_1114 = var_1115;
lval var_1118;
lval var_1119;
if (V_CLOS(var_1111,1).vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1119 = (V_CLOS(var_1111,1).v.pair.car ? *(V_CLOS(var_1111,1).v.pair.car) : LVI_NIL());
lval var_1120;
lval var_1121[8];
var_1121[0] = var_1114;
var_1121[1] = var_1119;
var_1120 = wile_eval(NULL, var_1121);
if (LV_IS_FALSE(var_1120)) {
MK_CLOS(var_1124,1);
P_CLOS(var_1124,0) = &(var_1114);
lval var_1130;
var_1130 = LVI_NIL();
{
lval var_1131[8];
var_1131[0] = LVI_PROC(fn_1123,var_1124,1);
var_1131[1] = V_CLOS(var_1111,2);
var_1131[2] = var_1130;
var_1130 = wile_for_each(NULL, var_1131);
}
MK_CLOS(var_1133,1);
P_CLOS(var_1133,0) = &(var_1114);
lval var_1151;
var_1151 = LVI_NIL();
{
lval var_1152[8];
var_1152[0] = LVI_PROC(fn_1132,var_1133,1);
var_1152[1] = V_CLOS(var_1111,3);
var_1152[2] = var_1151;
var_1151 = wile_map(NULL, var_1152);
}
lval var_1155[8];
var_1155[0] = var_1151;
var_1112[0] = var_1155[0];
goto lbl_1113;	// selfie
} else {
lval var_1156;
var_1156 = LVI_BOOL(false);
lval var_1157;
if (V_CLOS(var_1111,1).vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1157 = (V_CLOS(var_1111,1).v.pair.cdr ? *(V_CLOS(var_1111,1).v.pair.cdr) : LVI_NIL());
lval var_1160[8];
var_1160[0] = var_1156;
var_1160[1] = var_1114;
var_1160[2] = var_1157;
var_1112[0] = var_1160[0];
var_1112[1] = var_1160[1];
var_1112[2] = var_1160[2];
TAIL_CALL wile_eval_begin(NULL, var_1112);
}
return var_1118;
}
// end of lambda fn_1110

// @@@ lambda (vdef) @@@ bld-rtl-dir/wile-rtl2-000077.scm:387 @@@ fn_1161 @@@
static lval fn_1161(lptr* var_1162, lptr var_1163)
{
lval var_1165;
if (var_1163[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1165 = (var_1163[0].v.pair.car ? *(var_1163[0].v.pair.car) : LVI_NIL());
lval var_1166;
var_1166 = LVI_STRING("cadr");
lval var_1167;
{
char* cp = strchr(var_1166.v.str, 'r');
var_1167 = var_1163[0];
while (*(--cp) != 'c') {
if (var_1167.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_1167 = (var_1167.v.pair.car ? *(var_1167.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_1167 = (var_1167.v.pair.cdr ? *(var_1167.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_1166.v.str);
}
}
}
lval var_1168;
lval var_1169[8];
var_1169[0] = V_CLOS(var_1162,0);
var_1169[1] = var_1167;
var_1168 = wile_eval(NULL, var_1169);
lval var_1173[8];
var_1173[0] = var_1165;
var_1173[1] = var_1168;
var_1163[0] = var_1173[0];
var_1163[1] = var_1173[1];
TAIL_CALL fn_1(NULL, var_1163);
}
// end of lambda fn_1161

// @@@ (eval-do env expr) @@@ bld-rtl-dir/wile-rtl2-000077.scm:371 @@@ fn_27 @@@
static lval fn_27(lptr* var_1058, lptr var_1059)
{
lval var_1061;
lval var_1062;
lval var_1063[8];
var_1063[0] = var_1059[1];
var_1062 = fn_26(NULL, var_1063);
if (LV_IS_FALSE(var_1062)) {
lval var_1065;
var_1065 = LVI_STRING("malformed \'do\' expression \'%v\'");
lval var_1068[8];
var_1068[0] = var_1065;
lval var_1069[8];
var_1069[0] = var_1059[1];
var_1059[1] = wile_gen_list(1, var_1069, NULL);
var_1059[0] = var_1068[0];
TAIL_CALL fn_7(NULL, var_1059);
} else {
lval var_1070;
lval var_1071;
if (var_1059[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1071 = (var_1059[1].v.pair.car ? *(var_1059[1].v.pair.car) : LVI_NIL());
var_1070 = var_1071;
lval var_1072;
lval var_1073;
var_1073 = LVI_STRING("cadr");
lval var_1074;
{
char* cp = strchr(var_1073.v.str, 'r');
var_1074 = var_1059[1];
while (*(--cp) != 'c') {
if (var_1074.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_1074 = (var_1074.v.pair.car ? *(var_1074.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_1074 = (var_1074.v.pair.cdr ? *(var_1074.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_1073.v.str);
}
}
}
var_1072 = var_1074;
lval var_1075;
lval var_1076;
var_1076 = LVI_STRING("cddr");
lval var_1077;
{
char* cp = strchr(var_1076.v.str, 'r');
var_1077 = var_1059[1];
while (*(--cp) != 'c') {
if (var_1077.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_1077 = (var_1077.v.pair.car ? *(var_1077.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_1077 = (var_1077.v.pair.cdr ? *(var_1077.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_1076.v.str);
}
}
}
var_1075 = var_1077;
MK_CLOS(var_1079,0);
lval var_1096;
var_1096 = LVI_NIL();
{
lval var_1097[8];
var_1097[0] = LVI_PROC(fn_1078,var_1079,1);
var_1097[1] = var_1070;
var_1097[2] = var_1096;
var_1096 = wile_for_each(NULL, var_1097);
}
lval var_1099;
var_1099 = LVI_BOOL(true);
do {
lval var_1100;
{
var_1100 = var_1072;
while (var_1100.vt == LV_PAIR) {
var_1100 = (var_1100.v.pair.cdr ? *(var_1100.v.pair.cdr) : LVI_NIL());
}
var_1100 = LVI_BOOL(var_1100.vt == LV_NIL);
}
var_1099 = var_1100;
if (LV_IS_FALSE(var_1099)) { break; }
lval var_1101;
var_1101 = LVI_INT(1);
lval var_1102;
{
lval var_1103[8];
var_1103[0] = var_1101;
var_1103[1] = var_1072;
var_1102 = wile_list_length_ge(NULL, var_1103);
}
var_1099 = var_1102;
if (LV_IS_FALSE(var_1099)) { break; }
} while (0);
if (LV_IS_FALSE(var_1099)) {
lval var_1104;
var_1104 = LVI_STRING("malformed \'do\' test-expr \'%v\'");
lval var_1106[8];
var_1106[0] = var_1104;
lval var_1108[8];
var_1108[0] = var_1072;
var_1106[1] = wile_gen_list(1, var_1108, NULL);
(void)
 fn_7(NULL, var_1106);
} else {
(void)
 LVI_BOOL(false);
}
MK_CLOS(var_1111,4);
P_CLOS(var_1111,3) = &(var_1070);
P_CLOS(var_1111,2) = &(var_1075);
P_CLOS(var_1111,1) = &(var_1072);
P_CLOS(var_1111,0) = &(var_1059[0]);
MK_CLOS(var_1162,1);
P_CLOS(var_1162,0) = &(var_1059[0]);
lval var_1174;
var_1174 = LVI_NIL();
{
lval var_1175[8];
var_1175[0] = LVI_PROC(fn_1161,var_1162,1);
var_1175[1] = var_1070;
var_1175[2] = var_1174;
var_1174 = wile_map(NULL, var_1175);
}
lval var_1176;
lval var_1177[8];
var_1177[0] = var_1174;
var_1176 = fn_1110(var_1111, var_1177);
var_1061 = var_1176;
}
return var_1061;
}
// end of function fn_27

// @@@ lambda (fs as env) @@@ bld-rtl-dir/wile-rtl2-000077.scm:422 @@@ fn_1225 @@@
static lval fn_1225(lptr* var_1226, lptr var_1227)
{
lbl_1228:;
lval var_1229;
lval var_1230;
var_1230 = LVI_BOOL(var_1227[0].vt == LV_NIL);
if (LV_IS_FALSE(var_1230)) {
lval var_1231;
if (var_1227[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1231 = (var_1227[0].v.pair.cdr ? *(var_1227[0].v.pair.cdr) : LVI_NIL());
lval var_1232;
if (var_1227[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1232 = (var_1227[1].v.pair.cdr ? *(var_1227[1].v.pair.cdr) : LVI_NIL());
lval var_1233;
if (var_1227[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1233 = (var_1227[0].v.pair.car ? *(var_1227[0].v.pair.car) : LVI_NIL());
lval var_1234;
if (var_1227[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1234 = (var_1227[1].v.pair.car ? *(var_1227[1].v.pair.car) : LVI_NIL());
lval var_1235;
lval var_1236[8];
var_1236[0] = var_1233;
var_1236[1] = var_1234;
var_1235 = fn_1(NULL, var_1236);
lval var_1238;
{
lptr p1 = NULL, p2 = NULL;
if (var_1235.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_1235;
}
if (var_1227[2].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_1227[2];
}
var_1238 = LVI_PAIR(p1, p2);
}
lval var_1241[8];
var_1241[0] = var_1231;
var_1241[1] = var_1232;
var_1241[2] = var_1238;
var_1227[0] = var_1241[0];
var_1227[1] = var_1241[1];
var_1227[2] = var_1241[2];
goto lbl_1228;	// selfie
} else {
var_1229 = var_1227[2];
}
return var_1229;
}
// end of lambda fn_1225

// @@@ (apply-lambda fn args) @@@ bld-rtl-dir/wile-rtl2-000077.scm:406 @@@ wile_eval_apply_lambda @@@
lval wile_eval_apply_lambda(lptr* var_1179, lptr var_1180)
{
lval var_1182;
lval var_1183;
if (var_1180[0].vt == LV_ILAMBDA) {
var_1183 = var_1180[0].v.ilambda->args;
} else {
WILE_EX("get-interpreted-procedure-arguments", "expects an interpreted procedure");
}
var_1182 = var_1183;
lval var_1184;
lval var_1185;
if (var_1180[0].vt == LV_ILAMBDA) {
var_1185 = LVI_INT(var_1180[0].v.ilambda->arity);
} else {
WILE_EX("get-interpreted-procedure-arity", "expects an interpreted procedure");
}
var_1184 = var_1185;
lval var_1186;
lval var_1187;
{
lval var_1188[8];
var_1188[0] = var_1180[1];
var_1187 = wile_list_length(NULL, var_1188);
}
var_1186 = var_1187;
lval var_1190;
switch (var_1184.vt) {
case LV_REAL:
var_1190 = LVI_BOOL(var_1184.v.rv < 0.0);
break;
case LV_RAT:
var_1190 = LVI_BOOL((var_1184.v.irv.num < 0 && var_1184.v.irv.den >= 0) || (var_1184.v.irv.num > 0 && var_1184.v.irv.den < 0));
break;
case LV_INT:
var_1190 = LVI_BOOL(var_1184.v.iv < 0);
break;
default:
WILE_EX("negative?", "expects a real-valued number");
}
if (LV_IS_FALSE(var_1190)) {
lval var_1192;
switch (TYPE_COMBO(var_1186.vt,var_1184.vt)) {
case TYPE_COMBO(LV_INT,LV_INT):
var_1192 = LVI_BOOL(var_1186.v.iv == var_1184.v.iv);
break;
case TYPE_COMBO(LV_INT,LV_RAT):
var_1192 = LVI_BOOL(var_1186.v.iv * var_1184.v.irv.den == var_1184.v.irv.num);
break;
case TYPE_COMBO(LV_INT,LV_REAL):
var_1192 = LVI_BOOL(var_1186.v.iv == var_1184.v.rv);
break;
case TYPE_COMBO(LV_RAT,LV_INT):
var_1192 = LVI_BOOL(var_1186.v.irv.num == var_1184.v.iv * var_1186.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_RAT):
var_1192 = LVI_BOOL(var_1186.v.irv.num * var_1184.v.irv.den == var_1184.v.irv.num * var_1186.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_REAL):
var_1192 = LVI_BOOL(var_1186.v.irv.num == var_1184.v.rv * var_1186.v.irv.den);
break;
case TYPE_COMBO(LV_REAL,LV_INT):
var_1192 = LVI_BOOL(var_1186.v.rv == var_1184.v.iv);
break;
case TYPE_COMBO(LV_REAL,LV_RAT):
var_1192 = LVI_BOOL(var_1186.v.rv * var_1184.v.irv.den == var_1184.v.irv.num);
break;
case TYPE_COMBO(LV_REAL,LV_REAL):
var_1192 = LVI_BOOL(var_1186.v.rv == var_1184.v.rv);
break;
default:
WILE_EX("==", "inputs are not real-valued numbers");
break;
}
if (LV_IS_FALSE(var_1192)) {
lval var_1193;
var_1193 = LVI_STRING("malformed \'lambda\' evaluation: %d formal vs %d actual args");
lval var_1195[8];
var_1195[0] = var_1193;
lval var_1197[8];
var_1197[0] = var_1184;
var_1197[1] = var_1186;
var_1195[1] = wile_gen_list(2, var_1197, NULL);
(void)
 fn_7(NULL, var_1195);
} else {
(void)
 LVI_BOOL(false);
}
} else {
lval var_1199;
lval var_1200;
{
lval var_1202[1];
var_1202[0] = var_1184;
var_1200 = wile_gen_list(1, var_1202, NULL);
}
{
lval var_1201[8];
var_1201[0] = var_1200;
var_1200 = wile_subtract(NULL, var_1201);
}
lval var_1203;
var_1203 = LVI_INT(1);
lval var_1204;
{
lval var_1206[2];
var_1206[0] = var_1200;
var_1206[1] = var_1203;
var_1204 = wile_gen_list(2, var_1206, NULL);
}
{
lval var_1205[8];
var_1205[0] = var_1204;
var_1204 = wile_subtract(NULL, var_1205);
}
var_1199 = var_1204;
lval var_1208;
switch (TYPE_COMBO(var_1186.vt,var_1199.vt)) {
case TYPE_COMBO(LV_INT,LV_INT):
var_1208 = LVI_BOOL(var_1186.v.iv >= var_1199.v.iv);
break;
case TYPE_COMBO(LV_INT,LV_RAT):
var_1208 = LVI_BOOL(var_1186.v.iv * var_1199.v.irv.den >= var_1199.v.irv.num);
break;
case TYPE_COMBO(LV_INT,LV_REAL):
var_1208 = LVI_BOOL(var_1186.v.iv >= var_1199.v.rv);
break;
case TYPE_COMBO(LV_RAT,LV_INT):
var_1208 = LVI_BOOL(var_1186.v.irv.num >= var_1199.v.iv * var_1186.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_RAT):
var_1208 = LVI_BOOL(var_1186.v.irv.num * var_1199.v.irv.den >= var_1199.v.irv.num * var_1186.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_REAL):
var_1208 = LVI_BOOL(var_1186.v.irv.num >= var_1199.v.rv * var_1186.v.irv.den);
break;
case TYPE_COMBO(LV_REAL,LV_INT):
var_1208 = LVI_BOOL(var_1186.v.rv >= var_1199.v.iv);
break;
case TYPE_COMBO(LV_REAL,LV_RAT):
var_1208 = LVI_BOOL(var_1186.v.rv * var_1199.v.irv.den >= var_1199.v.irv.num);
break;
case TYPE_COMBO(LV_REAL,LV_REAL):
var_1208 = LVI_BOOL(var_1186.v.rv >= var_1199.v.rv);
break;
default:
WILE_EX(">=", "inputs are not real-valued numbers");
break;
}
if (LV_IS_FALSE(var_1208)) {
lval var_1209;
var_1209 = LVI_STRING("malformed \'lambda\' evaluation: %d required vs %d given args");
lval var_1211[8];
var_1211[0] = var_1209;
lval var_1213[8];
var_1213[0] = var_1199;
var_1213[1] = var_1186;
var_1211[1] = wile_gen_list(2, var_1213, NULL);
(void)
 fn_7(NULL, var_1211);
} else {
(void)
 LVI_BOOL(false);
}
lval var_1215;
{
lval var_1216[8];
var_1216[0] = var_1180[1];
var_1216[1] = var_1199;
var_1215 = wile_list_head(NULL, var_1216);
}
lval var_1217;
{
lval var_1218[8];
var_1218[0] = var_1180[1];
var_1218[1] = var_1199;
var_1217 = wile_list_tail(NULL, var_1218);
}
lval var_1219;
{
lval var_1220[1];
var_1220[0] = var_1217;
var_1219 = wile_gen_list(1, var_1220, NULL);
}
lval var_1221;
{
lval var_1223[2];
var_1223[0] = var_1215;
var_1223[1] = var_1219;
var_1221 = wile_gen_list(2, var_1223, NULL);
}
{
lval var_1222[8];
var_1222[0] = var_1221;
var_1221 = wile_list_append(NULL, var_1222);
}
var_1180[1] = var_1221;
(void)
 var_1180[1];
}
lval var_1224;
var_1224 = LVI_BOOL(false);
MK_CLOS(var_1226,0);
lval var_1242;
if (var_1180[0].vt == LV_ILAMBDA) {
var_1242 = var_1180[0].v.ilambda->env;
} else {
WILE_EX("get-interpreted-procedure-environment", "expects an interpreted procedure");
}
lval var_1243;
lval var_1244[8];
var_1244[0] = var_1182;
var_1244[1] = var_1180[1];
var_1244[2] = var_1242;
var_1243 = fn_1225(var_1226, var_1244);
lval var_1246;
if (var_1180[0].vt == LV_ILAMBDA) {
var_1246 = var_1180[0].v.ilambda->body;
} else {
WILE_EX("get-interpreted-procedure-body", "expects an interpreted procedure");
}
lval var_1249[8];
var_1249[0] = var_1224;
var_1249[1] = var_1243;
var_1249[2] = var_1246;
var_1180[0] = var_1249[0];
var_1180[1] = var_1249[1];
var_1180[2] = var_1249[2];
TAIL_CALL wile_eval_begin(NULL, var_1180);
}
// end of function wile_eval_apply_lambda

// @@@ lambda (acc lst) @@@ bld-rtl-dir/wile-rtl2-000077.scm:435 @@@ fn_1257 @@@
static lval fn_1257(lptr* var_1258, lptr var_1259)
{
lbl_1260:;
lval var_1261;
lval var_1262;
var_1262 = LVI_BOOL(var_1259[1].vt == LV_NIL);
if (LV_IS_FALSE(var_1262)) {
lval var_1263;
if (var_1259[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1263 = (var_1259[1].v.pair.car ? *(var_1259[1].v.pair.car) : LVI_NIL());
lval var_1264;
{
lptr p1 = NULL, p2 = NULL;
if (var_1263.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_1263;
}
if (var_1259[0].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_1259[0];
}
var_1264 = LVI_PAIR(p1, p2);
}
lval var_1265;
if (var_1259[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1265 = (var_1259[1].v.pair.cdr ? *(var_1259[1].v.pair.cdr) : LVI_NIL());
lval var_1268[8];
var_1268[0] = var_1264;
var_1268[1] = var_1265;
var_1259[0] = var_1268[0];
var_1259[1] = var_1268[1];
goto lbl_1260;	// selfie
} else {
var_1261 = var_1259[0];
}
return var_1261;
}
// end of lambda fn_1257

// @@@ (apply-interp fn . args) @@@ bld-rtl-dir/wile-rtl2-000077.scm:433 @@@ wile_eval_apply_interp @@@
lval wile_eval_apply_interp(lptr* var_1250, lptr var_1251)
{
lval var_1253;
lval var_1254;
{
lval var_1255[8];
var_1255[0] = var_1251[1];
var_1254 = wile_list_reverse(NULL, var_1255);
}
var_1253 = var_1254;
lval var_1256;
MK_CLOS(var_1258,0);
lval var_1269;
if (var_1253.vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1269 = (var_1253.v.pair.car ? *(var_1253.v.pair.car) : LVI_NIL());
lval var_1270;
if (var_1253.vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1270 = (var_1253.v.pair.cdr ? *(var_1253.v.pair.cdr) : LVI_NIL());
lval var_1271;
lval var_1272[8];
var_1272[0] = var_1269;
var_1272[1] = var_1270;
var_1271 = fn_1257(var_1258, var_1272);
var_1256 = var_1271;
lval var_1274;
lval var_1275;
var_1275 = LVI_BOOL(var_1251[0].vt == LV_ILAMBDA);
if (LV_IS_FALSE(var_1275)) {
lval var_1276;
{
lval var_1277[2];
var_1277[0] = var_1251[0];
var_1277[1] = var_1256;
var_1276 = wile_gen_list(2, var_1277, NULL);
}
var_1276 = wile_apply_function(&(var_1276), __FILE__, __LINE__);
var_1274 = var_1276;
} else {
lval var_1280[8];
var_1280[0] = var_1251[0];
var_1280[1] = var_1256;
var_1251[0] = var_1280[0];
var_1251[1] = var_1280[1];
TAIL_CALL wile_eval_apply_lambda(NULL, var_1251);
}
return var_1274;
}
// end of function wile_eval_apply_interp

// @@@ lambda (e) @@@ bld-rtl-dir/wile-rtl2-000077.scm:490 @@@ fn_1425 @@@
static lval fn_1425(lptr* var_1426, lptr var_1427)
{
lval var_1431[8];
var_1431[0] = V_CLOS(var_1426,0);
var_1431[1] = var_1427[0];
var_1427[0] = var_1431[0];
var_1427[1] = var_1431[1];
TAIL_CALL wile_eval(NULL, var_1427);
}
// end of lambda fn_1425

// @@@ lambda (e) @@@ bld-rtl-dir/wile-rtl2-000077.scm:487 @@@ fn_1439 @@@
static lval fn_1439(lptr* var_1440, lptr var_1441)
{
lval var_1445[8];
var_1445[0] = V_CLOS(var_1440,0);
var_1445[1] = var_1441[0];
var_1441[0] = var_1445[0];
var_1441[1] = var_1445[1];
TAIL_CALL wile_eval(NULL, var_1441);
}
// end of lambda fn_1439

// @@@ (eval env expr) @@@ bld-rtl-dir/wile-rtl2-000077.scm:446 @@@ wile_eval @@@
lval wile_eval(lptr* var_1281, lptr var_1282)
{
lbl_1283:;
lval var_1284;
do {
lval var_1285;
var_1285 = LVI_BOOL(false);
do {
lval var_1286;
lval var_1287[8];
var_1287[0] = var_1282[1];
var_1286 = fn_8(NULL, var_1287);
var_1285 = var_1286;
if (!LV_IS_FALSE(var_1285)) { break; }
lval var_1289;
var_1289 = LVI_BOOL(var_1282[1].vt == LV_VECTOR);
var_1285 = var_1289;
if (!LV_IS_FALSE(var_1285)) { break; }
lval var_1290;
var_1290 = LVI_BOOL(var_1282[1].vt == LV_BVECTOR);
var_1285 = var_1290;
if (!LV_IS_FALSE(var_1285)) { break; }
} while (0);
if (!LV_IS_FALSE(var_1285)) {
var_1284 = var_1282[1];
break;
}
lval var_1291;
var_1291 = LVI_BOOL(var_1282[1].vt == LV_SYMBOL);
if (!LV_IS_FALSE(var_1291)) {
lval var_1292;
var_1292 = LVI_BOOL(false);
lval var_1295[8];
var_1295[0] = var_1292;
var_1295[1] = var_1282[0];
var_1295[2] = var_1282[1];
var_1282[0] = var_1295[0];
var_1282[1] = var_1295[1];
var_1282[2] = var_1295[2];
TAIL_CALL fn_11(NULL, var_1282);
}
lval var_1296;
var_1296 = LVI_BOOL(var_1282[1].vt == LV_PAIR);
if (!LV_IS_FALSE(var_1296)) {
lval var_1297;
do {
lval var_1298;
if (var_1282[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1298 = (var_1282[1].v.pair.car ? *(var_1282[1].v.pair.car) : LVI_NIL());
lval var_1299;
lval var_1300[8];
var_1300[0] = var_1298;
var_1299 = fn_9(NULL, var_1300);
if (!LV_IS_FALSE(var_1299)) {
lval var_1302;
if (var_1282[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1302 = (var_1282[1].v.pair.car ? *(var_1282[1].v.pair.car) : LVI_NIL());
lval var_1303;
if (var_1302.vt != LV_SYMBOL) {
wile_exception2("case", __FILE__, __LINE__, "case-value type does not match case type");
}
do {
if ((strcmp(var_1302.v.str, "quote") == 0)) {
lval var_1304;
var_1304 = LVI_STRING("cadr");
lval var_1305;
{
char* cp = strchr(var_1304.v.str, 'r');
var_1305 = var_1282[1];
while (*(--cp) != 'c') {
if (var_1305.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_1305 = (var_1305.v.pair.car ? *(var_1305.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_1305 = (var_1305.v.pair.cdr ? *(var_1305.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_1304.v.str);
}
}
}
var_1303 = var_1305;
break;
}
if ((strcmp(var_1302.v.str, "begin") == 0)) {
lval var_1306;
var_1306 = LVI_BOOL(false);
lval var_1307;
if (var_1282[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1307 = (var_1282[1].v.pair.cdr ? *(var_1282[1].v.pair.cdr) : LVI_NIL());
lval var_1310[8];
var_1310[0] = var_1306;
var_1310[1] = var_1282[0];
var_1310[2] = var_1307;
var_1282[0] = var_1310[0];
var_1282[1] = var_1310[1];
var_1282[2] = var_1310[2];
TAIL_CALL wile_eval_begin(NULL, var_1282);
}
if ((strcmp(var_1302.v.str, "if") == 0)) {
lval var_1311;
if (var_1282[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1311 = (var_1282[1].v.pair.cdr ? *(var_1282[1].v.pair.cdr) : LVI_NIL());
lval var_1314[8];
var_1314[0] = var_1282[0];
var_1314[1] = var_1311;
var_1282[0] = var_1314[0];
var_1282[1] = var_1314[1];
TAIL_CALL fn_13(NULL, var_1282);
}
if ((strcmp(var_1302.v.str, "and") == 0)) {
lval var_1315;
var_1315 = LVI_BOOL(true);
lval var_1316;
if (var_1282[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1316 = (var_1282[1].v.pair.cdr ? *(var_1282[1].v.pair.cdr) : LVI_NIL());
lval var_1319[8];
var_1319[0] = var_1315;
var_1319[1] = var_1282[0];
var_1319[2] = var_1316;
var_1282[0] = var_1319[0];
var_1282[1] = var_1319[1];
var_1282[2] = var_1319[2];
TAIL_CALL fn_14(NULL, var_1282);
}
if ((strcmp(var_1302.v.str, "or") == 0)) {
lval var_1320;
var_1320 = LVI_BOOL(false);
lval var_1321;
if (var_1282[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1321 = (var_1282[1].v.pair.cdr ? *(var_1282[1].v.pair.cdr) : LVI_NIL());
lval var_1324[8];
var_1324[0] = var_1320;
var_1324[1] = var_1282[0];
var_1324[2] = var_1321;
var_1282[0] = var_1324[0];
var_1282[1] = var_1324[1];
var_1282[2] = var_1324[2];
TAIL_CALL fn_15(NULL, var_1282);
}
if ((strcmp(var_1302.v.str, "let") == 0)) {
lval var_1325;
var_1325 = LVI_BOOL(false);
lval var_1326;
var_1326 = LVI_BOOL(false);
lval var_1327;
if (var_1282[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1327 = (var_1282[1].v.pair.cdr ? *(var_1282[1].v.pair.cdr) : LVI_NIL());
lval var_1330[8];
var_1330[0] = var_1325;
var_1330[1] = var_1326;
var_1330[2] = var_1282[0];
var_1330[3] = var_1327;
var_1282[0] = var_1330[0];
var_1282[1] = var_1330[1];
var_1282[2] = var_1330[2];
var_1282[3] = var_1330[3];
TAIL_CALL fn_17(NULL, var_1282);
}
if ((strcmp(var_1302.v.str, "let*") == 0)) {
lval var_1331;
var_1331 = LVI_BOOL(false);
lval var_1332;
var_1332 = LVI_BOOL(true);
lval var_1333;
if (var_1282[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1333 = (var_1282[1].v.pair.cdr ? *(var_1282[1].v.pair.cdr) : LVI_NIL());
lval var_1336[8];
var_1336[0] = var_1331;
var_1336[1] = var_1332;
var_1336[2] = var_1282[0];
var_1336[3] = var_1333;
var_1282[0] = var_1336[0];
var_1282[1] = var_1336[1];
var_1282[2] = var_1336[2];
var_1282[3] = var_1336[3];
TAIL_CALL fn_17(NULL, var_1282);
}
if ((strcmp(var_1302.v.str, "letrec") == 0)) {
lval var_1337;
var_1337 = LVI_BOOL(true);
lval var_1338;
var_1338 = LVI_BOOL(false);
lval var_1339;
if (var_1282[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1339 = (var_1282[1].v.pair.cdr ? *(var_1282[1].v.pair.cdr) : LVI_NIL());
lval var_1342[8];
var_1342[0] = var_1337;
var_1342[1] = var_1338;
var_1342[2] = var_1282[0];
var_1342[3] = var_1339;
var_1282[0] = var_1342[0];
var_1282[1] = var_1342[1];
var_1282[2] = var_1342[2];
var_1282[3] = var_1342[3];
TAIL_CALL fn_17(NULL, var_1282);
}
if ((strcmp(var_1302.v.str, "letrec*") == 0)) {
lval var_1343;
var_1343 = LVI_BOOL(true);
lval var_1344;
var_1344 = LVI_BOOL(true);
lval var_1345;
if (var_1282[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1345 = (var_1282[1].v.pair.cdr ? *(var_1282[1].v.pair.cdr) : LVI_NIL());
lval var_1348[8];
var_1348[0] = var_1343;
var_1348[1] = var_1344;
var_1348[2] = var_1282[0];
var_1348[3] = var_1345;
var_1282[0] = var_1348[0];
var_1282[1] = var_1348[1];
var_1282[2] = var_1348[2];
var_1282[3] = var_1348[3];
TAIL_CALL fn_17(NULL, var_1282);
}
if ((strcmp(var_1302.v.str, "cond") == 0)) {
lval var_1349;
var_1349 = LVI_SYMBOL("else");
lval var_1350;
var_1350 = LVI_BOOL(true);
lval var_1351;
lval var_1352[8];
var_1352[0] = var_1349;
var_1352[1] = var_1350;
var_1351 = fn_1(NULL, var_1352);
lval var_1354;
{
lptr p1 = NULL, p2 = NULL;
if (var_1351.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_1351;
}
if (var_1282[0].vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_1282[0];
}
var_1354 = LVI_PAIR(p1, p2);
}
lval var_1355;
if (var_1282[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1355 = (var_1282[1].v.pair.cdr ? *(var_1282[1].v.pair.cdr) : LVI_NIL());
lval var_1358[8];
var_1358[0] = var_1354;
var_1358[1] = var_1355;
var_1282[0] = var_1358[0];
var_1282[1] = var_1358[1];
TAIL_CALL fn_20(NULL, var_1282);
}
if ((strcmp(var_1302.v.str, "set!") == 0)) {
lval var_1359;
if (var_1282[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1359 = (var_1282[1].v.pair.cdr ? *(var_1282[1].v.pair.cdr) : LVI_NIL());
lval var_1362[8];
var_1362[0] = var_1282[0];
var_1362[1] = var_1359;
var_1282[0] = var_1362[0];
var_1282[1] = var_1362[1];
TAIL_CALL fn_21(NULL, var_1282);
}
if ((strcmp(var_1302.v.str, "guard") == 0)) {
lval var_1363;
if (var_1282[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1363 = (var_1282[1].v.pair.cdr ? *(var_1282[1].v.pair.cdr) : LVI_NIL());
lval var_1366[8];
var_1366[0] = var_1282[0];
var_1366[1] = var_1363;
var_1282[0] = var_1366[0];
var_1282[1] = var_1366[1];
TAIL_CALL fn_22(NULL, var_1282);
}
if ((strcmp(var_1302.v.str, "case") == 0)) {
lval var_1367;
if (var_1282[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1367 = (var_1282[1].v.pair.cdr ? *(var_1282[1].v.pair.cdr) : LVI_NIL());
lval var_1370[8];
var_1370[0] = var_1282[0];
var_1370[1] = var_1367;
var_1282[0] = var_1370[0];
var_1282[1] = var_1370[1];
TAIL_CALL fn_23(NULL, var_1282);
}
if ((strcmp(var_1302.v.str, "lambda") == 0)) {
lval var_1371;
if (var_1282[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1371 = (var_1282[1].v.pair.cdr ? *(var_1282[1].v.pair.cdr) : LVI_NIL());
lval var_1374[8];
var_1374[0] = var_1282[0];
var_1374[1] = var_1371;
var_1282[0] = var_1374[0];
var_1282[1] = var_1374[1];
TAIL_CALL fn_25(NULL, var_1282);
}
if ((strcmp(var_1302.v.str, "do") == 0)) {
lval var_1375;
if (var_1282[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1375 = (var_1282[1].v.pair.cdr ? *(var_1282[1].v.pair.cdr) : LVI_NIL());
lval var_1378[8];
var_1378[0] = var_1282[0];
var_1378[1] = var_1375;
var_1282[0] = var_1378[0];
var_1282[1] = var_1378[1];
TAIL_CALL fn_27(NULL, var_1282);
}
if ((strcmp(var_1302.v.str, "pragma") == 0)) {
lval var_1379;
var_1379 = LVI_STRING(";;; ignoring %v\n");
lval var_1380;
{
lval var_1382[1];
var_1382[0] = var_1282[1];
var_1380 = wile_gen_list(1, var_1382, NULL);
}
{
lval var_1381[8];
var_1381[0] = var_stderr;
var_1381[1] = var_1379;
var_1381[2] = var_1380;
var_1380 = wile_fprintf(NULL, var_1381);
}
var_1303 = var_1380;
break;
}
if ((strcmp(var_1302.v.str, "quasiquote") == 0)) {
lval var_1383;
lval var_1384;
var_1384 = LVI_INT(2);
lval var_1385;
{
lval var_1386[8];
var_1386[0] = var_1384;
var_1386[1] = var_1282[1];
var_1385 = wile_list_length_eq(NULL, var_1386);
}
if (LV_IS_FALSE(var_1385)) {
lval var_1387;
var_1387 = LVI_STRING("malformed \'quasiquote\' expression \'%v\'");
lval var_1388;
if (var_1282[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1388 = (var_1282[1].v.pair.cdr ? *(var_1282[1].v.pair.cdr) : LVI_NIL());
lval var_1391[8];
var_1391[0] = var_1387;
lval var_1392[8];
var_1392[0] = var_1388;
var_1282[1] = wile_gen_list(1, var_1392, NULL);
var_1282[0] = var_1391[0];
TAIL_CALL fn_7(NULL, var_1282);
} else {
lval var_1393;
var_1393 = LVI_INT(1);
lval var_1394;
var_1394 = LVI_STRING("cadr");
lval var_1395;
{
char* cp = strchr(var_1394.v.str, 'r');
var_1395 = var_1282[1];
while (*(--cp) != 'c') {
if (var_1395.vt != LV_PAIR) {
WILE_EX("cxr", "input does not have the right structure!");
}
if (*cp == 'a') {
var_1395 = (var_1395.v.pair.car ? *(var_1395.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_1395 = (var_1395.v.pair.cdr ? *(var_1395.v.pair.cdr) : LVI_NIL());
} else {
WILE_EX("cxr", "got malformed control string '%s'", var_1394.v.str);
}
}
}
lval var_1398[8];
var_1398[0] = var_1393;
var_1398[1] = var_1282[0];
var_1398[2] = var_1395;
var_1282[0] = var_1398[0];
var_1282[1] = var_1398[1];
var_1282[2] = var_1398[2];
TAIL_CALL fn_19(NULL, var_1282);
}
var_1303 = var_1383;
break;
}
if ((strcmp(var_1302.v.str, "unquote") == 0)) {
lval var_1399;
var_1399 = LVI_STRING("naked \'unquote\' expression \'%v\'");
lval var_1402[8];
var_1402[0] = var_1399;
lval var_1403[8];
var_1403[0] = var_1282[1];
var_1282[1] = wile_gen_list(1, var_1403, NULL);
var_1282[0] = var_1402[0];
TAIL_CALL fn_7(NULL, var_1282);
}
if ((strcmp(var_1302.v.str, "unquote-splicing") == 0)) {
lval var_1404;
var_1404 = LVI_STRING("naked \'unquote-splicing\' expression \'%v\'");
lval var_1407[8];
var_1407[0] = var_1404;
lval var_1408[8];
var_1408[0] = var_1282[1];
var_1282[1] = wile_gen_list(1, var_1408, NULL);
var_1282[0] = var_1407[0];
TAIL_CALL fn_7(NULL, var_1282);
}
{
lval var_1409;
var_1409 = LVI_SYMBOL("unimplemented-special-form");
var_1303 = var_1409;
break;
}
} while (0);
var_1297 = var_1303;
break;
}
lval var_1410;
lval var_1411[8];
var_1411[0] = var_1282[1];
var_1410 = wile_eval_define_form(NULL, var_1411);
if (!LV_IS_FALSE(var_1410)) {
lval var_1413;
var_1413 = LVI_STRING("misplaced \'define\' expression \'%v\'");
lval var_1416[8];
var_1416[0] = var_1413;
lval var_1417[8];
var_1417[0] = var_1282[1];
var_1282[1] = wile_gen_list(1, var_1417, NULL);
var_1282[0] = var_1416[0];
TAIL_CALL fn_7(NULL, var_1282);
}
lval var_1418;
lval var_1419;
if (var_1282[1].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_1419 = (var_1282[1].v.pair.car ? *(var_1282[1].v.pair.car) : LVI_NIL());
lval var_1420;
lval var_1421[8];
var_1421[0] = var_1282[0];
var_1421[1] = var_1419;
var_1420 = wile_eval(NULL, var_1421);
var_1418 = var_1420;
lval var_1423;
lval var_1424;
var_1424 = LVI_BOOL(var_1418.vt == LV_ILAMBDA);
if (LV_IS_FALSE(var_1424)) {
MK_CLOS(var_1426,1);
P_CLOS(var_1426,0) = &(var_1282[0]);
lval var_1432;
if (var_1282[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1432 = (var_1282[1].v.pair.cdr ? *(var_1282[1].v.pair.cdr) : LVI_NIL());
lval var_1433;
var_1433 = LVI_NIL();
{
lval var_1434[8];
var_1434[0] = LVI_PROC(fn_1425,var_1426,1);
var_1434[1] = var_1432;
var_1434[2] = var_1433;
var_1433 = wile_map(NULL, var_1434);
}
lval var_1435;
{
lval var_1436[2];
var_1436[0] = var_1418;
var_1436[1] = var_1433;
var_1435 = wile_gen_list(2, var_1436, NULL);
}
var_1435 = wile_apply_function(&(var_1435), __FILE__, __LINE__);
var_1423 = var_1435;
} else {
lval var_1437;
lval var_1438;
if (var_1418.vt == LV_ILAMBDA) {
var_1438 = LVI_BOOL(var_1418.v.ilambda->macro);
} else {
WILE_EX("get-interpreted-procedure-macro", "expects an interpreted procedure");
}
if (LV_IS_FALSE(var_1438)) {
MK_CLOS(var_1440,1);
P_CLOS(var_1440,0) = &(var_1282[0]);
lval var_1446;
if (var_1282[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1446 = (var_1282[1].v.pair.cdr ? *(var_1282[1].v.pair.cdr) : LVI_NIL());
lval var_1447;
var_1447 = LVI_NIL();
{
lval var_1448[8];
var_1448[0] = LVI_PROC(fn_1439,var_1440,1);
var_1448[1] = var_1446;
var_1448[2] = var_1447;
var_1447 = wile_map(NULL, var_1448);
}
lval var_1451[8];
var_1451[0] = var_1418;
var_1451[1] = var_1447;
var_1282[0] = var_1451[0];
var_1282[1] = var_1451[1];
TAIL_CALL wile_eval_apply_lambda(NULL, var_1282);
} else {
lval var_1452;
if (var_1282[1].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_1452 = (var_1282[1].v.pair.cdr ? *(var_1282[1].v.pair.cdr) : LVI_NIL());
lval var_1453;
lval var_1454[8];
var_1454[0] = var_1418;
var_1454[1] = var_1452;
var_1453 = wile_eval_apply_lambda(NULL, var_1454);
lval var_1458[8];
var_1458[0] = var_1282[0];
var_1458[1] = var_1453;
var_1282[0] = var_1458[0];
var_1282[1] = var_1458[1];
goto lbl_1283;	// selfie
}
var_1423 = var_1437;
}
var_1297 = var_1423;
} while (0);
var_1284 = var_1297;
break;
}
var_1284 = LVI_BOOL(false);
} while (0);
return var_1284;
}
// end of function wile_eval
