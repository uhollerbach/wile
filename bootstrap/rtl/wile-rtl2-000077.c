// Generated by wile, the extremely stable scheming genius compiler

#include "wile-rtl1.h"
#include "wile-rtl2.h"

// declarations

extern lval var_argv;
extern lval var_cmd_name;
extern lval var_stdin;
extern lval var_stdout;
extern lval var_stderr;
extern lval var_pi;
extern lval var_euler_gamma;
extern lval var_show_sign;
extern lval var_int_base;
extern lval var_flt_base;
extern lval var_flt_precision;
#include "wile-rtl2.h"
static lval fn_4(lptr*, lptr, const char*);
static lval fn_13(lptr*, lptr, const char*);
static lval fn_35(lptr*, lptr, const char*);
static lval fn_64(lptr*, lptr, const char*);
static lval fn_89(lptr*, lptr, const char*);
static lval fn_109(lptr*, lptr, const char*);

// definitions

// @@@ lambda (e1 e2) @@@ bld-rtl-dir/wile-rtl2-000077.scm:19 @@@ fn_13 @@@
static lval fn_13(lptr* var_14, lptr var_15, const char* cloc)
{
lval var_17;
{
lval var_19[2];
var_19[0] = V_CLOS(var_14,0);
var_19[1] = var_15[1];
var_17 = wile_gen_list(2, var_19, NULL);
}
{
lval var_18[8];
var_18[0] = var_17;
var_17 = wile_multiply(NULL, var_18, "bld-rtl-dir/wile-rtl2-000077.scm:19");
}
lval var_20;
{
lval var_22[2];
var_22[0] = var_15[0];
var_22[1] = var_17;
var_20 = wile_gen_list(2, var_22, NULL);
}
{
lval var_21[8];
var_21[0] = var_20;
var_20 = wile_subtract(NULL, var_21, "bld-rtl-dir/wile-rtl2-000077.scm:19");
}
return var_20;
}
// end of lambda fn_13

// @@@ (sf m v) @@@ bld-rtl-dir/wile-rtl2-000077.scm:14 @@@ fn_4 @@@
static lval fn_4(lptr* var_5, lptr var_6, const char* cloc)
{
lval var_8;
lval var_9;
var_9 = LVI_BOOL(var_6[0].vt == LV_NIL);
if (LV_IS_FALSE(var_9)) {
lval var_10;
lval var_11;
#ifdef WILE_DO_CHECK
if (var_6[1].vt != LV_PAIR) {
wile_exception("car", "bld-rtl-dir/wile-rtl2-000077.scm:17", "input is not a pair!");
}
#endif // WILE_DO_CHECK
var_11 = (var_6[1].v.pair.car ? *(var_6[1].v.pair.car) : LVI_NIL());
var_10 = var_11;
lval var_12;
#ifdef WILE_DO_CHECK
if (var_6[0].vt != LV_PAIR) {
wile_exception("cdr", "bld-rtl-dir/wile-rtl2-000077.scm:18", "input is not a pair!");
}
#endif // WILE_DO_CHECK
var_12 = (var_6[0].v.pair.cdr ? *(var_6[0].v.pair.cdr) : LVI_NIL());
MK_CLOS(var_14,1);
lptr var_23 = new_lv(VT_UNINIT);
var_23->v.pair.car = &(var_10);
P_CLOS(var_14,0) = var_23;
lval var_24;
#ifdef WILE_DO_CHECK
if (var_6[1].vt != LV_PAIR) {
wile_exception("cdr", "bld-rtl-dir/wile-rtl2-000077.scm:20", "input is not a pair!");
}
#endif // WILE_DO_CHECK
var_24 = (var_6[1].v.pair.cdr ? *(var_6[1].v.pair.cdr) : LVI_NIL());
lval var_25;
var_25 = LVI_STRING("cdar");
lval var_26;
{
char* cp = strchr(var_25.v.str, 'r');
var_26 = var_6[0];
while (*(--cp) != 'c') {
#ifdef WILE_DO_CHECK
if (var_26.vt != LV_PAIR) {
wile_exception("cxr", "bld-rtl-dir/wile-rtl2-000077.scm:20", "input does not have the right structure!");
}
#endif // WILE_DO_CHECK
if (*cp == 'a') {
var_26 = (var_26.v.pair.car ? *(var_26.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_26 = (var_26.v.pair.cdr ? *(var_26.v.pair.cdr) : LVI_NIL());
} else {
wile_exception("cxr", "bld-rtl-dir/wile-rtl2-000077.scm:20", "got malformed control string '%s'", var_25.v.str);
}
}
}
lval var_27;
{
lval var_29[1];
var_29[0] = var_26;
var_27 = wile_gen_list(1, var_29, NULL);
}
{
lval var_28[8];
var_28[0] = LVI_PROC(fn_13,var_14,2);
var_28[1] = var_24;
var_28[2] = var_27;
var_27 = wile_map(NULL, var_28, "bld-rtl-dir/wile-rtl2-000077.scm:19");
}
lval var_30;
lval var_31[8];
var_31[0] = var_12;
var_31[1] = var_27;
var_30 = fn_4(NULL, var_31, "bld-rtl-dir/wile-rtl2-000077.scm:18");
lval var_33;
{
lptr p1 = NULL, p2 = NULL;
if (var_10.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_10;
}
if (var_30.vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_30;
}
var_33 = LVI_PAIR(p1, p2);
}
*var_23 = var_10;
var_8 = var_33;
} else {
lval var_34;
var_34 = LVI_NIL();
var_8 = var_34;
}
return var_8;
}
// end of function fn_4

// @@@ (t1 n m) @@@ bld-rtl-dir/wile-rtl2-000077.scm:21 @@@ fn_35 @@@
static lval fn_35(lptr* var_36, lptr var_37, const char* cloc)
{
lval var_39;
lval var_40;
switch (var_37[0].vt) {
case LV_REAL:
var_40 = LVI_BOOL(var_37[0].v.rv == 0.0);
break;
case LV_RAT:
var_40 = LVI_BOOL((var_37[0].v.irv.num == 0 && var_37[0].v.irv.den != 0));
break;
case LV_INT:
var_40 = LVI_BOOL(var_37[0].v.iv == 0);
break;
case LV_CMPLX:
var_40 = LVI_BOOL(CREAL(var_37[0].v.cv) == 0.0 && CIMAG(var_37[0].v.cv) == 0.0);
break;
default:
wile_exception("zero?", "bld-rtl-dir/wile-rtl2-000077.scm:22", "expects a real-valued number");
}
if (LV_IS_FALSE(var_40)) {
lval var_41;
lval var_42;
var_42 = LVI_INT(1);
lval var_43;
{
lval var_45[2];
var_45[0] = var_37[0];
var_45[1] = var_42;
var_43 = wile_gen_list(2, var_45, NULL);
}
{
lval var_44[8];
var_44[0] = var_43;
var_43 = wile_subtract(NULL, var_44, "bld-rtl-dir/wile-rtl2-000077.scm:24");
}
lval var_46;
#ifdef WILE_DO_CHECK
if (var_37[1].vt != LV_PAIR) {
wile_exception("cdr", "bld-rtl-dir/wile-rtl2-000077.scm:24", "input is not a pair!");
}
#endif // WILE_DO_CHECK
var_46 = (var_37[1].v.pair.cdr ? *(var_37[1].v.pair.cdr) : LVI_NIL());
lval var_47;
lval var_48[8];
var_48[0] = var_43;
var_48[1] = var_46;
var_47 = fn_35(NULL, var_48, "bld-rtl-dir/wile-rtl2-000077.scm:24");
var_41 = var_47;
lval var_50;
lval var_51;
#ifdef WILE_DO_CHECK
if (var_37[1].vt != LV_PAIR) {
wile_exception("car", "bld-rtl-dir/wile-rtl2-000077.scm:25", "input is not a pair!");
}
#endif // WILE_DO_CHECK
var_51 = (var_37[1].v.pair.car ? *(var_37[1].v.pair.car) : LVI_NIL());
var_50 = var_51;
lval var_52;
#ifdef WILE_DO_CHECK
if (var_50.vt != LV_PAIR) {
wile_exception("car", "bld-rtl-dir/wile-rtl2-000077.scm:26", "input is not a pair!");
}
#endif // WILE_DO_CHECK
var_52 = (var_50.v.pair.car ? *(var_50.v.pair.car) : LVI_NIL());
lval var_53;
#ifdef WILE_DO_CHECK
if (var_41.vt != LV_PAIR) {
wile_exception("car", "bld-rtl-dir/wile-rtl2-000077.scm:26", "input is not a pair!");
}
#endif // WILE_DO_CHECK
var_53 = (var_41.v.pair.car ? *(var_41.v.pair.car) : LVI_NIL());
lval var_54;
{
lptr p1 = NULL, p2 = NULL;
if (var_52.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_52;
}
if (var_53.vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_53;
}
var_54 = LVI_PAIR(p1, p2);
}
lval var_55;
#ifdef WILE_DO_CHECK
if (var_50.vt != LV_PAIR) {
wile_exception("cdr", "bld-rtl-dir/wile-rtl2-000077.scm:26", "input is not a pair!");
}
#endif // WILE_DO_CHECK
var_55 = (var_50.v.pair.cdr ? *(var_50.v.pair.cdr) : LVI_NIL());
lval var_56;
var_56 = LVI_STRING("cadr");
lval var_57;
{
char* cp = strchr(var_56.v.str, 'r');
var_57 = var_41;
while (*(--cp) != 'c') {
#ifdef WILE_DO_CHECK
if (var_57.vt != LV_PAIR) {
wile_exception("cxr", "bld-rtl-dir/wile-rtl2-000077.scm:26", "input does not have the right structure!");
}
#endif // WILE_DO_CHECK
if (*cp == 'a') {
var_57 = (var_57.v.pair.car ? *(var_57.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_57 = (var_57.v.pair.cdr ? *(var_57.v.pair.cdr) : LVI_NIL());
} else {
wile_exception("cxr", "bld-rtl-dir/wile-rtl2-000077.scm:26", "got malformed control string '%s'", var_56.v.str);
}
}
}
lval var_58;
{
lptr p1 = NULL, p2 = NULL;
if (var_55.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_55;
}
if (var_57.vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_57;
}
var_58 = LVI_PAIR(p1, p2);
}
lval var_59;
{
lval var_60[2];
var_60[0] = var_54;
var_60[1] = var_58;
var_59 = wile_gen_list(2, var_60, NULL);
}
var_39 = var_59;
} else {
lval var_61;
var_61 = LVI_NIL();
lval var_62;
{
lval var_63[2];
var_63[0] = var_61;
var_63[1] = var_37[1];
var_62 = wile_gen_list(2, var_63, NULL);
}
var_39 = var_62;
}
return var_39;
}
// end of function fn_35

// @@@ (t2 i n m) @@@ bld-rtl-dir/wile-rtl2-000077.scm:27 @@@ fn_64 @@@
static lval fn_64(lptr* var_65, lptr var_66, const char* cloc)
{
lval var_68;
lval var_69;
switch (TYPE_COMBO(var_66[0].vt,var_66[1].vt)) {
case TYPE_COMBO(LV_INT,LV_INT):
var_69 = LVI_BOOL(var_66[0].v.iv == var_66[1].v.iv);
break;
case TYPE_COMBO(LV_INT,LV_RAT):
var_69 = LVI_BOOL(var_66[0].v.iv * var_66[1].v.irv.den == var_66[1].v.irv.num);
break;
case TYPE_COMBO(LV_INT,LV_REAL):
var_69 = LVI_BOOL(var_66[0].v.iv == var_66[1].v.rv);
break;
case TYPE_COMBO(LV_RAT,LV_INT):
var_69 = LVI_BOOL(var_66[0].v.irv.num == var_66[1].v.iv * var_66[0].v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_RAT):
var_69 = LVI_BOOL(var_66[0].v.irv.num * var_66[1].v.irv.den == var_66[1].v.irv.num * var_66[0].v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_REAL):
var_69 = LVI_BOOL(var_66[0].v.irv.num == var_66[1].v.rv * var_66[0].v.irv.den);
break;
case TYPE_COMBO(LV_REAL,LV_INT):
var_69 = LVI_BOOL(var_66[0].v.rv == var_66[1].v.iv);
break;
case TYPE_COMBO(LV_REAL,LV_RAT):
var_69 = LVI_BOOL(var_66[0].v.rv * var_66[1].v.irv.den == var_66[1].v.irv.num);
break;
case TYPE_COMBO(LV_REAL,LV_REAL):
var_69 = LVI_BOOL(var_66[0].v.rv == var_66[1].v.rv);
break;
default:
wile_exception("==", "bld-rtl-dir/wile-rtl2-000077.scm:28", "inputs are not real-valued numbers");
break;
}
if (LV_IS_FALSE(var_69)) {
lval var_70;
lval var_71;
var_71 = LVI_INT(1);
lval var_72;
{
lval var_74[2];
var_74[0] = var_66[0];
var_74[1] = var_71;
var_72 = wile_gen_list(2, var_74, NULL);
}
{
lval var_73[8];
var_73[0] = var_72;
var_72 = wile_add(NULL, var_73, "bld-rtl-dir/wile-rtl2-000077.scm:30");
}
var_70 = var_72;
lval var_75;
lval var_76;
lval var_77[8];
var_77[0] = var_70;
var_77[1] = var_66[2];
var_76 = fn_35(NULL, var_77, "bld-rtl-dir/wile-rtl2-000077.scm:31");
var_75 = var_76;
lval var_79;
#ifdef WILE_DO_CHECK
if (var_75.vt != LV_PAIR) {
wile_exception("car", "bld-rtl-dir/wile-rtl2-000077.scm:32", "input is not a pair!");
}
#endif // WILE_DO_CHECK
var_79 = (var_75.v.pair.car ? *(var_75.v.pair.car) : LVI_NIL());
lval var_80;
{
lval var_81[8];
var_81[0] = var_79;
var_80 = wile_list_reverse(NULL, var_81, "bld-rtl-dir/wile-rtl2-000077.scm:32");
}
lval var_82;
var_82 = LVI_STRING("cadr");
lval var_83;
{
char* cp = strchr(var_82.v.str, 'r');
var_83 = var_75;
while (*(--cp) != 'c') {
#ifdef WILE_DO_CHECK
if (var_83.vt != LV_PAIR) {
wile_exception("cxr", "bld-rtl-dir/wile-rtl2-000077.scm:32", "input does not have the right structure!");
}
#endif // WILE_DO_CHECK
if (*cp == 'a') {
var_83 = (var_83.v.pair.car ? *(var_83.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_83 = (var_83.v.pair.cdr ? *(var_83.v.pair.cdr) : LVI_NIL());
} else {
wile_exception("cxr", "bld-rtl-dir/wile-rtl2-000077.scm:32", "got malformed control string '%s'", var_82.v.str);
}
}
}
lval var_84;
lval var_85[8];
var_85[0] = var_70;
var_85[1] = var_66[1];
var_85[2] = var_83;
var_84 = fn_64(NULL, var_85, "bld-rtl-dir/wile-rtl2-000077.scm:32");
lval var_87;
{
lptr p1 = NULL, p2 = NULL;
if (var_80.vt != LV_NIL) {
p1 = new_lv(LV_NIL);
*p1 = var_80;
}
if (var_84.vt != LV_NIL) {
p2 = new_lv(LV_NIL);
*p2 = var_84;
}
var_87 = LVI_PAIR(p1, p2);
}
var_68 = var_87;
} else {
lval var_88;
var_88 = LVI_NIL();
var_68 = var_88;
}
return var_68;
}
// end of function fn_64

// @@@ (t3 m) @@@ bld-rtl-dir/wile-rtl2-000077.scm:33 @@@ fn_89 @@@
static lval fn_89(lptr* var_90, lptr var_91, const char* cloc)
{
lval var_93;
var_93 = LVI_INT(0);
lval var_94;
{
lval var_95[8];
var_95[0] = var_91[0];
var_94 = wile_list_length(NULL, var_95, "bld-rtl-dir/wile-rtl2-000077.scm:34");
}
lval var_96;
lval var_97[8];
var_97[0] = var_93;
var_97[1] = var_94;
var_97[2] = var_91[0];
var_96 = fn_64(NULL, var_97, "bld-rtl-dir/wile-rtl2-000077.scm:34");
lval var_99;
{
lval var_100[8];
var_100[0] = var_96;
var_99 = wile_list_reverse(NULL, var_100, "bld-rtl-dir/wile-rtl2-000077.scm:34");
}
return var_99;
}
// end of function fn_89

// @@@ lambda (m v) @@@ bld-rtl-dir/wile-rtl2-000077.scm:37 @@@ fn_109 @@@
static lval fn_109(lptr* var_110, lptr var_111, const char* cloc)
{
lval var_113;
{
lval var_115[2];
var_115[0] = var_111[1];
var_115[1] = var_111[0];
var_113 = wile_gen_list(2, var_115, NULL);
}
{
lval var_114[8];
var_114[0] = var_113;
var_113 = wile_divide(NULL, var_114, "bld-rtl-dir/wile-rtl2-000077.scm:37");
}
return var_113;
}
// end of lambda fn_109

// @@@ (cholesky-solve mat vec) @@@ bld-rtl-dir/wile-rtl2-000077.scm:13 @@@ wile_cholesky_solve @@@
lval wile_cholesky_solve(lptr* var_1, lptr var_2, const char* cloc)
{
lval var_101;
lval var_102;
#ifdef WILE_DO_CHECK
if (var_2[0].vt != LV_PAIR) {
wile_exception("car", "bld-rtl-dir/wile-rtl2-000077.scm:35", "input is not a pair!");
}
#endif // WILE_DO_CHECK
var_102 = (var_2[0].v.pair.car ? *(var_2[0].v.pair.car) : LVI_NIL());
var_101 = var_102;
lval var_103;
lval var_104;
var_104 = LVI_STRING("cadr");
lval var_105;
{
char* cp = strchr(var_104.v.str, 'r');
var_105 = var_2[0];
while (*(--cp) != 'c') {
#ifdef WILE_DO_CHECK
if (var_105.vt != LV_PAIR) {
wile_exception("cxr", "bld-rtl-dir/wile-rtl2-000077.scm:36", "input does not have the right structure!");
}
#endif // WILE_DO_CHECK
if (*cp == 'a') {
var_105 = (var_105.v.pair.car ? *(var_105.v.pair.car) : LVI_NIL());
} else if (*cp == 'd') {
var_105 = (var_105.v.pair.cdr ? *(var_105.v.pair.cdr) : LVI_NIL());
} else {
wile_exception("cxr", "bld-rtl-dir/wile-rtl2-000077.scm:36", "got malformed control string '%s'", var_104.v.str);
}
}
}
var_103 = var_105;
lval var_106;
lval var_107[8];
var_107[0] = var_103;
var_106 = fn_89(NULL, var_107, "bld-rtl-dir/wile-rtl2-000077.scm:37");
MK_CLOS(var_110,0);
lval var_116;
lval var_117[8];
var_117[0] = var_103;
var_117[1] = var_2[1];
var_116 = fn_4(NULL, var_117, "bld-rtl-dir/wile-rtl2-000077.scm:38");
lval var_119;
{
lval var_121[1];
var_121[0] = var_116;
var_119 = wile_gen_list(1, var_121, NULL);
}
{
lval var_120[8];
var_120[0] = LVI_PROC(fn_109,var_110,2);
var_120[1] = var_101;
var_120[2] = var_119;
var_119 = wile_map(NULL, var_120, "bld-rtl-dir/wile-rtl2-000077.scm:37");
}
lval var_122;
{
lval var_123[8];
var_123[0] = var_119;
var_122 = wile_list_reverse(NULL, var_123, "bld-rtl-dir/wile-rtl2-000077.scm:37");
}
lval var_124;
lval var_125[8];
var_125[0] = var_106;
var_125[1] = var_122;
var_124 = fn_4(NULL, var_125, "bld-rtl-dir/wile-rtl2-000077.scm:37");
lval var_127;
{
lval var_128[8];
var_128[0] = var_124;
var_127 = wile_list_reverse(NULL, var_128, "bld-rtl-dir/wile-rtl2-000077.scm:37");
}
return var_127;
}
// end of function wile_cholesky_solve
