// Generated by wile, the extremely stable scheming genius compiler

#include "wile-rtl1.h"
#include "wile-rtl2.h"

// declarations

extern lval var_argv;
extern lval var_cmd_name;
extern lval var_stdin;
extern lval var_stdout;
extern lval var_stderr;
extern lval var_pi;
extern lval var_euler_gamma;
extern lval var_show_sign;
extern lval var_int_base;
extern lval var_flt_base;
extern lval var_flt_precision;
#include "wile-rtl2.h"
static lval fn_5(lptr*, lptr);

// definitions

// @@@ lambda (x) @@@ bld-rtl-dir/wile-rtl2-000035.scm:14 @@@ fn_5 @@@
static lval fn_5(lptr* var_6, lptr var_7)
{
return var_7[0];
}
// end of lambda fn_5

// @@@ promote/rat @@@ bld-rtl-dir/wile-rtl2-000035.scm:14 @@@ fn_9 @@@
static lval fn_9(lptr* var_10, lptr var_11)
{
lval var_13;
if (var_11[0].vt == LV_INT) {
var_13 = LVI_RAT(var_11[0].v.iv, 1);
} else {
var_13 = var_11[0];
}
return var_13;
}
// end of prim fn_9

// @@@ promote/real @@@ bld-rtl-dir/wile-rtl2-000035.scm:14 @@@ fn_14 @@@
static lval fn_14(lptr* var_15, lptr var_16)
{
lval var_18;
if (var_16[0].vt == LV_INT) {
var_18 = LVI_REAL((lisp_real_t) var_16[0].v.iv);
} else if (var_16[0].vt == LV_RAT) {
var_18 = LVI_REAL(LV_RAT2REAL(var_16[0]));
} else {
var_18 = var_16[0];
}
return var_18;
}
// end of prim fn_14

// @@@ max/i @@@ bld-rtl-dir/wile-rtl2-000035.scm:15 @@@ fn_22 @@@
static lval fn_22(lptr* var_23, lptr var_24)
{
lval var_26;
var_26 = LVI_INT((var_24[0].v.iv > var_24[1].v.iv) ? var_24[0].v.iv : var_24[1].v.iv);
return var_26;
}
// end of prim fn_22

// @@@ max/q @@@ bld-rtl-dir/wile-rtl2-000035.scm:15 @@@ fn_27 @@@
static lval fn_27(lptr* var_28, lptr var_29)
{
lval var_31;
if (var_29[0].v.irv.num * var_29[1].v.irv.den > var_29[1].v.irv.num * var_29[0].v.irv.den) {
var_31 = var_29[0];
} else {
var_31 = var_29[1];
}
return var_31;
}
// end of prim fn_27

// @@@ max/r @@@ bld-rtl-dir/wile-rtl2-000035.scm:15 @@@ fn_32 @@@
static lval fn_32(lptr* var_33, lptr var_34)
{
lval var_36;
var_36 = LVI_REAL((var_34[0].v.rv > var_34[1].v.rv) ? var_34[0].v.rv : var_34[1].v.rv);
return var_36;
}
// end of prim fn_32

// @@@ max/i @@@ bld-rtl-dir/wile-rtl2-000035.scm:22 @@@ fn_56 @@@
static lval fn_56(lptr* var_57, lptr var_58)
{
lval var_60;
var_60 = LVI_INT((var_58[0].v.iv > var_58[1].v.iv) ? var_58[0].v.iv : var_58[1].v.iv);
return var_60;
}
// end of prim fn_56

// @@@ number/type @@@ bld-rtl-dir/wile-rtl2-000035.scm:22 @@@ fn_62 @@@
static lval fn_62(lptr* var_63, lptr var_64)
{
lval var_66;
switch (var_64[0].vt) {
case LV_INT:
var_66 = LVI_INT(0);
break;
case LV_RAT:
var_66 = LVI_INT(1);
break;
case LV_REAL:
var_66 = LVI_INT(2);
break;
case LV_CMPLX:
var_66 = LVI_INT(3);
break;
default:
var_66 = LVI_INT(4);
break;
}
return var_66;
}
// end of prim fn_62

// @@@ (max . vs) @@@ bld-rtl-dir/wile-rtl2-000035.scm:13 @@@ wile_max @@@
lval wile_max(lptr* var_1, lptr var_2)
{
lval var_4;
MK_CLOS(var_6,0);
lval var_19;
{
lval var_20[3];
var_20[0] = LVI_PROC(fn_5,var_6,1);
var_20[1] = LVI_PROC(fn_9,NULL,1);
var_20[2] = LVI_PROC(fn_14,NULL,1);
var_19 = wile_gen_list(3, var_20, NULL);
}
var_4 = var_19;
lval var_21;
lval var_37;
{
lval var_38[3];
var_38[0] = LVI_PROC(fn_22,NULL,2);
var_38[1] = LVI_PROC(fn_27,NULL,2);
var_38[2] = LVI_PROC(fn_32,NULL,2);
var_37 = wile_gen_list(3, var_38, NULL);
}
var_21 = var_37;
lval var_39;
do {
lval var_40;
var_40 = LVI_BOOL(var_2[0].vt == LV_NIL);
if (!LV_IS_FALSE(var_40)) {
lval var_41;
var_41 = LVI_REAL(-1.00000000000000000000000000000000000e+00Q);
lval var_42;
var_42 = LVI_REAL(0.00000000000000000000000000000000000e+00Q);
lval var_43;
var_43 = LVI_REAL(var_41.v.rv / var_42.v.rv);
var_39 = var_43;
break;
}
lval var_44;
if (var_2[0].vt != LV_PAIR) {
WILE_EX("cdr", "input is not a pair!");
}
var_44 = (var_2[0].v.pair.cdr ? *(var_2[0].v.pair.cdr) : LVI_NIL());
lval var_45;
var_45 = LVI_BOOL(var_44.vt == LV_NIL);
if (!LV_IS_FALSE(var_45)) {
lval var_46;
lval var_47;
if (var_2[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_47 = (var_2[0].v.pair.car ? *(var_2[0].v.pair.car) : LVI_NIL());
lval var_48;
switch (var_47.vt) {
case LV_INT:
var_48 = LVI_INT(0);
break;
case LV_RAT:
var_48 = LVI_INT(1);
break;
case LV_REAL:
var_48 = LVI_INT(2);
break;
case LV_CMPLX:
var_48 = LVI_INT(3);
break;
default:
var_48 = LVI_INT(4);
break;
}
lval var_49;
var_49 = LVI_INT(3);
lval var_50;
switch (TYPE_COMBO(var_48.vt,var_49.vt)) {
case TYPE_COMBO(LV_INT,LV_INT):
var_50 = LVI_BOOL(var_48.v.iv < var_49.v.iv);
break;
case TYPE_COMBO(LV_INT,LV_RAT):
var_50 = LVI_BOOL(var_48.v.iv * var_49.v.irv.den < var_49.v.irv.num);
break;
case TYPE_COMBO(LV_INT,LV_REAL):
var_50 = LVI_BOOL(var_48.v.iv < var_49.v.rv);
break;
case TYPE_COMBO(LV_RAT,LV_INT):
var_50 = LVI_BOOL(var_48.v.irv.num < var_49.v.iv * var_48.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_RAT):
var_50 = LVI_BOOL(var_48.v.irv.num * var_49.v.irv.den < var_49.v.irv.num * var_48.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_REAL):
var_50 = LVI_BOOL(var_48.v.irv.num < var_49.v.rv * var_48.v.irv.den);
break;
case TYPE_COMBO(LV_REAL,LV_INT):
var_50 = LVI_BOOL(var_48.v.rv < var_49.v.iv);
break;
case TYPE_COMBO(LV_REAL,LV_RAT):
var_50 = LVI_BOOL(var_48.v.rv * var_49.v.irv.den < var_49.v.irv.num);
break;
case TYPE_COMBO(LV_REAL,LV_REAL):
var_50 = LVI_BOOL(var_48.v.rv < var_49.v.rv);
break;
default:
WILE_EX("<", "inputs are not real-valued numbers");
break;
}
if (LV_IS_FALSE(var_50)) {
lval var_51;
var_51 = LVI_STRING("max got a non-real argument");
lval var_52;
{
lval var_53[1];
var_53[0] = var_51;
var_52 = wile_gen_list(1, var_53, NULL);
}
if (var_52.vt == LV_PAIR && (var_52.v.pair.cdr == NULL || var_52.v.pair.cdr->vt == LV_NIL)) {
var_52 = (var_52.v.pair.car ? *(var_52.v.pair.car) : LVI_NIL());
}
cachalot->errval = new_lv(LV_NIL);
*(cachalot->errval) = var_52;
cachalot->l_whence = 0;
cachalot->c_whence = LISP_WHENCE;
longjmp(cachalot->cenv, 1);
var_46 = var_52;
} else {
lval var_54;
if (var_2[0].vt != LV_PAIR) {
WILE_EX("car", "input is not a pair!");
}
var_54 = (var_2[0].v.pair.car ? *(var_2[0].v.pair.car) : LVI_NIL());
var_46 = var_54;
}
var_39 = var_46;
break;
}
lval var_55;
lval var_61;
var_61 = LVI_INT(0);
lval var_67;
var_67 = LVI_NIL();
{
lval var_68[8];
var_68[0] = LVI_PROC(fn_62,NULL,1);
var_68[1] = var_2[0];
var_68[2] = var_67;
var_67 = wile_map(NULL, var_68);
}
lval var_69;
{
lval var_70[8];
var_70[0] = LVI_PROC(fn_56,NULL,2);
var_70[1] = var_61;
var_70[2] = var_67;
var_69 = wile_foldl(NULL, var_70);
}
var_55 = var_69;
lval var_71;
lval var_72;
var_72 = LVI_INT(3);
lval var_73;
switch (TYPE_COMBO(var_55.vt,var_72.vt)) {
case TYPE_COMBO(LV_INT,LV_INT):
var_73 = LVI_BOOL(var_55.v.iv < var_72.v.iv);
break;
case TYPE_COMBO(LV_INT,LV_RAT):
var_73 = LVI_BOOL(var_55.v.iv * var_72.v.irv.den < var_72.v.irv.num);
break;
case TYPE_COMBO(LV_INT,LV_REAL):
var_73 = LVI_BOOL(var_55.v.iv < var_72.v.rv);
break;
case TYPE_COMBO(LV_RAT,LV_INT):
var_73 = LVI_BOOL(var_55.v.irv.num < var_72.v.iv * var_55.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_RAT):
var_73 = LVI_BOOL(var_55.v.irv.num * var_72.v.irv.den < var_72.v.irv.num * var_55.v.irv.den);
break;
case TYPE_COMBO(LV_RAT,LV_REAL):
var_73 = LVI_BOOL(var_55.v.irv.num < var_72.v.rv * var_55.v.irv.den);
break;
case TYPE_COMBO(LV_REAL,LV_INT):
var_73 = LVI_BOOL(var_55.v.rv < var_72.v.iv);
break;
case TYPE_COMBO(LV_REAL,LV_RAT):
var_73 = LVI_BOOL(var_55.v.rv * var_72.v.irv.den < var_72.v.irv.num);
break;
case TYPE_COMBO(LV_REAL,LV_REAL):
var_73 = LVI_BOOL(var_55.v.rv < var_72.v.rv);
break;
default:
WILE_EX("<", "inputs are not real-valued numbers");
break;
}
if (LV_IS_FALSE(var_73)) {
lval var_74;
var_74 = LVI_STRING("max got a non-real argument");
lval var_75;
{
lval var_76[1];
var_76[0] = var_74;
var_75 = wile_gen_list(1, var_76, NULL);
}
if (var_75.vt == LV_PAIR && (var_75.v.pair.cdr == NULL || var_75.v.pair.cdr->vt == LV_NIL)) {
var_75 = (var_75.v.pair.car ? *(var_75.v.pair.car) : LVI_NIL());
}
cachalot->errval = new_lv(LV_NIL);
*(cachalot->errval) = var_75;
cachalot->l_whence = 0;
cachalot->c_whence = LISP_WHENCE;
longjmp(cachalot->cenv, 1);
var_71 = var_75;
} else {
lval var_77;
{
lval var_78[8];
var_78[0] = var_21;
var_78[1] = var_55;
var_77 = wile_list_ref(NULL, var_78);
}
lval var_79;
{
lval var_80[8];
var_80[0] = var_4;
var_80[1] = var_55;
var_79 = wile_list_ref(NULL, var_80);
}
lval var_81;
var_81 = LVI_NIL();
{
lval var_82[8];
var_82[0] = var_79;
var_82[1] = var_2[0];
var_82[2] = var_81;
var_81 = wile_map(NULL, var_82);
}
lval var_83;
{
lval var_84[8];
var_84[0] = var_77;
var_84[1] = var_81;
var_83 = wile_foldl1(NULL, var_84);
}
var_71 = var_83;
}
var_39 = var_71;
} while (0);
return var_39;
}
// end of function wile_max
